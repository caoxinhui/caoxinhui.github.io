<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å‘å¸ƒè®¢é˜…æ¨¡å¼</title>
    <url>/2020/04/11/%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<p>æœ¬æ–‡ç®€å•ä»‹ç»å‘å¸ƒè®¢é˜…æ¨¡å¼çš„å®é™…åº”ç”¨</p>
<a id="more"></a>


<p>å®ç°ä¸€ä¸ªç®€å•çš„createStoreå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> createStore = <span class="function">(<span class="params">reducer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> state</span><br><span class="line">    <span class="keyword">const</span> listerners = []</span><br><span class="line">    <span class="keyword">const</span> getState = <span class="function"><span class="params">()</span> =&gt;</span> state</span><br><span class="line">    <span class="keyword">const</span> dispatch = <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">        state = reducer(state, action)</span><br><span class="line">        listerners.forEach(<span class="function"><span class="params">listerner</span> =&gt;</span> listerner())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> subscribe = <span class="function"><span class="keyword">function</span> (<span class="params">listener</span>) </span>&#123;</span><br><span class="line">        listeners.push(listener)</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            listerners = listerners.filter(<span class="function"><span class="params">l</span> =&gt;</span> l !== listener)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dispatch()</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        getState,</span><br><span class="line">        dispatch,</span><br><span class="line">        subscribe</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = &#123;&#125;, action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'INCREMENT'</span>: &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">            ++state.count</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer)</span><br><span class="line"><span class="keyword">const</span> render = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.body.innerText = store.getState().count</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">store.subscribe(render)</span><br><span class="line">render()</span><br><span class="line"><span class="keyword">const</span> INCREASE_ACTION = &#123;<span class="attr">type</span>: <span class="string">'INCREMENT'</span>&#125;</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    store.dispatch(INCREASE_ACTION)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
  </entry>
  <entry>
    <title>Redux</title>
    <url>/2020/04/04/Redux/</url>
    <content><![CDATA[<p>reduxçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå…¨å±€ storeï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¼šæ”¾åœ¨storeä¸­</p>
<p>äº§ç”Ÿ storeï¼Œå…¶ä¸­reduceræ˜¯ä¸€ä¸ªçº¯å‡½æ•°<br><code>const store = createStore(reducer)</code></p>
<a id="more"></a>

<p>storeçš„ä¸‰ä¸ªæ–¹æ³•</p>
<ol>
<li>getState()</li>
<li>dispatch(action)<br>UIä¸Šç‚¹å‡»äº†ä¸€ä¸ªbuttonï¼Œå¯èƒ½äº§ç”Ÿä¸€ä¸ªactionï¼Œstoreå¯ä»¥æŠŠå®ƒdispatchå‡ºå»ï¼Œdispatchç»™reducerï¼Œreduceræ˜¯çœŸæ­£å¤„ç†actionçš„ï¼Œå¹¶æ›´æ–°store</li>
<li>subscribe(listener)<br>ç›‘å¬storeçš„å˜åŒ–ï¼Œstoreæœ‰ä»»ä½•å˜åŒ–éƒ½ä¼šè°ƒç”¨ä»–çš„ callback-&gt; listener</li>
<li>replaceReducer(nextReducer)<br>æ›´æ–°å½“å‰storeé‡Œçš„reducer</li>
</ol>
<h3 id="ç†è§£action"><a href="#ç†è§£action" class="headerlink" title="ç†è§£action"></a>ç†è§£action</h3><p>æè¿°è¡Œä¸º</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type:ADD_TODO,</span><br><span class="line">    text:<span class="string">'Build my first Redux app'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç†è§£reducer"><a href="#ç†è§£reducer" class="headerlink" title="ç†è§£reducer"></a>ç†è§£reducer</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">todoApp</span>(<span class="params">state = initialState, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> ADD_TODO:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, state, &#123;</span><br><span class="line">                todos: [</span><br><span class="line">                    ...state.todos, &#123;</span><br><span class="line">                        text: action.text,</span><br><span class="line">                        completed: <span class="literal">false</span></span><br><span class="line">                    &#125;]</span><br><span class="line">            &#125;)</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> store</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/364812/images/2473907/ARCH-Classic-Flux__2_.png" alt="flux"><br><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/364812/images/2484555/ARCH-Redux2.png" alt="redux"><br><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/364812/images/2484552/ARCH-Redux2-real.gif" alt="reduxçŠ¶æ€æµ"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(state,action)=&gt;<span class="keyword">new</span> state</span><br></pre></td></tr></table></figure>


<h3 id="ç†è§£-combineReducers"><a href="#ç†è§£-combineReducers" class="headerlink" title="ç†è§£ combineReducers"></a>ç†è§£ combineReducers</h3><p>å·¥å…·å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">todos</span>(<span class="params">state = [], action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'ADD_TODO'</span>:</span><br><span class="line">            <span class="keyword">return</span> state.concat([action.text])</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params">state = <span class="number">0</span>, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'INCREMENT'</span>:</span><br><span class="line">            <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">'DECREMENT'</span>:</span><br><span class="line">            <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> todos <span class="keyword">from</span> <span class="string">'./todos'</span></span><br><span class="line"><span class="keyword">import</span> counter <span class="keyword">from</span> <span class="string">'./counter'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</span><br><span class="line">    todos,</span><br><span class="line">    counter</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="ç†è§£-bindActionCreators"><a href="#ç†è§£-bindActionCreators" class="headerlink" title="ç†è§£ bindActionCreators"></a>ç†è§£ bindActionCreators</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodoWithDispatch</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> action = &#123;</span><br><span class="line">        type: ADD_TODO,</span><br><span class="line">        text</span><br><span class="line">&#125;</span><br><span class="line">    dispatch(action);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dispatch(addTodo(text))</span><br><span class="line">dispatch(completeTodo(index))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boundAddTodo = <span class="function"><span class="params">text</span> =&gt;</span> dispatch(addTodo(text));</span><br><span class="line"><span class="keyword">const</span> boundCompleteTodo = <span class="function"><span class="params">index</span> =&gt;</span> dispatch(completeTodo(index));</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindActionCreator</span>(<span class="params">actionCreator, dispatch</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dispatch(actionCreator.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindActionCreators</span>(<span class="params">actionCreators, dispatch</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(actionCreators);</span><br><span class="line">    <span class="keyword">const</span> boundActionCreators = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> key = keys[i];</span><br><span class="line">        <span class="keyword">const</span> actionCreator = actionCreators[key];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> actionCreator === <span class="string">'function'</span>) &#123;</span><br><span class="line">            boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> boundActionCreators;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createStore,</span><br><span class="line">  combineReducers,</span><br><span class="line">  bindActionCreators</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"redux"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Store initial state</span></span><br><span class="line">  <span class="keyword">const</span> initialState = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// reducer</span></span><br><span class="line">  <span class="keyword">const</span> counter = <span class="function">(<span class="params">state = initialState, action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">"PLUS_ONE"</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count + <span class="number">1</span> &#125;;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">"MINUS_ONE"</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count - <span class="number">1</span> &#125;;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">"CUSTOM_COUNT"</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          count: state.count + action.payload.count</span><br><span class="line">        &#125;;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> todos = <span class="function">(<span class="params">state = &#123;&#125;</span>) =&gt;</span> state;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create store</span></span><br><span class="line">  <span class="keyword">const</span> store = createStore(</span><br><span class="line">    combineReducers(&#123;</span><br><span class="line">      todos,</span><br><span class="line">      counter</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Action creator</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">plusOne</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// action</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="string">"PLUS_ONE"</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">minusOne</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="string">"MINUS_ONE"</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">customCount</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="string">"CUSTOM_COUNT"</span>, <span class="attr">payload</span>: &#123; count &#125; &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  plusOne = bindActionCreators(plusOne, store.dispatch);</span><br><span class="line"></span><br><span class="line">  store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(store.getState()));</span><br><span class="line">  <span class="comment">// store.dispatch(plusOne());</span></span><br><span class="line">  plusOne();</span><br><span class="line">  store.dispatch(minusOne());</span><br><span class="line">  store.dispatch(customCount(<span class="number">5</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;button onClick=&#123;run&#125;&gt;Run&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;* è¯·æ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹è¿è¡Œç»“æœ&lt;/</span>p&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>


<h3 id="å°†ç»„ä»¶-connect-åˆ°-store-ä¸Š"><a href="#å°†ç»„ä»¶-connect-åˆ°-store-ä¸Š" class="headerlink" title="å°†ç»„ä»¶ connect åˆ° store ä¸Š"></a>å°†ç»„ä»¶ connect åˆ° store ä¸Š</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;connect&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SidePanel</span> <span class="keyword">extends</span> <span class="title">Comment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        nextgen: state.nextgen,</span><br><span class="line">        router: state.router,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        actions: bindActionCreators(&#123;...actions&#125;, dispatch)</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(SidePanel);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators, createStore &#125; <span class="keyword">from</span> <span class="string">"redux"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Provider, connect &#125; <span class="keyword">from</span> <span class="string">"react-redux"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Store initial state</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reducer</span></span><br><span class="line"><span class="keyword">const</span> counter = <span class="function">(<span class="params">state = initialState, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"PLUS_ONE"</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"MINUS_ONE"</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"CUSTOM_COUNT"</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.count + action.payload.count &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create store</span></span><br><span class="line"><span class="keyword">const</span> store = createStore(counter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Action creator</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plusOne</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// action</span></span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="string">"PLUS_ONE"</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minusOne</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">type</span>: <span class="string">"MINUS_ONE"</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; count, plusOne, minusOne &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"counter"</span>&gt;</span><br><span class="line">        &lt;button onClick=&#123;minusOne&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">        &lt;span style=&#123;&#123; <span class="attr">display</span>: <span class="string">"inline-block"</span>, <span class="attr">margin</span>: <span class="string">"0 10px"</span> &#125;&#125;&gt;</span><br><span class="line">          &#123;count&#125;</span><br><span class="line">        &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button onClick=&#123;plusOne&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function mapStateToProps(state) &#123;</span></span><br><span class="line"><span class="regexp">  return &#123;</span></span><br><span class="line"><span class="regexp">    count: state.count</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function mapDispatchToProps(dispatch) &#123;</span></span><br><span class="line"><span class="regexp">  return bindActionCreators(&#123; plusOne, minusOne &#125;, dispatch);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const ConnectedCounter = connect(mapStateToProps, mapDispatchToProps)(Counter);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default class CounterSample extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;Provider store=&#123;store&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;ConnectedCounter /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>


<h3 id="å¼‚æ­¥action"><a href="#å¼‚æ­¥action" class="headerlink" title="å¼‚æ­¥action"></a>å¼‚æ­¥action</h3><p><img src="https://s3.amazonaws.com/media-p.slid.es/uploads/364812/images/2484714/ARCH-Redux2-extended-api.png" alt="reduxå¼‚æ­¥è¯·æ±‚"></p>
<h3 id="redux-ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰"><a href="#redux-ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰" class="headerlink" title="redux ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰"></a>redux ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</h3><ol>
<li>æˆªè· action</li>
<li>å‘å‡º action</li>
</ol>
]]></content>
      <categories>
        <category>æå®¢æ—¶é—´</category>
      </categories>
  </entry>
  <entry>
    <title>Git &amp; npm</title>
    <url>/2019/12/28/Git/</url>
    <content><![CDATA[<h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><a id="more"></a>

<h3 id="git-clone"><a href="#git-clone" class="headerlink" title="git clone"></a>git clone</h3><p>è¯¥å‘½ä»¤ä¼šåœ¨æœ¬åœ°ä¸»æœºç”Ÿæˆä¸€ä¸ªç›®å½•ï¼Œä¸è¿œç¨‹ä¸»æœºçš„ç‰ˆæœ¬åº“åŒåã€‚è‹¥è¦æŒ‡å®šä¸åŒçš„ç›®å½•åï¼Œå°†ç›®å½•åä½œä¸ºgit clone å‘½ä»¤çš„ç¬¬äºŒä¸ªå‚æ•°<br><code>git clone &lt;ç‰ˆæœ¬åº“çš„ç½‘å€&gt; &lt;æœ¬åœ°ç›®å½•å&gt;</code></p>
<h3 id="git-æ‰¹é‡åˆ é™¤æœ¬åœ°åˆ†æ”¯-åˆ é™¤åˆ†æ”¯ååŒ…å«æŒ‡å®šå­—ç¬¦çš„åˆ†æ”¯"><a href="#git-æ‰¹é‡åˆ é™¤æœ¬åœ°åˆ†æ”¯-åˆ é™¤åˆ†æ”¯ååŒ…å«æŒ‡å®šå­—ç¬¦çš„åˆ†æ”¯" class="headerlink" title="git æ‰¹é‡åˆ é™¤æœ¬åœ°åˆ†æ”¯(åˆ é™¤åˆ†æ”¯ååŒ…å«æŒ‡å®šå­—ç¬¦çš„åˆ†æ”¯)"></a>git æ‰¹é‡åˆ é™¤æœ¬åœ°åˆ†æ”¯(åˆ é™¤åˆ†æ”¯ååŒ…å«æŒ‡å®šå­—ç¬¦çš„åˆ†æ”¯)</h3><p><code>git branch |grep &#39;xxx&#39; |xargs git branch -D</code></p>
<h3 id="åˆ é™¤å½“å‰åˆ†æ”¯ä»¥å¤–çš„åˆ†æ”¯"><a href="#åˆ é™¤å½“å‰åˆ†æ”¯ä»¥å¤–çš„åˆ†æ”¯" class="headerlink" title="åˆ é™¤å½“å‰åˆ†æ”¯ä»¥å¤–çš„åˆ†æ”¯"></a>åˆ é™¤å½“å‰åˆ†æ”¯ä»¥å¤–çš„åˆ†æ”¯</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">git branch | xargs git branch -d</span><br></pre></td></tr></table></figure>


<h3 id="git-remote"><a href="#git-remote" class="headerlink" title="git remote"></a>git remote</h3><p>æ¯ä¸ªè¿œç¨‹ä¸»æœºéƒ½æœ‰ä¸€ä¸ªä¸»æœºåï¼Œgit remote ç”¨äºç®¡ç†ä¸»æœºå</p>
<p><code>git remote</code> åˆ—å‡ºæ‰€æœ‰è¿œç¨‹ä¸»æœº<br><code>git remote -v</code>å‚çœ‹è¿œç¨‹ä¸»æœºç½‘å€<br><code>git remote show &lt;ä¸»æœºå&gt;</code>æŸ¥çœ‹ä¸»æœºè¯¦ç»†ä¿¡æ¯<br><code>git remote add &lt;ä¸»æœºå&gt; &lt;ç½‘å€&gt;</code>æ·»åŠ è¿œç¨‹ä¸»æœº<br><code>git remote rm &lt;ä¸»æœºå&gt;</code>åˆ é™¤è¿œç¨‹ä¸»æœº<br><code>git remote rename &lt;åŸä¸»æœºå&gt; &lt;æ–°ä¸»æœºå&gt;</code>ä¿®æ”¹è¿œç¨‹ä¸»æœº</p>
<p>å…‹éš†ç‰ˆæœ¬åº“çš„æ—¶å€™ï¼Œæ‰€ä½¿ç”¨çš„è¿œç¨‹ä¸»æœºï¼Œè‡ªåŠ¨è¢«gitå‘½åä¸ºoriginï¼Œè‹¥æƒ³ä½¿ç”¨å…¶ä»–ä¸»æœºåï¼Œä½¿ç”¨ -o<br><code>git clone -o jQuery https://github.com/jquery/jquery.git</code></p>
<h3 id="HEAD-ä¸-HEAD-åŒºåˆ«"><a href="#HEAD-ä¸-HEAD-åŒºåˆ«" class="headerlink" title="HEAD^ ä¸ HEAD~ åŒºåˆ«"></a>HEAD^ ä¸ HEAD~ åŒºåˆ«</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">A = A^<span class="number">0</span></span><br><span class="line">A^ = A^<span class="number">1</span>= A~<span class="number">1</span></span><br><span class="line">^^= A^<span class="number">1</span>^<span class="number">1</span>= A~<span class="number">2</span></span><br></pre></td></tr></table></figure>

<h3 id="reset-hard-soft-åŒºåˆ«"><a href="#reset-hard-soft-åŒºåˆ«" class="headerlink" title="reset, hard, soft åŒºåˆ«"></a>reset, hard, soft åŒºåˆ«</h3><ul>
<li>HEAD:å½“å‰åˆ†æ”¯å½“å‰ç‰ˆæœ¬çš„æ¸¸æ ‡</li>
<li>indexï¼šæš‚å­˜åŒº</li>
</ul>
<p><code>git reset --soft HEAD~</code> æœ¬åœ°çš„å†…å®¹æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œindexä¸­æœ‰æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹çš„å†…å®¹ï¼Œæäº¤å˜æˆstagedçŠ¶æ€ã€‚</p>
<p><code>--mixed</code> ä¿®æ”¹äº†indexï¼Œä½¿å¾—æäº¤å˜æˆäº†unstagedçŠ¶æ€</p>
<p><code>--hard</code> å½»åº•å›åˆ°ä¸Šä¸€æ¬¡æäº¤çš„çŠ¶æ€ï¼Œæ— æ³•æ‰¾å›</p>
<p><code>git revert commitid</code> ,<code>git revert HEAD~3</code>ä¼šå›åˆ°æœ€è¿‘çš„ç¬¬å››ä¸ªæäº¤çŠ¶æ€ï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªæ–°çš„commitid</p>
<h3 id="ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–"><a href="#ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–" class="headerlink" title="ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–"></a>ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®‰è£…huskyï¼Œprettier,lint-staged</span></span><br><span class="line">"husky": &#123;</span><br><span class="line">    "hooks": &#123;</span><br><span class="line">      "pre-commit": "lint-staged"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "lint-staged": &#123;</span><br><span class="line">    "*.&#123;js,jsx&#125;": [</span><br><span class="line">      "prettier --write \"src/**/*.&#123;js,jsx&#125;\"",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<!-- more -->

<h3 id="æœ¬æœºæƒé™é—®é¢˜"><a href="#æœ¬æœºæƒé™é—®é¢˜" class="headerlink" title="æœ¬æœºæƒé™é—®é¢˜"></a>æœ¬æœºæƒé™é—®é¢˜</h3><p><code>git pull</code> çš„æ—¶å€™ <code>error: cannot open .git/FETCH_HEAD: Permission denied</code> , å› ä¸ºæ²¡æœ‰å½“å‰ç›®å½•çš„ä¿®æ”¹æƒé™<br><code>sudo chmod -R g+w .git</code> ä¿®æ”¹ç›®å½•æƒé™ã€‚å³å¯æ­£å¸¸ <code>git pull</code> </p>
<h3 id="git-pull"><a href="#git-pull" class="headerlink" title="git pull"></a>git pull</h3><p><code>git pull &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;è¿œç¨‹åˆ†æ”¯å&gt;:&lt;æœ¬åœ°åˆ†æ”¯å&gt;</code></p>
<h3 id="gitè¡¨æƒ…æç¤ºç¬¦"><a href="#gitè¡¨æƒ…æç¤ºç¬¦" class="headerlink" title="gitè¡¨æƒ…æç¤ºç¬¦"></a>gitè¡¨æƒ…æç¤ºç¬¦</h3><p>å…¨å±€å®‰è£… <code>git-cz</code> æˆ–è€… <code>gitmoji</code><br><code>npm install -g git-cz</code><br><code>npm i -g gitmoji-cli</code> </p>
<h3 id="æ’¤é”€é”™è¯¯çš„æäº¤"><a href="#æ’¤é”€é”™è¯¯çš„æäº¤" class="headerlink" title="æ’¤é”€é”™è¯¯çš„æäº¤"></a>æ’¤é”€é”™è¯¯çš„æäº¤</h3><p><code>git reset --soft HEAD^</code> æ’¤é”€commitï¼Œå¹¶ä¿ç•™æ›´æ”¹<br><code>git push origin &lt;åˆ†æ”¯å&gt; --force</code> </p>
<h3 id="force"><a href="#force" class="headerlink" title="force"></a>force</h3><p>å¦‚æœè¿œç¨‹ä¸»æœºçš„ç‰ˆæœ¬æ¯”æœ¬åœ°ç‰ˆæœ¬æ›´æ–°ï¼Œæ¨é€æ—¶ git ä¼šæŠ¥é”™ï¼Œè¦æ±‚å…ˆåœ¨æœ¬åœ°åš git pull åˆå¹¶å·®å¼‚ï¼Œå†æ¨é€åˆ°è¿œç¨‹ä¸»æœºã€‚è¿™æ—¶ï¼Œå¦‚æœä¸€å®šè¦æ¨é€ï¼Œå¯ä»¥ä½¿ç”¨ force<br><code>git push --force origin</code></p>
<h3 id="æ¸…ç†åˆ†æ”¯"><a href="#æ¸…ç†åˆ†æ”¯" class="headerlink" title="æ¸…ç†åˆ†æ”¯"></a>æ¸…ç†åˆ†æ”¯</h3><p><code>git remote prune origin</code> æ¸…ç†è¿œç¨‹åˆ†æ”¯ï¼ŒæŠŠæœ¬åœ°ä¸å­˜åœ¨çš„è¿œç¨‹åˆ†æ”¯åˆ é™¤ï¼ŒåŒæ—¶ <code>git branch -a</code> æ‹‰åˆ°çš„ä¹Ÿæ˜¯è¿œç¨‹æœ€æ–°çš„åˆ†æ”¯ï¼Œä¸ä¼šä¿ç•™å·²åˆ é™¤çš„è¿œç¨‹çš„åˆ†æ”¯<br><code>git remote show origin</code> ï¼Œå¯ä»¥æŸ¥çœ‹ <code>remote</code> åœ°å€ï¼Œè¿œç¨‹åˆ†æ”¯ï¼Œè¿˜æœ‰æœ¬åœ°åˆ†æ”¯ä¸ä¹‹ç›¸å¯¹åº”å…³ç³»ç­‰ä¿¡æ¯ã€‚</p>
<h3 id="ä¿®æ”¹gitçš„ç”¨æˆ·åå’Œå¯†ç "><a href="#ä¿®æ”¹gitçš„ç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="ä¿®æ”¹gitçš„ç”¨æˆ·åå’Œå¯†ç "></a>ä¿®æ”¹gitçš„ç”¨æˆ·åå’Œå¯†ç </h3><p><code>Git config â€“global user.name</code> ç”¨æˆ·å<br><code>Git config â€“global user.email</code> é‚®ç®±å</p>
<h3 id="å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬å·"><a href="#å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬å·" class="headerlink" title="å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬å·"></a>å›é€€åˆ°ä¹‹å‰çš„ç‰ˆæœ¬å·</h3><p><code>Git reset â€“hard</code> æäº¤ç‰ˆæœ¬å·</p>
<h3 id="åˆ é™¤è¿œç¨‹åˆ†æ”¯-ä¸éœ€è¦å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯"><a href="#åˆ é™¤è¿œç¨‹åˆ†æ”¯-ä¸éœ€è¦å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯" class="headerlink" title="åˆ é™¤è¿œç¨‹åˆ†æ”¯(ä¸éœ€è¦å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯)"></a>åˆ é™¤è¿œç¨‹åˆ†æ”¯(ä¸éœ€è¦å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯)</h3><ol>
<li><code>git push origin --delete è¦åˆ é™¤çš„åˆ†æ”¯å</code> </li>
<li><code>git push origin -d åˆ†æ”¯å</code> </li>
<li><code>git push &lt;è¿œç¨‹åˆ†æ”¯å&gt; -d åˆ†æ”¯å</code> </li>
</ol>
<h3 id="åˆ é™¤æœ¬åœ°åˆ†æ”¯"><a href="#åˆ é™¤æœ¬åœ°åˆ†æ”¯" class="headerlink" title="åˆ é™¤æœ¬åœ°åˆ†æ”¯"></a>åˆ é™¤æœ¬åœ°åˆ†æ”¯</h3><p><code>git branch -d æœ¬åœ°åˆ†æ”¯å</code><br><code>git branch -D æœ¬åœ°åˆ†æ”¯å(åˆ†æ”¯æ²¡æœ‰å®Œå…¨mergeä¼šæŠ¥é”™æç¤ºï¼Œæ”¹ä¸ºå¼ºåˆ¶åˆ é™¤å³å¯)</code> </p>
<h3 id="æš‚å­˜ä¿®æ”¹"><a href="#æš‚å­˜ä¿®æ”¹" class="headerlink" title="æš‚å­˜ä¿®æ”¹"></a>æš‚å­˜ä¿®æ”¹</h3><ol>
<li>æš‚å­˜ <code>git stash save &quot;message&quot;</code> </li>
<li>æ¢å¤ <code>git stash apply</code> </li>
<li>æ¢å¤ä¹‹å‰ä¸€ä¸ª <code>git stash apply stash@{2}</code> </li>
<li>åˆ é™¤ <code>git stash drop</code> </li>
<li>æ¢å¤ + åˆ é™¤ <code>git stash pop</code> </li>
<li>åˆ—è¡¨ <code>git stash list</code> </li>
<li>ä»å‚¨è—åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ <code>git stash branch branchname</code> </li>
</ol>
<h3 id="æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯"><a href="#æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯"></a>æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯</h3><ol>
<li><code>git remote -v</code> </li>
</ol>
<h3 id="gitæ’¤é”€æ“ä½œ"><a href="#gitæ’¤é”€æ“ä½œ" class="headerlink" title="gitæ’¤é”€æ“ä½œ"></a>gitæ’¤é”€æ“ä½œ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- åªä¼šäº§ç”Ÿä¸€æ¬¡æäº¤ï¼Œç¬¬äºŒæ¬¡æäº¤ä¿®æ­£äº†ç¬¬ä¸€æ¬¡çš„æäº¤å†…å®¹ --&gt;</span><br><span class="line">&#96;git commit -m &#39;initial commit&#39;&#96; </span><br><span class="line">&#96;git add forgotten_file&#96; </span><br><span class="line">&#96;git commit --amend&#96;</span><br></pre></td></tr></table></figure>

<h3 id="æ–°å»ºåˆ†æ”¯"><a href="#æ–°å»ºåˆ†æ”¯" class="headerlink" title="æ–°å»ºåˆ†æ”¯"></a>æ–°å»ºåˆ†æ”¯</h3><p><code>git branch testing æ–°å»ºtestingåˆ†æ”¯ åœ¨å½“å‰commitå¯¹è±¡ä¸Šæ–°å»ºä¸€ä¸ªåˆ†æ”¯æŒ‡é’ˆï¼Œä¸ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ä¸­å»</code><br><code>git checkout -b iss53 æ–°å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</code><br><code>git push -u origin åˆ†æ”¯å</code> æäº¤æ–°å»ºçš„åˆ†æ”¯åˆ°è¿œç¨‹<br><code>git push origin åˆ†æ”¯å:åˆ†æ”¯å</code> æ¨é€æ–°åˆ†æ”¯åˆ°è¿œç¨‹<br><code>git fetch &lt;è¿œç¨‹ä¸»æœºå&gt; åŒæ­¥è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ•°æ®åˆ°æœ¬åœ°ã€‚</code><br><code>git fetch &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;åˆ†æ”¯å&gt;</code>å–å›ç‰¹å®šåˆ†æ”¯çš„æ›´æ–°<br><code>git checkout -b newBranch origin/master</code> åœ¨origin/masteråˆ†æ”¯çš„åŸºç¡€ä¸Šï¼Œæ–°å»ºä¸€ä¸ªåˆ†æ”¯</p>
<blockquote>
<p>å¦‚æœæ²¡æœ‰æ¨é€çš„è¿œç¨‹çš„è¯ï¼Œcommitä¹‹ååªä¼šæ˜¾ç¤º working tree clean</p>
</blockquote>
<h3 id="åˆ é™¤è¿œç¨‹åˆ†æ”¯"><a href="#åˆ é™¤è¿œç¨‹åˆ†æ”¯" class="headerlink" title="åˆ é™¤è¿œç¨‹åˆ†æ”¯"></a>åˆ é™¤è¿œç¨‹åˆ†æ”¯</h3><p><code>git push origin :[åˆ†æ”¯å]</code> åˆ é™¤è¿œç¨‹åˆ†æ”¯</p>
<!--SSHå…¬é’¥é»˜è®¤å­˜å‚¨åœ¨è´¦æˆ·çš„ä¸»ç›®å½•ä¸‹çš„~/.sshç›®å½• -->

<h3 id="ssh-key"><a href="#ssh-key" class="headerlink" title="ssh key"></a>ssh key</h3><p><code>cd ~/.ssh</code><br>æŸ¥æ‰¾æœ‰æ²¡æœ‰ <code>something</code> å’Œ <code>something.pub</code> æ¥å‘½åçš„ä¸€å¯¹æ–‡ä»¶ï¼Œè¿™ä¸ª <code>something</code> é€šå¸¸æ˜¯ <code>id_dsa</code> æˆ– <code>id_rsa</code> ã€‚<br>æœ‰ <code>.pub</code> åç¼€çš„æ–‡ä»¶å°±æ˜¯å…¬é’¥ï¼Œå¦ä¸€ä¸ªæ–‡ä»¶æ˜¯ç§é’¥ã€‚è‹¥ <code>.ssh</code> ç›®å½•æ²¡æœ‰ï¼Œå¯ä»¥ç”¨ <code>ssh-keygen</code> æ¥åˆ›å»ºã€‚</p>
<h3 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h3><ul>
<li>åˆå¹¶å¤šä¸ªcommitä¸º1ä¸ª</li>
<li>åˆå¹¶åˆ†æ”¯ <code>git rebase master</code> åœ¨masteråˆ†æ”¯ä¸Šçš„æœ€å…ˆæäº¤ä¸Šè¡¥ä¸Šå¼€å‘åˆ†æ”¯çš„ä»£ç </li>
</ul>
<h3 id="åˆå¹¶commit"><a href="#åˆå¹¶commit" class="headerlink" title="åˆå¹¶commit"></a>åˆå¹¶commit</h3><p><code>git</code> ä¿®æ”¹å¤šä¸ª <code>commit</code> ä¸ºä¸€ä¸ª <code>commit</code> </p>
<ol>
<li>ä»HEADç‰ˆæœ¬å¼€å§‹å¾€è¿‡å»æ•°3ä¸ªç‰ˆæœ¬ <code>git rebase -i HEAD~3</code><br>å°†åé¢çš„2ä¸ªcommitä¹‹å‰çš„pickæ”¹æˆsï¼Œè¡¨ç¤ºï¼Œè¦æŠŠåé¢çš„ä¸¤ä¸ªcommitåˆå¹¶åˆ°å‰ä¸€ä¸ªcommit</li>
</ol>
<p>æˆ–è€…ï¼ŒæŒ‡æ˜è¦åˆå¹¶çš„ç‰ˆæœ¬ä¹‹å‰çš„ç‰ˆæœ¬å· <code>git rebase -i commitIdï¼ˆä¸å‚ä¸åˆå¹¶ï¼‰</code> </p>
<ol start="2">
<li>é™¤äº†ç¬¬ä¸€ä¸ªä»¥å¤–ï¼Œåé¢çš„å¤šä¸ª <code>commit pick</code> æ”¹ä¸º <code>s</code> </li>
<li><code>esc</code> é”®é€€å‡ºç¼–è¾‘</li>
<li><code>:wq</code> é€€å‡º</li>
<li><code>git add .</code> </li>
<li><code>git rebase --continue</code> </li>
<li><code>git rebase --abort</code> æ”¾å¼ƒå‹ç¼©</li>
</ol>
<h3 id="æ’¤é”€æ”¹åŠ¨"><a href="#æ’¤é”€æ”¹åŠ¨" class="headerlink" title="æ’¤é”€æ”¹åŠ¨"></a>æ’¤é”€æ”¹åŠ¨</h3><p><code>git clean -f -d</code> ç§»é™¤å·¥ä½œç›®å½•ä¸­æ‰€æœ‰æœªè¿½è¸ªçš„æ–‡ä»¶ä»¥åŠç©ºçš„å­ç›®å½•<br>å¦‚æœåªæ˜¯æƒ³è¦çœ‹çœ‹å®ƒä¼šåšä»€ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨ -n é€‰é¡¹æ¥è¿è¡Œå‘½ä»¤ï¼Œè¿™æ„å‘³ç€ â€œåšä¸€æ¬¡æ¼”ä¹ ç„¶åå‘Šè¯‰ä½  å°†è¦ ç§»é™¤ä»€ä¹ˆâ€ã€‚<br><code>git clean -d -n</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">git checkout. / publish</span><br><span class="line">git clean - f. / publish</span><br></pre></td></tr></table></figure>

<h3 id="merge-åˆ†æ”¯"><a href="#merge-åˆ†æ”¯" class="headerlink" title="merge åˆ†æ”¯"></a>merge åˆ†æ”¯</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// merge ä»£ç ç”¨</span></span><br><span class="line">git merge åˆ†æ”¯å--squash</span><br><span class="line">git merge abort å–æ¶ˆåˆå¹¶</span><br></pre></td></tr></table></figure>

<h3 id="æ¯”è¾ƒä¸¤æ¬¡-commit-çš„å·®å¼‚"><a href="#æ¯”è¾ƒä¸¤æ¬¡-commit-çš„å·®å¼‚" class="headerlink" title="æ¯”è¾ƒä¸¤æ¬¡ commit çš„å·®å¼‚"></a>æ¯”è¾ƒä¸¤æ¬¡ commit çš„å·®å¼‚</h3><ol>
<li><p>æ¯”è¾ƒä¸¤æ¬¡commitæäº¤ä¹‹åçš„å·®å¼‚ï¼š<br><code>git diff hash1 hash2 --stat</code>èƒ½å¤ŸæŸ¥çœ‹å‡ºä¸¤æ¬¡æäº¤ä¹‹åï¼Œæ–‡ä»¶å‘ç”Ÿçš„å˜åŒ–ã€‚</p>
</li>
<li><p>å…·ä½“æŸ¥çœ‹ä¸¤æ¬¡commitæäº¤ä¹‹åæŸæ–‡ä»¶çš„å·®å¼‚ï¼š<br><code>git diff hash1 hash2 --æ–‡ä»¶å</code></p>
</li>
<li><p>æ¯”è¾ƒä¸¤ä¸ªåˆ†æ”¯çš„æ‰€æœ‰æœ‰å·®å¼‚çš„æ–‡ä»¶çš„è¯¦ç»†å·®å¼‚ï¼š<br><code>git diff branch1 branch2</code></p>
</li>
<li><p>æ¯”è¾ƒä¸¤ä¸ªåˆ†æ”¯çš„æŒ‡å®šæ–‡ä»¶çš„è¯¦ç»†å·®å¼‚<br><code>git diff branch1 branch2 æ–‡ä»¶å(å¸¦è·¯å¾„)</code></p>
</li>
<li><p>æ¯”è¾ƒä¸¤ä¸ªåˆ†æ”¯çš„æ‰€æœ‰æœ‰å·®å¼‚çš„æ–‡ä»¶åˆ—è¡¨<br><code>git diff branch1 branch2 --stat</code></p>
</li>
</ol>
<h3 id="æ’¤é”€å·²ç»æäº¤çš„commit"><a href="#æ’¤é”€å·²ç»æäº¤çš„commit" class="headerlink" title="æ’¤é”€å·²ç»æäº¤çš„commit"></a>æ’¤é”€å·²ç»æäº¤çš„commit</h3><p><code>git reset --hard HEAD~1</code> æ’¤é”€ä¸Šæ¬¡çš„commitï¼Œä¿ç•™ä¹‹å‰çš„æ›´æ”¹<br><code>git reset --hard &lt;éœ€è¦å›é€€åˆ°çš„ç‰ˆæœ¬å·ï¼ˆåªéœ€è¾“å…¥å‰å‡ ä½ï¼‰&gt;</code><br><code>git push origin &lt;åˆ†æ”¯å&gt; --force</code> æˆ–è€… <code>git push --force</code> å¼ºåˆ¶æäº¤</p>
<h3 id="åˆ é™¤ä¸­é—´æŸæ¬¡æäº¤-å¾…è¡¥å……"><a href="#åˆ é™¤ä¸­é—´æŸæ¬¡æäº¤-å¾…è¡¥å……" class="headerlink" title="åˆ é™¤ä¸­é—´æŸæ¬¡æäº¤(å¾…è¡¥å……)"></a>åˆ é™¤ä¸­é—´æŸæ¬¡æäº¤(å¾…è¡¥å……)</h3><ol>
<li>é¦–å…ˆ <code>git log</code> æŸ¥çœ‹æäº¤è®°å½•ï¼Œæ‰¾åˆ°å‡ºé”™çš„å‰ä¸€ç¬”æäº¤çš„ <code>commit_id</code> </li>
<li>ç”¨å‘½ä»¤ <code>git rebase -i commit_id</code> , æŸ¥æ‰¾æäº¤è®°å½•</li>
<li>å°†å‡ºé”™é‚£æ¬¡æäº¤çš„ <code>pick</code> æ”¹ä¸º <code>drop</code> </li>
<li><code>Escï¼Œ:wq</code> </li>
<li>å®Œæˆï¼</li>
</ol>
<h3 id="git-resetåˆ†ä¸ºä¸‰ç§æ¨¡å¼"><a href="#git-resetåˆ†ä¸ºä¸‰ç§æ¨¡å¼" class="headerlink" title="git resetåˆ†ä¸ºä¸‰ç§æ¨¡å¼"></a>git resetåˆ†ä¸ºä¸‰ç§æ¨¡å¼</h3><ul>
<li>soft </li>
<li>mixed </li>
<li>hard</li>
</ul>
<p><strong>git reset â€“hard commitId</strong><br>é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œå®Œå…¨é‡ç½®ä¸ºæŒ‡å®šçš„commitIdï¼Œå½“å‰åˆ†æ”¯æ²¡æœ‰commitçš„ä»£ç ä¼šè¢«æ¸…é™¤<br><strong>git reset â€“soft commitId</strong><br>ä¿ç•™å·¥ä½œç›®å½•ï¼ŒæŠŠæŒ‡å®šçš„commitèŠ‚ç‚¹ä¸å½“å‰åˆ†æ”¯çš„å·®å¼‚éƒ½å­˜å…¥æš‚å­˜åŒºã€‚æ²¡æœ‰è¢«commitçš„ä»£ç ä¹Ÿèƒ½å¤Ÿä¿ç•™ä¸‹æ¥<br><strong>git reset commitId</strong><br>ä¸å¸¦å‚æ•°ï¼Œå°±æ˜¯mixedæ¨¡å¼ã€‚å°†ä¼šä¿ç•™å·¥ä½œç›®å½•ï¼Œå¹¶æŠŠå·¥ä½œåŒºã€æš‚å­˜åŒºã€ä»¥åŠä¸resetçš„å·®å¼‚éƒ½æ”¾åˆ°å·¥ä½œåŒºï¼Œç„¶åæ¸…ç©ºæš‚å­˜åŒºã€‚</p>
<h3 id="rn-é¡¹ç›®æ“ä½œå‘½ä»¤"><a href="#rn-é¡¹ç›®æ“ä½œå‘½ä»¤" class="headerlink" title="rn é¡¹ç›®æ“ä½œå‘½ä»¤"></a>rn é¡¹ç›®æ“ä½œå‘½ä»¤</h3><p><code>xcrun simctl list devices</code> è·å–æ‰€æœ‰è®¾å¤‡åç§°<br><code>crn-cli run-ios --port=5390 --simulator=&quot;iPad Air (3rd generation)&quot; --reset</code> æŒ‡å®šæ‰“å¼€è®¾å¤‡</p>
<h3 id="å…³è”æœ¬åœ°é¡¹ç›®ä¸GitHub"><a href="#å…³è”æœ¬åœ°é¡¹ç›®ä¸GitHub" class="headerlink" title="å…³è”æœ¬åœ°é¡¹ç›®ä¸GitHub"></a>å…³è”æœ¬åœ°é¡¹ç›®ä¸GitHub</h3><ol>
<li>åœ¨æœ¬åœ°é¡¹ç›® <code>git init</code> </li>
<li><code>git add .</code> </li>
<li><code>git commit -m &quot; message&quot;</code> </li>
<li>åœ¨ <code>GitHub</code> å»ºç«‹ä¸€ä¸ªé¡¹ç›®</li>
<li>å¤åˆ¶é¡¹ç›® <code>HTTPS</code> åœ°å€</li>
<li><code>git remote add origin https åœ°å€</code> </li>
<li><code>git push -u origin master</code> </li>
</ol>
<h3 id="ä»£ç ç‰ˆæœ¬"><a href="#ä»£ç ç‰ˆæœ¬" class="headerlink" title="ä»£ç ç‰ˆæœ¬"></a>ä»£ç ç‰ˆæœ¬</h3><ol>
<li>æŸ¥çœ‹è¿‡å»ç‰ˆæœ¬ <code>git log --pretty=oneline</code> </li>
</ol>
<h3 id="æš‚å­˜åŒºæ–‡ä»¶æ’¤é”€"><a href="#æš‚å­˜åŒºæ–‡ä»¶æ’¤é”€" class="headerlink" title="æš‚å­˜åŒºæ–‡ä»¶æ’¤é”€"></a>æš‚å­˜åŒºæ–‡ä»¶æ’¤é”€</h3><ol>
<li><code>git reset HEAD æ–‡ä»¶</code> </li>
</ol>
<h3 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h3><ol>
<li>ä»ç‰ˆæœ¬åº“ä¸­åˆ é™¤æ–‡ä»¶ <code>git rm æ–‡ä»¶å</code> </li>
<li>ä»ç‰ˆæœ¬åº“ä¸­åˆ é™¤æ–‡ä»¶ï¼Œä½†æ˜¯æœ¬åœ°ä¸åˆ é™¤è¯¥æ–‡ä»¶ <code>git rm --cached æ–‡ä»¶å</code> </li>
</ol>
<h3 id="åˆ›å»ºåˆ†æ”¯"><a href="#åˆ›å»ºåˆ†æ”¯" class="headerlink" title="åˆ›å»ºåˆ†æ”¯"></a>åˆ›å»ºåˆ†æ”¯</h3><ol>
<li>ä»…åˆ›å»º <code>git branch åˆ†æ”¯å</code> </li>
<li>åˆ›å»ºå¹¶åˆ‡æ¢ <code>git checkout -b åˆ†æ”¯å</code> </li>
</ol>
<p><code>git branch -r</code>æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯</p>
<h2 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h2><p>npm rebuild  é‡å»ºè½¯ä»¶åŒ…<br>npm build</p>
<h3 id="ä¸-çš„åŒºåˆ«"><a href="#ä¸-çš„åŒºåˆ«" class="headerlink" title="^ ä¸ ~ çš„åŒºåˆ«"></a>^ ä¸ ~ çš„åŒºåˆ«</h3><ul>
<li>~ ä¼šåŒ¹é…æœ€è¿‘çš„å°ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œ~1.2.3 ä¼šåŒ¹é… 1.2.x </li>
<li>^ ä¼šåŒ¹é…æœ€æ–°çš„å¤§ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œ^1.2.3 ä¼šåŒ¹é… 1.x.x</li>
</ul>
<h2 id="Unexpected-end-of-JSON-input-while-parsing-near-â€˜â€¦-â€œhttp-registry-npm-39"><a href="#Unexpected-end-of-JSON-input-while-parsing-near-â€˜â€¦-â€œhttp-registry-npm-39" class="headerlink" title="Unexpected end of JSON input while parsing near â€˜â€¦ â€œhttp://registry.npm.&#39;"></a>Unexpected end of JSON input while parsing near â€˜â€¦ â€œ<a href="http://registry.npm.&#39;" target="_blank" rel="noopener">http://registry.npm.&#39;</a></h2><p>ç¬¬ä¸€æ­¥<br><code>npm cache clean --force</code><br>ç¬¬äºŒæ­¥<br><code>npm install --registry=https://registry.npmï¼ˆé•œåƒï¼‰</code> </p>
<p>åŸå› ï¼šå¯ä»¥å…ˆçœ‹ä¸‹npm installçš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<ul>
<li>å‘å‡ºnpm installå‘½ä»¤</li>
<li>npm å‘ registry æŸ¥è¯¢æ¨¡å—å‹ç¼©åŒ…çš„ç½‘å€</li>
<li>ä¸‹è½½å‹ç¼©åŒ…ï¼Œå­˜æ”¾åœ¨~/.npm(æœ¬åœ°NPMç¼“å­˜è·¯å¾„)ç›®å½•</li>
<li>è§£å‹å‹ç¼©åŒ…åˆ°å½“å‰é¡¹ç›®çš„node_modulesç›®å½•</li>
</ul>
<p>&nbsp; &nbsp; å®é™…ä¸Šè¯´ä¸€ä¸ªæ¨¡å—å®‰è£…ä»¥åï¼Œæœ¬åœ°å…¶å®ä¿å­˜äº†ä¸¤ä»½ã€‚ä¸€ä»½æ˜¯ ~/.npm ç›®å½•ä¸‹çš„å‹ç¼©åŒ…ï¼Œå¦ä¸€ä»½æ˜¯ node_modules ç›®å½•ä¸‹è§£å‹åçš„ä»£ç ã€‚ä½†æ˜¯ï¼Œè¿è¡Œ npm install çš„æ—¶å€™ï¼Œåªä¼šæ£€æŸ¥ node_modules ç›®å½•ï¼Œè€Œä¸ä¼šæ£€æŸ¥ ~/.npm ç›®å½•ã€‚å¦‚æœä¸€ä¸ªæ¨¡å—åœ¨ ~./npm ä¸‹æœ‰å‹ç¼©åŒ…ï¼Œä½†æ˜¯æ²¡æœ‰å®‰è£…åœ¨ node_modules ç›®å½•ä¸­ï¼Œnpm ä¾ç„¶ä¼šä»è¿œç¨‹ä»“åº“ä¸‹è½½ä¸€æ¬¡æ–°çš„å‹ç¼©åŒ…ã€‚</p>
<p>&nbsp; &nbsp; æˆ‘ä»¬æƒ³åˆ©ç”¨å·²ç»åœ¨ç¼“å­˜ä¸­ä¹‹å‰å·²ç»å¤‡ä»½çš„æ¨¡å—å®ç°ç¦»çº¿æ¨¡å—å®‰è£…çš„çš„ cache æœºåˆ¶å·²ç»åœ¨V5çš„æ—¶å€™é‡å†™äº†ï¼Œç¼“å­˜å°†ç”± npm æ¥å…¨å±€ç»´æŠ¤ä¸å†éœ€è¦å¼€å‘äººå‘˜æ“å¿ƒï¼Œç¦»çº¿å®‰è£…æ—¶å°†ä¸å†å°è¯•è¿æ¥ç½‘ç»œï¼Œè€Œæ˜¯é™çº§å°è¯•ä»ç¼“å­˜ä¸­è¯»å–ï¼Œæˆ–ç›´æ¥å¤±è´¥ã€‚å°±æ˜¯å¦‚æœä½  offline ï¼Œnpmå°†æ— ç¼åœ°ä½¿ç”¨æ‚¨çš„ç¼“å­˜ã€‚</p>
<p>&nbsp; &nbsp; è¿™æ˜¯ä¸€ä¸ªä¸npmç¼“å­˜è…è´¥çš„é—®é¢˜ã€‚å°½ç®¡åœ¨è¾ƒæ–°ç‰ˆæœ¬çš„npmä¸­ä»–ä»¬å®ç°äº†è‡ªæˆ‘ä¿®å¤ï¼Œè¿™é€šå¸¸å¯ä»¥ä¿è¯æ²¡æœ‰è…è´¥ï¼Œä½†ä¼¼ä¹å¹¶ä¸é‚£ä¹ˆæœ‰æ•ˆã€‚</p>
<h3 id="é’©å­"><a href="#é’©å­" class="headerlink" title="é’©å­"></a>é’©å­</h3><p>npm è„šæœ¬æœ‰preå’Œpostä¸¤ä¸ªé’©å­ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œbuildè„šæœ¬å‘½ä»¤çš„é’©å­å°±æ˜¯prebuildå’Œpostbuild<br>ç”¨æˆ·æ‰§è¡Œnpm run buildçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æŒ‰ç…§ <code>npm run prebuild &amp;&amp; npm run build &amp;&amp; npm run postbuild</code> çš„é¡ºåºæ‰§è¡Œ</p>
<h3 id="æ›´æ–°-npm-æ’ä»¶"><a href="#æ›´æ–°-npm-æ’ä»¶" class="headerlink" title="æ›´æ–° npm æ’ä»¶"></a>æ›´æ–° npm æ’ä»¶</h3><p><code>npm update &lt;name&gt; [-g] [--save-dev]</code></p>
<h3 id="vscode-è‡ªå¸¦ç»ˆç«¯ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½æŠ¥é”™è¯¯"><a href="#vscode-è‡ªå¸¦ç»ˆç«¯ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½æŠ¥é”™è¯¯" class="headerlink" title="vscode è‡ªå¸¦ç»ˆç«¯ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½æŠ¥é”™è¯¯"></a>vscode è‡ªå¸¦ç»ˆç«¯ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½æŠ¥é”™è¯¯</h3><p><code>nvm is not compatible with the npm config &quot;prefix&quot; option: currently set to &quot;/usr/local&quot; Run &quot;npm config delete prefix&quot; or &quot;nvm use --delete-prefix v10.15.1 --silent&quot; to unset it.</code> </p>
<p>ğŸ‘‡<br><code>npm config delete prefix</code><br><code>npm config set prefix $NVM_DIR/versions/node/v10.15.1</code> </p>
<p><img src="http://ww1.sinaimg.cn/large/92babc53gy1gbmq2fukejj21ai35sqm4.jpg" alt="git.jpg"></p>
<h2 id="Linuxå‘½ä»¤"><a href="#Linuxå‘½ä»¤" class="headerlink" title="Linuxå‘½ä»¤"></a>Linuxå‘½ä»¤</h2><p>cat file.js è¾“å…¥ file.js æ–‡ä»¶å†…å®¹</p>
]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>reactç»„ä»¶å¤ç”¨</title>
    <url>/2020/04/04/react%E7%BB%84%E4%BB%B6%E5%A4%8D%E7%94%A8/</url>
    <content><![CDATA[<p>ç»„ä»¶å¤ç”¨çš„ä¸¤ç§å½¢å¼ï¼šé«˜é˜¶ç»„ä»· å’Œ å‡½æ•°ä½œä¸ºå­ç»„ä»¶</p>
<a id="more"></a>
<h3 id="é«˜é˜¶ç»„ä»¶"><a href="#é«˜é˜¶ç»„ä»¶" class="headerlink" title="é«˜é˜¶ç»„ä»¶"></a>é«˜é˜¶ç»„ä»¶</h3><p>é«˜é˜¶ç»„ä»¶ä¸€èˆ¬ä¸ä¼šæœ‰è‡ªå·±çš„UIå±•ç°ï¼Œè€Œåªæ˜¯ä¸ºä»–å°è£…çš„ç»„ä»¶æä¾›é¢å¤–çš„åŠŸèƒ½æˆ–è€…æ•°æ®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Clock constructed"</span>);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Clock did mount"</span>);</span><br><span class="line">    <span class="keyword">this</span>.timerID = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.tick(), <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Clock will unmount"</span>);</span><br><span class="line">    clearInterval(<span class="keyword">this</span>.timerID);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Clock did update"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h2&gt;</span><br><span class="line">          It is &#123;<span class="keyword">this</span>.state.date.toLocaleTimeString()&#125;.</span><br><span class="line">        &lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>é«˜é˜¶ç»„ä»¶<br>withTimerç»™å·²æœ‰çš„ç»„ä»¶æ³¨å…¥è®¡æ—¶å™¨çš„åŠŸèƒ½</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">withTimer</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123; <span class="attr">time</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">      <span class="keyword">this</span>.timerID = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.tick(), <span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">      clearInterval(<span class="keyword">this</span>.timerID);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tick() &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        time: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> <span class="attr">time</span>=<span class="string">&#123;this.state.time&#125;</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span>;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>


<h3 id="å‡½æ•°ä½œä¸ºå­ç»„ä»¶"><a href="#å‡½æ•°ä½œä¸ºå­ç»„ä»¶" class="headerlink" title="å‡½æ•°ä½œä¸ºå­ç»„ä»¶"></a>å‡½æ•°ä½œä¸ºå­ç»„ä»¶</h3><p>æŠŠå‡½æ•°ä½œä¸ºchildrenï¼Œç»„ä»¶å¦‚ä½•å‘ˆç°ç”±ä½¿ç”¨ä»–çš„äººæ¥å†³å®š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">component</span></span>&#123;</span><br><span class="line">  render()&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.props.children(<span class="string">'hello'</span>)&#125;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;MyComponent&gt;</span></span><br><span class="line"><span class="regexp">&#123;(name)=&gt;(</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;&#123;name&#125;&lt;/</span>div&gt;</span><br><span class="line">)&#125;</span><br><span class="line">&lt;<span class="regexp">/MyComponent&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; PureComponent &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">"prop-types"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">AdvancedTabSelector</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    value: PropTypes.object,</span><br><span class="line">    options: PropTypes.array,</span><br><span class="line">    onChange: PropTypes.func,</span><br><span class="line">    children: PropTypes.func</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    value: <span class="literal">null</span>,</span><br><span class="line">    options: [],</span><br><span class="line">    onChange: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;,</span><br><span class="line">    children: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; options, value, onChange &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"tab-selector"</span>&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          &#123;options.map(<span class="function"><span class="params">opt</span> =&gt;</span> (</span><br><span class="line">            &lt;li</span><br><span class="line">              key=&#123;opt.value&#125;</span><br><span class="line">              className=&#123;<span class="string">`tab-item <span class="subst">$&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">                opt.value === <span class="keyword">this</span>.props.value ? <span class="string">"selected"</span> : <span class="string">""</span></span></span></span><br><span class="line"><span class="string"><span class="subst">              &#125;</span>`</span>&#125;</span><br><span class="line">              onClick=&#123;() =&gt; <span class="keyword">this</span>.props.onChange(opt.value)&#125;</span><br><span class="line">            &gt;</span><br><span class="line">              &#123;opt.name&#125;</span><br><span class="line">            &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">          ))&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/u</span>l&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.props.value &amp;&amp; <span class="keyword">this</span>.props.children(<span class="keyword">this</span>.props.value)&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const colors = [</span></span><br><span class="line"><span class="regexp">  &#123; name: "Red", value: "red" &#125;,</span></span><br><span class="line"><span class="regexp">  &#123; name: "Blue", value: "blue" &#125;,</span></span><br><span class="line"><span class="regexp">  &#123; name: "Orange", value: "orange" &#125;</span></span><br><span class="line"><span class="regexp">];</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const animals = [</span></span><br><span class="line"><span class="regexp">  &#123; name: "Tiger", value: "tiger" &#125;,</span></span><br><span class="line"><span class="regexp">  &#123; name: "Elephant", value: "elephant" &#125;,</span></span><br><span class="line"><span class="regexp">  &#123; name: "Cow", value: "cow" &#125;</span></span><br><span class="line"><span class="regexp">];</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export class AdvancedTabSelectorSample extends PureComponent &#123;</span></span><br><span class="line"><span class="regexp">  state = &#123;</span></span><br><span class="line"><span class="regexp">    color: null</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h3&gt;Select color: &lt;/</span>h3&gt;</span><br><span class="line">        &lt;AdvancedTabSelector</span><br><span class="line">          options=&#123;colors&#125;</span><br><span class="line">          value=&#123;<span class="keyword">this</span>.state.color&#125;</span><br><span class="line">          onChange=&#123;c =&gt; <span class="keyword">this</span>.setState(&#123; <span class="attr">color</span>: c &#125;)&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;color =&gt; (</span><br><span class="line">            &lt;span</span><br><span class="line">              style=&#123;&#123;</span><br><span class="line">                display: <span class="string">"inline-block"</span>,</span><br><span class="line">                backgroundColor: color,</span><br><span class="line">                width: <span class="string">"40px"</span>,</span><br><span class="line">                height: <span class="string">"40px"</span></span><br><span class="line">              &#125;&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          )&#125;</span><br><span class="line">        &lt;<span class="regexp">/AdvancedTabSelector&gt;</span></span><br><span class="line"><span class="regexp">        &lt;br /</span>&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;h3&gt;Select animal: <span class="xml"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line">        &lt;AdvancedTabSelector</span><br><span class="line">          options=&#123;animals&#125;</span><br><span class="line">          value=&#123;<span class="keyword">this</span>.state.animal&#125;</span><br><span class="line">          onChange=&#123;c =&gt; <span class="keyword">this</span>.setState(&#123; <span class="attr">animal</span>: c &#125;)&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;animal =&gt; (</span><br><span class="line">            &lt;img width=<span class="string">"100px"</span> src=&#123;<span class="built_in">require</span>(<span class="string">`../../images/<span class="subst">$&#123;animal&#125;</span>.png`</span>)&#125; /&gt;</span><br><span class="line">          )&#125;</span><br><span class="line">        &lt;<span class="regexp">/AdvancedTabSelector&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æå®¢æ—¶é—´</category>
      </categories>
  </entry>
  <entry>
    <title>Proxy</title>
    <url>/2020/04/04/Proxy/</url>
    <content><![CDATA[<p>Proxyç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥ç†è§£æˆåœ¨ç›®æ ‡å¯¹è±¡å‰æ‹¦æˆªã€‚</p>
<a id="more"></a>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target,handler)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">    <span class="keyword">get</span>: function (target, key, receiver) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`getting <span class="subst">$&#123;key&#125;</span>!`</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function (target, key, value, receiver) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;key&#125;</span>!`</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">obj.count = <span class="number">1</span></span><br><span class="line">++obj.count</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç è¯´æ˜ï¼ŒProxy å®é™…ä¸Šé‡è½½äº†ç‚¹è¿ç®—ç¬¦ï¼Œå³ç”¨è‡ªå·±çš„å®šä¹‰è¦†ç›–äº†è¯­è¨€çš„åŸå§‹å®šä¹‰ã€‚</p>
<p>è¦ä½¿proxyèµ·ä½œç”¨ï¼Œå¿…é¡»é’ˆå¯¹proxyå®ä¾‹è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç›®æ ‡å¯¹è±¡ã€‚å¦‚æœhandleræ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£å°±ç­‰åŒäºç›´æ¥é€šå‘åŸå¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> handler = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler)</span><br><span class="line">proxy.a = <span class="string">'b'</span></span><br><span class="line"><span class="built_in">console</span>.log(target.a)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">    <span class="keyword">get</span>: function (target, name) &#123;</span><br><span class="line">        <span class="keyword">if</span> (name === <span class="string">'prototype'</span>) <span class="keyword">return</span> <span class="built_in">Object</span>.prototype</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Hello, '</span> + name</span><br><span class="line">    &#125;,</span><br><span class="line">    apply: <span class="function"><span class="keyword">function</span> (<span class="params">target, thisBinding, args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> args[<span class="number">0</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">constructor</span>: function (target, args) &#123;</span><br><span class="line">        <span class="keyword">return</span> args[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fproxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(<span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">&#125;, handler)</span><br><span class="line"></span><br><span class="line">fproxy(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">new</span> fproxy(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fproxy.prototype</span><br><span class="line">fproxy.foo</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createArray</span>(<span class="params">...elements</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> handler = &#123;</span><br><span class="line">        <span class="keyword">get</span>(target, propKey, receiver) &#123;</span><br><span class="line">            <span class="keyword">let</span> index = <span class="built_in">Number</span>(propKey)</span><br><span class="line">            <span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                propKey = <span class="built_in">String</span>(target.length + index)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, propKey, receiver)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> target = []</span><br><span class="line">    target.push(...elements)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = createArray(<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(arr[<span class="number">-1</span>])</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ES6</category>
      </categories>
  </entry>
  <entry>
    <title>WebStormå¿«æ·é”®</title>
    <url>/2020/02/25/WebStorm%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    <content><![CDATA[<p>webStormå¿«æ·é”®æ±‡æ€»</p>
<a id="more"></a>
<p>command + option + L æ ¼å¼åŒ–ä»£ç <br>command + shift + O è·³åˆ°æŸä¸ªæ–‡ä»¶<br>ctrl + alt + R è¿è¡Œæ–‡ä»¶<br>alt + f12 æ‰“å¼€ç»ˆç«¯<br>cmd + d å¤åˆ¶å½“å‰è¡Œ<br>command + option + esc æ€è¿›ç¨‹</p>
<p>command + / å•è¡Œæ³¨é‡Š</p>
<p>command + option + / å¤šè¡Œæ³¨é‡Š</p>
<p>/** + enter æ–¹æ³•æ³¨é‡Š</p>
<p>command + alt + T ç”¨ ifâ€¦elseâ€¦ æˆ–è€… tryâ€¦catch åŒ…ä½</p>
<p>alt + / ä¸ enter åŠŸèƒ½ç›¸ä¼¼ï¼Œä»£ç è‡ªåŠ¨è¡¥å…¨</p>
<p>command + R æ›¿æ¢</p>
<p>command + G æŸ¥æ‰¾ä¸‹ä¸€ä¸ª</p>
<p>shift + F6 é‡å‘½å</p>
<p>cmd + home å›åˆ°é¡¶éƒ¨</p>
<p>ctrl + tab åˆ‡æ¢å¯¼èˆªæ æ–‡ä»¶</p>
<p>cmd+shift+r æ‰¹é‡æ›¿æ¢<br>ctrl+shift+g æ‰¹é‡æŸ¥æ‰¾</p>
]]></content>
  </entry>
  <entry>
    <title>HooksåŸç†</title>
    <url>/2020/01/14/Hooks%E5%8E%9F%E7%90%86/</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>!TODO å¦‚ä½•åœ¨hooksä¸­ä½¿ç”¨å¼‚æ­¥æ–¹æ³•ï¼Ÿ</p>
<p><a href="https://github.com/brickspert/blog/issues/26" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
<a id="more"></a>


<h3 id="useState-åŸç†"><a href="#useState-åŸç†" class="headerlink" title="useState åŸç†"></a>useState åŸç†</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Count</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;&#123;count&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button onClick=&#123;() =&gt; &#123; setCount(count + 1) &#125;&#125;&gt;ç‚¹å‡»&lt;/</span>Button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">let _state</span></span><br><span class="line"><span class="regexp">function useState(initialValue) &#123;</span></span><br><span class="line"><span class="regexp">  _state = initialValue</span></span><br><span class="line"><span class="regexp">  function setState(newValue) &#123;</span></span><br><span class="line"><span class="regexp">    _state = newValue</span></span><br><span class="line"><span class="regexp">    render()</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  return [_state, setState]</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="useEffect-åŸç†"><a href="#useEffect-åŸç†" class="headerlink" title="useEffect åŸç†"></a>useEffect åŸç†</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(count)</span><br><span class="line">&#125;, [count])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> _deps</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useEffect</span>(<span class="params">callback, depArray</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> hasNoDeps = !depArray</span><br><span class="line">  <span class="keyword">const</span> hasChangedDeps = _deps</span><br><span class="line">    ? !depArray.every(<span class="function">(<span class="params">el, i</span>) =&gt;</span> el === _deps[i])</span><br><span class="line">    : <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (hasNoDeps || hasChangedDeps) &#123;</span><br><span class="line">    callback()</span><br><span class="line">    _deps = depArray</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœé¡µé¢ä¸­éœ€è¦ä½¿ç”¨å¤šä¸ªuseStateå°±ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºuseStateéœ€è¦å…¬ç”¨å…¨å±€å˜é‡_stateï¼Œæˆ‘ä»¬éœ€è¦å¯ä»¥å­˜å‚¨å¤šä¸ª_state å’Œ _deps</p>
<p>å…³é”®åœ¨äºï¼š</p>
<ol>
<li>åˆæ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼ŒæŒ‰ç…§useStateã€useEffectçš„é¡ºåºï¼ŒæŠŠstateï¼Œdepsç­‰æŒ‰é¡ºåºå¡åˆ° memoizedState æ•°ç»„ä¸­</li>
<li>æ›´æ–°çš„æ—¶å€™ï¼ŒæŒ‰ç…§é¡ºåºï¼Œä» memoizedState ä¸­æŠŠä¸Šæ¬¡è®°å½•çš„å€¼æ‹¿å›æ¥ã€‚</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> memoizedState = []</span><br><span class="line"><span class="keyword">let</span> cursor = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useState</span>(<span class="params">initialValue</span>) </span>&#123;</span><br><span class="line">  memoizedState[cursor] = memoizedState[cursor] || initialValue</span><br><span class="line">  <span class="keyword">const</span> currentCursor = cursor</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setState</span>(<span class="params">newState</span>) </span>&#123;</span><br><span class="line">    memoizedState[currentCursor] = newState</span><br><span class="line">    render()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [memoizedState[cursor + <span class="number">1</span>], setState] <span class="comment">//  è¿”å›å½“å‰ stateï¼Œå¹¶æŠŠ cursor åŠ  1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useEffect</span>(<span class="params">callback, depArray</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> hasNoDeps = !depArray</span><br><span class="line">  <span class="keyword">const</span> deps = memoizedState[cursor]</span><br><span class="line">  <span class="keyword">const</span> hasChangedDeps = deps</span><br><span class="line">    ? !depArray.every(<span class="function">(<span class="params">el, i</span>) =&gt;</span> el === deps[i])</span><br><span class="line">    : <span class="literal">true</span></span><br><span class="line">  <span class="keyword">if</span> (hasNoDeps || hasChangedDeps) &#123;</span><br><span class="line">    callback()</span><br><span class="line">    memoizedState[cursor] = depArray</span><br><span class="line">  &#125;</span><br><span class="line">  cursor++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>react-router</title>
    <url>/2020/04/04/react-router/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>æå®¢æ—¶é—´</category>
      </categories>
  </entry>
  <entry>
    <title>reactæ€§èƒ½ä¼˜åŒ–</title>
    <url>/2020/04/04/react%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<p>å¼‚æ­¥æ¸²æŸ“çš„ä¸¤ä¸ªéƒ¨åˆ†</p>
<ul>
<li>æ—¶é—´åˆ†ç‰‡<br>DOMæ“ä½œçš„ä¼˜å…ˆçº§ä½äºæµè§ˆå™¨åŸç”Ÿè¡Œä¸ºï¼Œä¾‹å¦‚é”®ç›˜å’Œé¼ æ ‡è¾“å…¥ï¼Œä»è€Œä¿è¯æ“ä½œçš„æµç•…</li>
<li>æ¸²æŸ“æŒ‚èµ·<br>è™šæ‹ŸDOMèŠ‚ç‚¹å¯ä»¥ç­‰å¾…æŸä¸ªå¼‚æ­¥æ“ä½œçš„å®Œæˆï¼Œå¹¶æŒ‡å®štimeoutï¼Œä¹‹åæ‰å®ŒæˆçœŸæ­£çš„æ¸²æŸ“ã€‚</li>
</ul>
<h3 id="æ—¶é—´åˆ†ç‰‡"><a href="#æ—¶é—´åˆ†ç‰‡" class="headerlink" title="æ—¶é—´åˆ†ç‰‡"></a>æ—¶é—´åˆ†ç‰‡</h3><ol>
<li>è™šæ‹Ÿdomçš„diffæ“ä½œå¯ä»¥åˆ†ç‰‡è¿›è¡Œ</li>
<li>Reactæ–°APIï¼šunstable_deferredUpdates<br>UIæ›´æ–°ä¼šç­‰å…¶ä»–é«˜ä¼˜å…ˆçº§çš„UIæ›´æ–°å…ˆå®Œæˆä¹‹åæ‰æ›´æ–°</li>
<li>Chromeæ–°çš„APIï¼šrequestIdleCallback<br>æµè§ˆå™¨å‘Šè¯‰ä½ ä»€ä¹ˆæ—¶å€™æµè§ˆå™¨ä¸å¿™äº†</li>
</ol>
]]></content>
      <categories>
        <category>æå®¢æ—¶é—´</category>
      </categories>
  </entry>
  <entry>
    <title>é˜²æŠ–å’ŒèŠ‚æµ</title>
    <url>/2020/03/12/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81/</url>
    <content><![CDATA[<h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="headerlink" title="é˜²æŠ–"></a>é˜²æŠ–</h3><blockquote>
<p>ä½ å°½ç®¡è§¦å‘äº‹ä»¶ï¼Œä½†æ˜¯æˆ‘ä¸€å®šåœ¨äº‹ä»¶è§¦å‘ n ç§’åæ‰æ‰§è¡Œï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„ n ç§’å†…åˆè§¦å‘äº†è¿™ä¸ªäº‹ä»¶ï¼Œé‚£æˆ‘å°±ä»¥æ–°çš„äº‹ä»¶çš„æ—¶é—´ä¸ºå‡†ï¼Œn ç§’åæ‰æ‰§è¡Œï¼Œæ€»ä¹‹ï¼Œå°±æ˜¯è¦ç­‰ä½ è§¦å‘å®Œäº‹ä»¶ n ç§’å†…ä¸å†è§¦å‘äº‹ä»¶</p>
</blockquote>
<a id="more"></a>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"width: 100px;height: 100px;border: 1px solid red"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> count = <span class="number">0</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> container = <span class="built_in">document</span>.querySelector(<span class="string">'#container'</span>)</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">getUserAction</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.innerHTML = count++</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">debounce</span><span class="params">(fn)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> timer</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> context = <span class="keyword">this</span></span></span><br><span class="line">            clearTimeout(timer)</span><br><span class="line"><span class="javascript">            timer = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">                fn.apply(context,<span class="built_in">arguments</span>)</span></span><br><span class="line">            &#125;,1000)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    container.onmousemove = debounce(getUserAction)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h3><blockquote>
<p>å¦‚æœä½ æŒç»­è§¦å‘äº‹ä»¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œåªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶</p>
</blockquote>
<h4 id="ä½¿ç”¨æ—¶é—´æˆ³"><a href="#ä½¿ç”¨æ—¶é—´æˆ³" class="headerlink" title="ä½¿ç”¨æ—¶é—´æˆ³"></a>ä½¿ç”¨æ—¶é—´æˆ³</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;div id="container" style="width: 100px;height: 100px;border: 1px solid red"&gt;&lt;/</span>div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">const</span> container = <span class="built_in">document</span>.querySelector(<span class="string">'#container'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getUserAction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.innerHTML = count++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> previous = <span class="number">0</span></span><br><span class="line">        <span class="keyword">let</span> context,args</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">            context = <span class="keyword">this</span></span><br><span class="line">            args = <span class="built_in">arguments</span></span><br><span class="line">            <span class="keyword">if</span>(now-previous&gt;<span class="number">1000</span>)&#123;</span><br><span class="line">                fn.apply(context,args)</span><br><span class="line">                previous = now</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    container.onmousemove = debounce(getUserAction)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨å®šæ—¶å™¨"><a href="#ä½¿ç”¨å®šæ—¶å™¨" class="headerlink" title="ä½¿ç”¨å®šæ—¶å™¨"></a>ä½¿ç”¨å®šæ—¶å™¨</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"width: 100px;height: 100px;border: 1px solid red"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> count = <span class="number">0</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> container = <span class="built_in">document</span>.querySelector(<span class="string">'#container'</span>)</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">getUserAction</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.innerHTML = count++</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">throttle</span><span class="params">(fn)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> previous = <span class="number">0</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> timeout</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>()</span></span><br><span class="line"><span class="actionscript">            context = <span class="keyword">this</span></span></span><br><span class="line"><span class="javascript">            args = <span class="built_in">arguments</span></span></span><br><span class="line">            if(!timeout)&#123;</span><br><span class="line"><span class="javascript">                timeout = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="actionscript">                    timeout = <span class="literal">null</span></span></span><br><span class="line">                    fn.apply(context,args)</span><br><span class="line">                &#125;,1000)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    container.onmousemove = throttle(getUserAction)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>React</title>
    <url>/2019/12/28/React/</url>
    <content><![CDATA[<h3 id="React-å¦‚ä½•åŒºåˆ†-class-å’Œ-functions"><a href="#React-å¦‚ä½•åŒºåˆ†-class-å’Œ-functions" class="headerlink" title="React å¦‚ä½•åŒºåˆ† class å’Œ functions"></a><a href="https://overreacted.io/zh-hans/how-does-react-tell-a-class-from-a-function/" target="_blank" rel="noopener">React å¦‚ä½•åŒºåˆ† class å’Œ functions</a></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span> &gt;</span> Hello <span class="tag">&lt; /<span class="attr">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span> &gt;</span> hello <span class="tag">&lt; /<span class="attr">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>å¦‚æœ Greeting æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒReact éœ€è¦è°ƒç”¨å®ƒã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> result = Greeting(props)</span><br></pre></td></tr></table></figure>

<p>ä½†å¦‚æœ Greeting æ˜¯ä¸€ä¸ªç±»ï¼ŒReact éœ€è¦å…ˆç”¨ new æ“ä½œç¬¦å°†å…¶å®ä¾‹åŒ–ï¼Œç„¶å è°ƒç”¨åˆšæ‰ç”Ÿæˆå®ä¾‹çš„ render æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> Greeting(props); <span class="comment">// Greeting &#123;&#125;</span></span><br><span class="line"><span class="keyword">const</span> result = instance.render(); <span class="comment">// &lt;p&gt;Hello&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>

<p>new çš„ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ª {} å¯¹è±¡å¹¶æŠŠ Person ä¸­çš„ this æŒ‡å‘é‚£ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿æˆ‘å¯ä»¥é€šè¿‡ç±»ä¼¼ this.name çš„å½¢å¼å»è®¾ç½®ä¸€äº›ä¸œè¥¿ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡è¿”å›ç»™æˆ‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fred = <span class="keyword">new</span> Person(<span class="string">'Fred'</span>)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype çš„ç‰¹ç‚¹æ¥æ£€æµ‹ç®­å¤´å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;).prototype <span class="comment">// undefined</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;).prototype <span class="comment">// &#123;constructor: f&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Hello'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Greeting(); <span class="comment">// âœ… 'Hello'</span></span><br><span class="line"><span class="keyword">new</span> Greeting(); <span class="comment">// ğŸ˜³ Greeting &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p> dangerouslySetInnerHTML æ˜¯ React æä¾›çš„æ›¿æ¢æµè§ˆå™¨ DOM ä¸­çš„ innerHTML æ¥å£çš„ä¸€ä¸ªå‚æ•°ã€‚<br>ä¸€èˆ¬è€Œè¨€ï¼Œä½¿ç”¨ JS ä»£ç è®¾ç½® HTML æ–‡æ¡£çš„å†…å®¹æ˜¯å±é™©çš„ï¼Œå› ä¸ºè¿™æ ·å¾ˆå®¹æ˜“æŠŠä½ çš„ç”¨æˆ·ä¿¡æ¯æš´éœ²ç»™è·¨ç«™è„šæœ¬æ”»å‡». æ‰€ä»¥ï¼Œä½ è™½ç„¶å¯ä»¥ç›´æ¥åœ¨ React ä¸­è®¾ç½® html çš„å†…å®¹ï¼Œä½†ä½ è¦ä½¿ç”¨ dangerouslySetInnerHTML å¹¶å‘è¯¥å‡½æ•°ä¼ é€’ä¸€ä¸ªå«æœ‰__html é”®çš„å¯¹è±¡ï¼Œç”¨æ¥æé†’ä½ è‡ªå·±è¿™æ ·åšå¾ˆå±é™©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ProfilePage</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">"Followed "</span> + props.user);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">        handleClick</span></span><br><span class="line"><span class="xml">    &#125; &gt; Follow <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function handleClickä¸éœ€è¦ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œç”¨ä¸ç”¨ç®­å¤´å‡½æ•°çš„è¡¨ç°å½¢å¼éƒ½æ˜¯ä¸€æ ·çš„</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">"Followed "</span> + <span class="keyword">this</span>.props.user);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="keyword">this</span>.showMessage, <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">            this.handleClick</span></span><br><span class="line"><span class="xml">        &#125; &gt; Follow <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>function å’Œ class çš„åŒºåˆ«åœ¨äºï¼š<br>1ã€ç‚¹å‡» function æ—è¾¹çš„æŒ‰é’®ï¼Œç„¶ååœ¨ä¸‰ç§’å†…æ”¹å˜ select è¾“å…¥æ¡†çš„å€¼ï¼šä¾‹å¦‚ä» Dan æ”¹ä¸º Sophieï¼Œå¼¹æ¡†å¼¹å‡º Dan<br>2ã€ç‚¹å‡» class æ—è¾¹çš„æŒ‰é’®ï¼Œç„¶åä¸‰ç§’å†…æ”¹å˜ select è¾“å…¥æ¡†çš„å€¼ï¼Œå¼¹æ¡†å¼¹å‡º Sophieã€‚<br>åœ¨è¿™ä¸¤ç§è¡¨ç°å½¢å¼ä¸­ï¼Œfunction è¡¨ç°çš„æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>é‚£ä¸ºä½• class ä¼šè¿™æ ·çš„è¡¨ç°å‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            alert(<span class="string">'Followed '</span> + <span class="keyword">this</span>.props.user);</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure>

<p>åœ¨ react ä¸­ï¼Œprops æ˜¯ä¸å¯å˜æ›´çš„ï¼Œä½†æ˜¯ this æ€»æ˜¯å¯å˜çš„ã€‚React ç»è¿‡ä¸€æ®µæ—¶é—´åæ”¹å˜è‡ªå·±ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ render å’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­å¾—åˆ°æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³ class çš„è¿™ç§é—®é¢˜å‘¢ï¼Ÿ<br>1ã€æ—©ç‚¹è¯» this.props, å¹¶ä¸”æŠŠå€¼ä¼ é€’ä¸‹å»</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    showMessage = <span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">"Followed "</span> + user);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            user</span><br><span class="line">        &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.showMessage(user), <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">            this.handleClick</span></span><br><span class="line"><span class="xml">        &#125; &gt; Follow <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€å¯ä»¥é€šè¿‡ä½¿ç”¨é—­åŒ…æŠŠè¿™ä¸ªé—®é¢˜è§£å†³: åœ¨ render é‡Œé¢å®šä¹‰ä¸€ä¸ªå‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> props = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            alert(<span class="string">"Followed "</span> + props.user);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">            handleClick</span></span><br><span class="line"><span class="xml">        &#125; &gt; Follow <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ react ä¸­ï¼Œprops å’Œ state æ˜¯ä¸å¯ä»¥å˜çš„ï¼Œå˜åŒ–çš„æ˜¯ this</p>
<p>å¦ä¸€ä¸ªä¾‹å­ã€‚alert å‡ºæ¥çš„æ˜¯ï¼Œå½“ç‚¹å‡» send çš„æ—¶å€™è¾“å…¥æ¡†çš„å€¼ã€‚è€Œä¸æ˜¯ 3 ç§’ä¹‹åè¾“å…¥æ¡†çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MessageThread</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [message, setMessage] = useState(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">"You said: "</span> + message);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleSendClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleMessageChange = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        setMessage(e.target.value);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        &gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        input value = &#123;</span></span><br><span class="line"><span class="xml">            message</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        onChange = &#123;</span></span><br><span class="line"><span class="xml">            handleMessageChange</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        /&gt; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        button onClick = &#123;</span></span><br><span class="line"><span class="xml">            handleSendClick</span></span><br><span class="line"><span class="xml">        &#125; &gt; Send <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span> <span class="xml"><span class="tag">&lt; / &gt;</span></span></span><br><span class="line"><span class="xml">    );</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¯»å–æœ€æ–°çš„ props æˆ– state å€¼æ€ä¹ˆåŠå‘¢ï¼Ÿç”¨ä¸Šè¿°çš„ class æ–¹æ³•ã€‚<br>åœ¨ function å‡½æ•°ä¸­ï¼Œç”¨ ref</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MessageThread</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [message, setMessage] = useState(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">const</span> latestMessage = useRef(<span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">'You said: '</span> + latestMessage.current);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleSendClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleMessageChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        setMessage(e.target.value);</span><br><span class="line">        latestMessage.current = e.target.value;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>æ‰‹åŠ¨æ›´æ–° ref æ˜¯ç‰¹åˆ«çƒ¦çš„ï¼Œå¯ä»¥ç”¨ useEffect æ¥æ›´æ–°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MessageThread</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [message, setMessage] = useState(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">const</span> latestMessage = useRef(<span class="string">''</span>);</span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        latestMessage.current = message;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        alert(<span class="string">'You said: '</span> + latestMessage.current);</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>ä»Šå¤©åœ¨ every çš„é—®é¢˜ä¸Šçº ç»“äº†ä¸€æ®µæ—¶é—´ï¼Œåæ¥å‘ç°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isBigEnough</span>(<span class="params">element, index, array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> element &gt;= <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="number">12</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">130</span>, <span class="number">44</span>].every(isBigEnough); <span class="comment">// false</span></span><br><span class="line">[<span class="number">12</span>, <span class="number">54</span>, <span class="number">18</span>, <span class="number">130</span>, <span class="number">44</span>].every(isBigEnough); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// è¿™é‡Œçš„å‡½æ•°ä¸€å®šè¦åŠ returnï¼Œä¸ç„¶å¾—åˆ°çš„ç»“æœæ˜¯é”™è¯¯çš„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// someï¼Œfilterï¼Œmapï¼Œéƒ½è¦åŠ </span></span><br></pre></td></tr></table></figure>

<p>React çš„ setState</p>
<p>setState è¢«è°ƒç”¨ä¹‹åï¼Œæ›´æ–°ç»„ä»¶çš„è¿‡ç¨‹ï¼š</p>
<ul>
<li><p>enqueueState(this, partialState)</p>
<p>1ã€ è·å–å½“å‰ç»„ä»¶çš„ instance<br>2ã€ å°†è¦æ›´æ–°çš„ state æ”¾è¿›ä¸€ä¸ªæ•°ç»„_pendingStateQueue é‡Œ<br>3ã€ å°† instance ç»™ enqueueUpdate å¤„ç†</p>
</li>
<li><p>enqueueUpdate â€”-&gt; æ˜¯å¦å¤„äºåˆ›å»º/æ›´æ–°é˜¶æ®µ</p>
<p>1ã€ æ˜¯ â€”â€“&gt; åªæ˜¯å°†å½“å‰ç»„ä»¶æ”¾åœ¨ dirtyComponent ä¸­<br>2ã€ å¦ è°ƒç”¨ bachingUpdates</p>
</li>
</ul>
<p>nodejs è¿”å›çŠ¶æ€ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">router.get(<span class="string">"/test"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.setHeader(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>);</span><br><span class="line">    res.status(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>React Refs</p>
<ul>
<li>å­—ç¬¦ä¸²æ¨¡å¼</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props, context)</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="keyword">this</span>.refs.inputEl.focus()</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span> = <span class="string">"inputEl"</span> / &gt;</span></span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å›è°ƒå‡½æ•°æ¨¡å¼</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props, context) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props, context)</span><br><span class="line">    &#125;</span><br><span class="line">    _ref = <span class="function"><span class="params">el</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (el) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">this</span>.els) &#123;</span><br><span class="line">                <span class="keyword">this</span>.els = []</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.els.push(el)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.els = []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            list</span><br><span class="line">        &#125; = <span class="keyword">this</span>.props</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            ul &gt; &#123;</span></span><br><span class="line"><span class="xml">                list.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="xml">                    return ( <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                        li ref = &#123;</span></span><br><span class="line"><span class="xml">                            this._ref</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                        key = &#123;</span></span><br><span class="line"><span class="xml">                            index</span></span><br><span class="line"><span class="xml">                        &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                            item</span></span><br><span class="line"><span class="xml">                        &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                        /li&gt;</span></span><br><span class="line">                    )</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125; &lt;</span><br><span class="line">            /ul&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        value: <span class="string">""</span>,</span><br><span class="line">        list: []</span><br><span class="line">    &#125;</span><br><span class="line">    onchange = (&#123;</span><br><span class="line">        target: &#123;</span><br><span class="line">            value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;) =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    add = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            list,</span><br><span class="line">            value</span><br><span class="line">        &#125; = <span class="keyword">this</span>.state</span><br><span class="line">        list.push(value)</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value: <span class="string">''</span>,</span><br><span class="line">            list</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            value,</span><br><span class="line">            list</span><br><span class="line">        &#125; = <span class="keyword">this</span>.state</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            div className = "App" &gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            input value = &#123;</span></span><br><span class="line"><span class="xml">                value</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            onchange = &#123;</span></span><br><span class="line"><span class="xml">                this.onchange</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button onClick = &#123;</span></span><br><span class="line"><span class="xml">                this.add</span></span><br><span class="line"><span class="xml">            &#125; &gt; add <span class="tag">&lt; /<span class="attr">button</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            List list = &#123;</span></span><br><span class="line"><span class="xml">                list</span></span><br><span class="line"><span class="xml">            &#125; &gt; <span class="tag">&lt; /<span class="attr">List</span>&gt;</span></span> <span class="xml"><span class="tag">&lt; /</span></span></span><br><span class="line"><span class="xml">            div &gt;</span></span><br><span class="line"><span class="xml">        )</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="reactæ¸²æŸ“åŸç†"><a href="#reactæ¸²æŸ“åŸç†" class="headerlink" title="reactæ¸²æŸ“åŸç†"></a>reactæ¸²æŸ“åŸç†</h3><h3 id="æ¸²æŸ“åŠ«æŒï¼ˆRender-Hijackingï¼‰"><a href="#æ¸²æŸ“åŠ«æŒï¼ˆRender-Hijackingï¼‰" class="headerlink" title="æ¸²æŸ“åŠ«æŒï¼ˆRender Hijackingï¼‰"></a>æ¸²æŸ“åŠ«æŒï¼ˆRender Hijackingï¼‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é«˜é˜¶ç»„ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enhancer</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">EnhancedComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;</span></span></span><br><span class="line"><span class="xml">                ...this.props</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enhancer</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">EnhancedComponent</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">const</span> elementsTree = <span class="keyword">super</span>.render();</span><br><span class="line">            ...</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é«˜é˜¶ç»„ä»¶-HOC"><a href="#é«˜é˜¶ç»„ä»¶-HOC" class="headerlink" title="é«˜é˜¶ç»„ä»¶ HOC"></a>é«˜é˜¶ç»„ä»¶ HOC</h4><p>å®ç°é«˜é˜¶ç»„ä»¶çš„æ–¹å¼ï¼š</p>
<ul>
<li>å±æ€§ä»£ç†</li>
<li>åå‘ç»§æ‰¿</li>
</ul>
<p><strong>å±æ€§ä»£ç†</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    Component</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'React'</span>;</span><br><span class="line"><span class="comment">//é«˜é˜¶ç»„ä»¶å®šä¹‰</span></span><br><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">WrapperComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;</span></span></span><br><span class="line"><span class="xml">                ...this.props</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">//æ™®é€šçš„ç»„ä»¶</span></span><br><span class="line"><span class="xml">class WrappedComponent extends Component &#123;</span></span><br><span class="line"><span class="xml">    render() &#123;</span></span><br><span class="line"><span class="xml">        //....</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">//é«˜é˜¶ç»„ä»¶ä½¿ç”¨</span></span><br><span class="line"><span class="xml">export default HOC(WrappedComponent)</span></span><br></pre></td></tr></table></figure>

<p><strong>å±æ€§ä»£ç†ä½œç”¨</strong></p>
<ul>
<li>æ“ä½œprops</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">WrapperComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">const</span> newProps = &#123;</span><br><span class="line">                name: <span class="string">'HOC'</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;</span></span></span><br><span class="line"><span class="xml">                ...this.props</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è·å¾—refsçš„å¼•ç”¨</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    Component</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'React'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">wrapperComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">        storeRef(ref) &#123;</span><br><span class="line">            <span class="keyword">this</span>.ref = ref;</span><br><span class="line">        &#125;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;</span></span></span><br><span class="line"><span class="xml">                ...this.props</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            ref = &#123;</span></span><br><span class="line"><span class="xml">                this.storeRef</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;;</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æŠ½è±¡state</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WrappedComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span> = <span class="string">"name"</span> &#123;</span></span></span><br><span class="line"><span class="xml">            ...this.props.name</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        /&gt;;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">const HOC = (WrappedComponent) =&gt;</span></span><br><span class="line"><span class="xml">    class extends Component &#123;</span></span><br><span class="line"><span class="xml">        constructor(props) &#123;</span></span><br><span class="line"><span class="xml">            super(props);</span></span><br><span class="line"><span class="xml">            this.state = &#123;</span></span><br><span class="line"><span class="xml">                name: '',</span></span><br><span class="line"><span class="xml">            &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            this.onNameChange = this.onNameChange.bind(this);</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        onNameChange(event) &#123;</span></span><br><span class="line"><span class="xml">            this.setState(&#123;</span></span><br><span class="line"><span class="xml">                name: event.target.value,</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">        render() &#123;</span></span><br><span class="line"><span class="xml">            const newProps = &#123;</span></span><br><span class="line"><span class="xml">                value: this.state.name,</span></span><br><span class="line"><span class="xml">                onChange: this.onNameChange</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line">            return &lt;WrappedComponent &#123;</span><br><span class="line">                ...this.props</span><br><span class="line">            &#125; &#123;</span><br><span class="line">                ...newProps</span><br><span class="line">            &#125;</span><br><span class="line">            /&gt;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>åå‘ç»§æ‰¿</strong></p>
<blockquote>
<p>åå‘ç»§æ‰¿æ˜¯æŒ‡è¿”å›çš„ç»„ä»¶å»ç»§æ‰¿ä¹‹å‰çš„ç»„ä»¶(è¿™é‡Œéƒ½ç”¨WrappedComponentä»£æŒ‡)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.render();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ¸²æŸ“åŠ«æŒ</li>
</ul>
<p>æ¸²æŸ“åŠ«æŒæ˜¯æŒ‡æˆ‘ä»¬å¯ä»¥æœ‰æ„è¯†åœ°æ§åˆ¶WrappedComponentçš„æ¸²æŸ“è¿‡ç¨‹ï¼Œä»è€Œæ§åˆ¶æ¸²æŸ“æ§åˆ¶çš„ç»“æœã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éƒ¨åˆ†å‚æ•°å»å†³å®šæ˜¯å¦æ¸²æŸ“ç»„ä»¶:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.props.isRender) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">super</span>.render();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>  ç”šè‡³æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¿®æ”¹renderçš„ç»“æœ:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> HOC = <span class="function">(<span class="params">WrappedComponent</span>) =&gt;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">        render() &#123;</span><br><span class="line">            <span class="keyword">const</span> elementsTree = <span class="keyword">super</span>.render();</span><br><span class="line">            <span class="keyword">let</span> newProps = &#123;&#125;;</span><br><span class="line">            <span class="keyword">if</span> (elementsTree &amp;&amp; elementsTree.type === <span class="string">'input'</span>) &#123;</span><br><span class="line">                newProps = &#123;</span><br><span class="line">                    value: <span class="string">'may the force be with you'</span></span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">const</span> props = <span class="built_in">Object</span>.assign(&#123;&#125;, elementsTree.props, newProps);</span><br><span class="line">            <span class="keyword">const</span> newElementsTree = React.cloneElement(elementsTree, props, elementsTree.props.children);</span><br><span class="line">            <span class="keyword">return</span> newElementsTree;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WrappedComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            input value = &#123;</span></span><br><span class="line"><span class="xml">                'Hello World'</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;</span></span><br><span class="line"><span class="xml">        )</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">export default HOC(WrappedComponent)</span></span><br><span class="line"><span class="xml">//å®é™…æ˜¾ç¤ºçš„æ•ˆæœæ˜¯inputçš„å€¼ä¸º"may the force be with you"</span></span><br></pre></td></tr></table></figure>

<h3 id="render-æ–¹æ³•åŸç†"><a href="#render-æ–¹æ³•åŸç†" class="headerlink" title="render æ–¹æ³•åŸç†"></a>render æ–¹æ³•åŸç†</h3><p>useEffect ç¬¬äºŒä¸ªå‚æ•°çš„æ¯”è¾ƒè§„åˆ™æ˜¯ Object.is</p>
<p>å¦‚æœ props æ”¹å˜ï¼Œ props çš„å˜é‡æ˜¯ æ”¹å˜çš„å€¼ å’Œ åº”ç”¨å—ï¼ŸReactä¸­çš„å€¼æ˜¯æ€ä¹ˆå­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Ÿï¼Ÿï¼Ÿï¼Ÿâ“â“â“</p>
<p>Hooksè§„åˆ™</p>
<ul>
<li>ä»…é¡¶å±‚ä½¿ç”¨ hooks</li>
</ul>
<p>ä¸è¦åœ¨å¾ªç¯è¯­å¥ï¼Œæ¡ä»¶è¯­å¥ï¼ŒåµŒå¥—å‡½æ•°ä¸­ä½¿ç”¨ hooksã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ¯æ¬¡ç»„ä»¶æ¸²æŸ“çš„æ—¶å€™ï¼Œhooksä»¥ç›¸åŒçš„æ¬¡åºè¢«è°ƒç”¨ã€‚è¿™å°±ä½¿å¾— react å¯ä»¥åœ¨å¤šæ¬¡ useState å’Œ useEffect çš„è°ƒç”¨ä¸­ä¿å­˜çŠ¶æ€ã€‚</p>
<p>React<br>é«˜é˜¶ç»„ä»¶ï¼šç»™ä¸€ä¸ªç»„ä»¶æ³¨å…¥å‚æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withTimer</span>(<span class="params">Wrappedcomponent</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">        <span class="comment">//è·å–å½“å‰æ—¶é—´</span></span><br><span class="line">        render()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Wrappedcomponent</span> <span class="attr">time</span>=<span class="string">&#123;time&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ä½œä¸ºå­ç»„ä»¶ï¼Œåˆ©ç”¨å¥½ &lt;&gt;&lt;/&gt; è¿™ç§å½¢å¼ï¼Œç»„ä»¶å¦‚ä½•renderå¥¹çš„å†…å®¹ï¼Œæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†å¯ä»¥ç”±ä½¿ç”¨å®ƒçš„äººå†³å®šã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &#123;<span class="keyword">this</span>.props.children(<span class="string">'not'</span>)&#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;MyComponent&gt;</span><br><span class="line">&#123;(name)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/MyComponent&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="ç”Ÿå‘½å‘¨æœŸ-http-projects-wojtekmaj-pl-react-lifecycle-methods-diagram"><a href="#ç”Ÿå‘½å‘¨æœŸ-http-projects-wojtekmaj-pl-react-lifecycle-methods-diagram" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ[http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/]"></a>ç”Ÿå‘½å‘¨æœŸ[<a href="http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/]" target="_blank" rel="noopener">http://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/]</a></h3><p>ä¸‰ä¸ªé˜¶æ®µ</p>
<ul>
<li>render<br>ä¸»è¦ç”¨äºè®¡ç®—å½“å‰çš„çŠ¶æ€</li>
<li>pre-commit<br>è¿˜æ²¡æœ‰æ›´æ–°domï¼Œå½“æ—¶å¯ä»¥è¯»å–domçš„å†…å®¹</li>
<li>commit<br>æŠŠå®é™…çš„çŠ¶æ€éƒ½æ›´æ–°åˆ°domä¸Š</li>
</ul>
<h4 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h4><ul>
<li>ç”¨äºåˆå§‹åŒ–å†…éƒ¨çŠ¶æ€ï¼Œå¾ˆå°‘ä½¿ç”¨</li>
<li>å”¯ä¸€å¯ä»¥ç›´æ¥ä¿®æ”¹stateçš„åœ°æ–¹</li>
</ul>
<h4 id="getDerivedStateFromProps"><a href="#getDerivedStateFromProps" class="headerlink" title="getDerivedStateFromProps"></a>getDerivedStateFromProps</h4><p>ç”¨å¤–éƒ¨çš„å±æ€§å»åˆå§‹åŒ–å†…éƒ¨çš„çŠ¶æ€</p>
<p>Redux ä¸­é—´ä»¶</p>
<ol>
<li>æˆªè·action</li>
<li>å‘å‡ºaction</li>
</ol>
<p>immutable data ä¸å¯å˜æ•°æ®</p>
<p>ä¸ºä½•éœ€è¦ä¸å¯å˜æ•°æ®</p>
<ol>
<li>æ€§èƒ½ä¼˜åŒ–</li>
<li>å·²ä¸è°ƒè¯•å’Œè·Ÿè¸ª</li>
<li>æ˜“äºæ¨æµ‹</li>
</ol>
<p>å¦‚ä½•æ“ä½œä¸å¯å˜æ•°æ®</p>
<ol>
<li>åŸç”Ÿå†™æ³•{â€¦},Object.assign</li>
<li>immutability-helper</li>
<li>immer</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> state=&#123;<span class="attr">filter</span>:<span class="string">'completed'</span>,<span class="attr">todos</span>:[<span class="string">'Learn React'</span>]&#125;</span><br><span class="line"><span class="keyword">const</span> newState=&#123;...state,<span class="attr">todos</span>:[...state.todos,<span class="string">'Learn Redux'</span>]&#125;</span><br><span class="line"><span class="keyword">const</span> newState2 = <span class="built_in">Object</span>.assign(&#123;&#125;,state,&#123;<span class="attr">todos</span>:[</span><br><span class="line">        ...state.todos,</span><br><span class="line">        <span class="string">'Learn Redux'</span></span><br><span class="line">    ]&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>React</tag>
      </tags>
  </entry>
  <entry>
    <title>react</title>
    <url>/2020/03/21/react/</url>
    <content><![CDATA[const state={filter:'completed',todos:['Learn React']}
const newState={...state,todos:[...state.todos,'Learn Redux']}
const newState2 = Object.assign({},state,{todos:[
        ...state.todos,
        'Learn Redux'
    ]})]]></content>
  </entry>
  <entry>
    <title>Webpack</title>
    <url>/2019/12/29/Webpack/</url>
    <content><![CDATA[<p><a href="https://github.com/ruanyf/webpack-demos" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>
<p>webpack-dev-serveræä¾›äº†ä¸€ä¸ªç®€å•çš„WebæœåŠ¡å™¨å’Œå®æ—¶çƒ­æ›´æ–°çš„èƒ½åŠ›</p>
<p>webpack-dev-server â€“open å‘Šè¯‰ dev-server åœ¨ server å¯åŠ¨åæ‰“å¼€æµè§ˆå™¨ã€‚é»˜è®¤ç¦ç”¨ã€‚</p>
<p>webpack-dev-server å¼€å‘æ¨¡å¼ä½¿ç”¨ï¼Œæ‰“åŒ…çš„å†…å®¹åœ¨å†…å­˜ä¸­å­˜åœ¨ï¼Œä¸ç”Ÿæˆæ–‡ä»¶ã€‚</p>
<p>webpack -p æ‰“åŒ…ç”Ÿæˆé™æ€æ–‡ä»¶</p>
<a id="more"></a>

<p>webpack â€“mode production æ‰“åŒ…å‘½ä»¤</p>
<p>webpack-dev-server é…ç½®</p>
<p>devServer: {<br>        contentBase: â€˜./distâ€™,<br>        port: â€˜8080â€™,<br>        host: â€˜localhostâ€™<br>    }</p>
<h3 id="æ‰“åŒ…-jsx-æ–‡ä»¶"><a href="#æ‰“åŒ…-jsx-æ–‡ä»¶" class="headerlink" title="æ‰“åŒ… jsx æ–‡ä»¶"></a>æ‰“åŒ… jsx æ–‡ä»¶</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            presets: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰“åŒ…-css-æ–‡ä»¶"><a href="#æ‰“åŒ…-css-æ–‡ä»¶" class="headerlink" title="æ‰“åŒ… css æ–‡ä»¶"></a>æ‰“åŒ… css æ–‡ä»¶</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [ <span class="string">'style-loader'</span>, <span class="string">'css-loader'</span> ]</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰“åŒ…å›¾ç‰‡"><a href="#æ‰“åŒ…å›¾ç‰‡" class="headerlink" title="æ‰“åŒ…å›¾ç‰‡"></a>æ‰“åŒ…å›¾ç‰‡</h3><p>ä¼šå°†å¤§å›¾ç‰‡ç”Ÿæˆä¸€ä¸ª base64 æ ¼å¼çš„ æ–‡ä»¶ï¼Œå°å›¾ç‰‡åˆ™æ”¾åœ¨ bundle.js æ–‡ä»¶ä¸­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              limit: <span class="number">8192</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js[x]?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            presets: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'style-loader'</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">             loader: <span class="string">'css-loader'</span>,</span><br><span class="line">             options: &#123;</span><br><span class="line">               modules: <span class="literal">true</span></span><br><span class="line">             &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>css-loader?modules çš„ä½œç”¨ â“</p>
<h3 id="webpack-æ’ä»¶ç³»ç»Ÿ"><a href="#webpack-æ’ä»¶ç³»ç»Ÿ" class="headerlink" title="webpack æ’ä»¶ç³»ç»Ÿ"></a>webpack æ’ä»¶ç³»ç»Ÿ</h3><p>uglifyjs-webpack-plugin å‹ç¼© JS</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> UglifyJsPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>html-webpack-plugin åˆ›å»º index.html, open-browser-webpack-plugin åœ¨webpackæ‰“åŒ…å®Œæˆåï¼Œè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</p>
<h3 id="åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒä»£ç "><a href="#åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒä»£ç " class="headerlink" title="åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒä»£ç "></a>åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒä»£ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> devFlagPlugin = <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">  __DEV__: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.DEBUG || <span class="string">'false'</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./main.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [devFlagPlugin]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ç¯å¢ƒ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;dev&quot;: &quot;npx cross-env DEBUG&#x3D;true webpack-dev-server --open&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;npx cross-env DEBUG&#x3D;false webpack&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>


<h3 id="ä»£ç åˆ†å‰²"><a href="#ä»£ç åˆ†å‰²" class="headerlink" title="ä»£ç åˆ†å‰²"></a>ä»£ç åˆ†å‰²</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>.ensure([<span class="string">'./a'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">require</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> content = <span class="built_in">require</span>(<span class="string">'./a'</span>);</span><br><span class="line">  <span class="built_in">document</span>.open();</span><br><span class="line">  <span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;'</span> + content + <span class="string">'&lt;/h1&gt;'</span>);</span><br><span class="line">  <span class="built_in">document</span>.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>require.ensure å‘Šè¯‰ Webpack ./a.js åº”è¯¥ä» bundle.js ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„ bundle.jsã€‚ äºæ˜¯å°±ç”Ÿæˆäº†ä¸€ä¸ª 1.bundle.js.<br>ä½†æ˜¯ä½¿ç”¨çš„æ—¶å€™å¹¶ä¸éœ€è¦å•ç‹¬å¼•ç”¨ 1.bundle.jsï¼Œ ä»–åªæ˜¯ webpack å¸®å¿™åšçš„æ“ä½œ</p>
<h3 id="ä½¿ç”¨-bundle-loader-å®ç°ä»£ç åˆ†å‰²"><a href="#ä½¿ç”¨-bundle-loader-å®ç°ä»£ç åˆ†å‰²" class="headerlink" title="ä½¿ç”¨ bundle-loader å®ç°ä»£ç åˆ†å‰²"></a>ä½¿ç”¨ bundle-loader å®ç°ä»£ç åˆ†å‰²</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> load = <span class="built_in">require</span>(<span class="string">'bundle-loader!./a.js'</span>);</span><br><span class="line"></span><br><span class="line">load(<span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.open();</span><br><span class="line">  <span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;'</span> + file + <span class="string">'&lt;/h1&gt;'</span>);</span><br><span class="line">  <span class="built_in">document</span>.close();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="æå–å…¬å…±åŒ…"><a href="#æå–å…¬å…±åŒ…" class="headerlink" title="æå–å…¬å…±åŒ…"></a>æå–å…¬å…±åŒ…</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">"commons"</span>,</span><br><span class="line"></span><br><span class="line">      filename: <span class="string">"commons.js"</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure>

<p>æŠŠ jQuery æ‰“åŒ…åˆ° vendor ä¸­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">'./main.js'</span>,</span><br><span class="line">    vendor: [<span class="string">'jquery'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'vendor'</span>,</span><br><span class="line">      filename: <span class="string">'vendor.js'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è®©ä¸€ä¸ªå˜é‡å…¨å±€å¯ç”¨ï¼Œè€Œä¸ç”¨åˆ°å¤„ import<br>æ–¹æ³•ä¸€</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">'./main.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">      $: <span class="string">'jquery'</span>,</span><br><span class="line">      jQuery: <span class="string">'jquery'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒ<br>å¤–å±‚æœ‰ data.js æ–‡ä»¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// data.js</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="string">'Hello World'</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.jsx</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">require</span>(<span class="string">'data'</span>);</span><br><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</span><br><span class="line"><span class="keyword">var</span> ReactDOM = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;h1&gt;&#123;data&#125;&lt;<span class="regexp">/h1&gt;,</span></span><br><span class="line"><span class="regexp">  document.body</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./main.jsx'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js[x]?$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            presets: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  externals: &#123;</span><br><span class="line">    <span class="comment">// require('data') is external and available</span></span><br><span class="line">    <span class="comment">//  on the global var data</span></span><br><span class="line">    <span class="string">'data'</span>: <span class="string">'data'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h3 id="publicPath-ä¸Šçº¿æ—¶é…ç½®çš„æ˜¯cdnçš„åœ°å€"><a href="#publicPath-ä¸Šçº¿æ—¶é…ç½®çš„æ˜¯cdnçš„åœ°å€" class="headerlink" title="publicPath ä¸Šçº¿æ—¶é…ç½®çš„æ˜¯cdnçš„åœ°å€"></a>publicPath ä¸Šçº¿æ—¶é…ç½®çš„æ˜¯cdnçš„åœ°å€</h3><p>ä¸ºä»€ä¹ˆéœ€è¦æ‰“åŒ…</p>
<ul>
<li>ç¼–è¯‘ES6è¯­æ³•ç‰¹æ€§ï¼Œç¼–è¯‘jsx</li>
<li>æ•´åˆèµ„æºï¼Œä¾‹å¦‚å›¾ç‰‡ï¼ŒLess/Sass</li>
<li>ä¼˜åŒ–ä»£ç ä½“ç§¯</li>
</ul>
]]></content>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½è¿ç®—</title>
    <url>/2020/02/22/%E4%BD%8D%E8%BF%90%E7%AE%97/</url>
    <content><![CDATA[<h3 id="ä¸ç”¨é¢å¤–å˜é‡äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼"><a href="#ä¸ç”¨é¢å¤–å˜é‡äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼" class="headerlink" title="ä¸ç”¨é¢å¤–å˜é‡äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼"></a>ä¸ç”¨é¢å¤–å˜é‡äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">a = a ^ b</span><br><span class="line">b = a ^ b</span><br><span class="line">a = a ^ b</span><br></pre></td></tr></table></figure>
<a id="more"></a>

<h3 id="ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°ï¼ˆ32ä½æ•´æ•°ï¼‰"><a href="#ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°ï¼ˆ32ä½æ•´æ•°ï¼‰" class="headerlink" title="ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°ï¼ˆ32ä½æ•´æ•°ï¼‰"></a>ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°ï¼ˆ32ä½æ•´æ•°ï¼‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flip</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n ^ <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sign</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> flip((number &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBigger</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> c = a - b</span><br><span class="line">  <span class="keyword">const</span> signC = sign(c)</span><br><span class="line">  <span class="keyword">const</span> flipC = flip(signC)</span><br><span class="line">  <span class="keyword">return</span> a * signC + b * flipC</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°"><a href="#ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°" class="headerlink" title="ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°"></a>ä¸ç”¨æ¯”è¾ƒæ‰¾åˆ°ä¸¤æ•°ä¸­è¾ƒå¤§çš„æ•°</h3><p>ğŸ‘‡å¦‚æœaçš„ç¬¦å·å’Œbçš„ç¬¦å·ä¸åŒï¼Œ(difSignAB=1,sameSignAB=0)</p>
<ul>
<li>å¦‚æœaä¸ºæ­£ï¼Œbä¸ºè´Ÿ(signA=1,signB=0)ï¼Œè¿”å›a</li>
<li>å¦‚æœaä¸ºè´Ÿï¼Œbä¸ºæ­£(signA=0,signB=1)ï¼Œè¿”å›b<br>ğŸ‘‡å¦‚æœaçš„ç¬¦å·å’Œbçš„ç¬¦å·ç›¸åŒï¼Œ(difSignAB=0,sameSignAB=1)</li>
<li>å¦‚æœa-bä¸ºæ­£ï¼ŒsignC=1ï¼Œè¿”å›a</li>
<li>å¦‚æœa-bä¸ºè´Ÿï¼ŒsignC=0ï¼Œè¿”å›b<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flip</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n ^ <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sign</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> flip((number &gt;&gt; <span class="number">1</span>) &amp; <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getBigger</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> c = a - b</span><br><span class="line">  <span class="keyword">const</span> signA = sign(a)</span><br><span class="line">  <span class="keyword">const</span> signB = sign(b)</span><br><span class="line">  <span class="keyword">const</span> signC = sign(c)</span><br><span class="line">  <span class="keyword">const</span> difSignAB = signA ^ signB</span><br><span class="line">  <span class="keyword">const</span> sameSignAB = flip(difSignAB)</span><br><span class="line">  <span class="keyword">const</span> returnA = difSignAB * signA + sameSignAB * signC</span><br><span class="line">  <span class="keyword">const</span> returnB = flip(returnA)</span><br><span class="line">  <span class="keyword">return</span> a * returnA + b * returnB</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="ä½è¿ç®—ç¬¦å®ç°åŠ å‡ä¹˜é™¤"><a href="#ä½è¿ç®—ç¬¦å®ç°åŠ å‡ä¹˜é™¤" class="headerlink" title="ä½è¿ç®—ç¬¦å®ç°åŠ å‡ä¹˜é™¤"></a>ä½è¿ç®—ç¬¦å®ç°åŠ å‡ä¹˜é™¤</h3><h4 id="åŠ "><a href="#åŠ " class="headerlink" title="åŠ "></a>åŠ </h4><ul>
<li>åœ¨å®Œå…¨ä¸è€ƒè™‘è¿›ä½çš„æƒ…å†µä¸‹ï¼Œa^bå°±æ˜¯æ­£ç¡®ç»“æœ</li>
<li>åœ¨åªç®—è¿›ä½çš„æƒ…å†µä¸‹ï¼Œè¿›ä½(a&amp;b)&lt;&lt;1</li>
<li>æŠŠå®Œå…¨ä¸è€ƒè™‘è¿›ä½çš„ç›¸åŠ å€¼ä¸åªè€ƒè™‘è¿›ä½çš„äº§ç”Ÿå€¼å†ç›¸åŠ ï¼Œå°±æ˜¯æœ€ç»ˆç»“æœ<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> sum = a</span><br><span class="line">  <span class="keyword">while</span> (b !== <span class="number">0</span>) &#123;</span><br><span class="line">    sum = a ^ b</span><br><span class="line">    b = (a &amp; b) &lt;&lt; <span class="number">1</span></span><br><span class="line">    a = sum</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="å‡"><a href="#å‡" class="headerlink" title="å‡"></a>å‡</h4><p>å®ç°a-båªè¦å®ç°a+(-b)å³å¯ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°çš„ç›¸åæ•°ï¼Œå°±æ˜¯è¿™ä¸ªæ•°çš„äºŒè¿›åˆ¶æ•°è¡¨è¾¾å–ååŠ ä¸€çš„ç»“æœã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">negNum</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> add(~n, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minus</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> add(a, negNum(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä¹˜"><a href="#ä¹˜" class="headerlink" title="ä¹˜"></a>ä¹˜</h4><p>a * b = a * 2^0 * b0 + a * 2^1 * b1 + â€¦â€¦ + a * 2^i * bi + a * 2^31 * b31 </p>
<ul>
<li>bæœ€å³ä¾§ä¸º1æ—¶ï¼Œres = res + aï¼ŒåŒæ—¶bå³ç§»1ä½ï¼Œaå·¦ç§»ä¸€ä½</li>
<li>bæœ€å³ä¾§ä¸º0æ—¶ï¼Œresä¸å˜ï¼ŒåŒæ—¶bå³ç§»1ä½ï¼Œaå·¦ç§»ä¸€ä½<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multi</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (b !== <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">      res = add(res, a)</span><br><span class="line">    &#125;</span><br><span class="line">    a &lt;&lt;= <span class="number">1</span></span><br><span class="line">    b &gt;&gt;= <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="é™¤"><a href="#é™¤" class="headerlink" title="é™¤"></a>é™¤</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNeg</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n &lt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">div</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> x = isNeg(a) ? negNum(a) : a</span><br><span class="line">  <span class="keyword">let</span> y = isNeg(b) ? negNum(b) : b</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">31</span>; i &gt; <span class="number">-1</span>; i = minus(i, <span class="number">1</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((x &gt;&gt; i) &gt;= y) &#123;</span><br><span class="line">      res |= (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">      x = minus(x, y &lt;&lt; i)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> isNeg(a) ^ isNeg(b) ? negNum(res) : res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNeg</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n &lt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">div</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> x = isNeg(a) ? negNum(a) : a</span><br><span class="line">  <span class="keyword">let</span> y = isNeg(b) ? negNum(b) : b</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">31</span>; i &gt; <span class="number">-1</span>; i = minus(i, <span class="number">1</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((x &gt;&gt; i) &gt;= y) &#123;</span><br><span class="line">      res |= (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">      x = minus(x, y &lt;&lt; i)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> isNeg(a) ^ isNeg(b) ? negNum(res) : res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (b === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'divisor is 0'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (a === <span class="built_in">Number</span>.MAX_SAFE_INTEGER &amp;&amp; b === <span class="built_in">Number</span>.MIN_SAFE_INTEGER) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (b === <span class="built_in">Number</span>.MIN_SAFE_INTEGER) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a === <span class="built_in">Number</span>.MIN_SAFE_INTEGER) &#123;</span><br><span class="line">    <span class="keyword">let</span> res = div(add(a, <span class="number">1</span>), b)</span><br><span class="line">    <span class="keyword">return</span> add(res, div(minus(a, multi(res, b)), b))</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> div(a, b)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒè¿›åˆ¶è¡¨è¾¾å¼æœ‰å¤šå°‘1"><a href="#äºŒè¿›åˆ¶è¡¨è¾¾å¼æœ‰å¤šå°‘1" class="headerlink" title="äºŒè¿›åˆ¶è¡¨è¾¾å¼æœ‰å¤šå°‘1"></a>äºŒè¿›åˆ¶è¡¨è¾¾å¼æœ‰å¤šå°‘1</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count1</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (n !== <span class="number">0</span>) &#123;</span><br><span class="line">    res += n &amp; <span class="number">1</span></span><br><span class="line">    n &gt;&gt;= <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>n &amp;= (n - 1) æ“ä½œï¼Œæ˜¯æŠ¹æ‰æœ€å³è¾¹çš„1</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count2</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (n !== <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// æŠ¹æ‰æœ€å³è¾¹çš„1</span></span><br><span class="line">    n &amp;= (n - <span class="number">1</span>)</span><br><span class="line">    res++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res                              </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count3</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> (n !== <span class="number">0</span>) &#123;</span><br><span class="line">    n -= n &amp; (~n + <span class="number">1</span>)</span><br><span class="line">    res++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åœ¨å…¶ä»–æ•°éƒ½å‡ºç°å¶æ•°æ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°å‡ºç°å¥‡æ•°æ¬¡çš„æ•°"><a href="#åœ¨å…¶ä»–æ•°éƒ½å‡ºç°å¶æ•°æ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°å‡ºç°å¥‡æ•°æ¬¡çš„æ•°" class="headerlink" title="åœ¨å…¶ä»–æ•°éƒ½å‡ºç°å¶æ•°æ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°å‡ºç°å¥‡æ•°æ¬¡çš„æ•°"></a>åœ¨å…¶ä»–æ•°éƒ½å‡ºç°å¶æ•°æ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°å‡ºç°å¥‡æ•°æ¬¡çš„æ•°</h3><p>éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªæ•°å¼‚æˆ–ï¼Œæœ€åçš„å€¼å°±æ˜¯å‡ºç°å¥‡æ•°æ¬¡çš„é‚£ä¸ªæ•°ã€‚å¼‚æˆ–æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ã€‚åƒä¸ªç›¸åŒçš„æ•°å¼‚æˆ–ä¹‹åä¸º0</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oddTimesNum</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    res ^= arr[i]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="æœ‰ä¸¤ä¸ªæ•°å‡ºç°äº†å¥‡æ•°æ¬¡ï¼Œæ‰“å°è¿™ä¸¤ä¸ªæ•°"><a href="#æœ‰ä¸¤ä¸ªæ•°å‡ºç°äº†å¥‡æ•°æ¬¡ï¼Œæ‰“å°è¿™ä¸¤ä¸ªæ•°" class="headerlink" title="æœ‰ä¸¤ä¸ªæ•°å‡ºç°äº†å¥‡æ•°æ¬¡ï¼Œæ‰“å°è¿™ä¸¤ä¸ªæ•°"></a>æœ‰ä¸¤ä¸ªæ•°å‡ºç°äº†å¥‡æ•°æ¬¡ï¼Œæ‰“å°è¿™ä¸¤ä¸ªæ•°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printOddTimesNum</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> e0 = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> e0hasOne = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    e0 ^= arr[i]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> rightOne = e0 &amp; (~e0 + <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((arr[i] &amp; rightOne) !== <span class="number">0</span>) &#123;</span><br><span class="line">      e0hasOne ^= arr[i]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> annother = e0 ^ e0hasOne</span><br><span class="line">  <span class="keyword">return</span> &#123; annother, e0hasOne &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…¶ä»–æ•°å­—éƒ½å‡ºç°kæ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°"><a href="#å…¶ä»–æ•°å­—éƒ½å‡ºç°kæ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°" class="headerlink" title="å…¶ä»–æ•°å­—éƒ½å‡ºç°kæ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°"></a>å…¶ä»–æ•°å­—éƒ½å‡ºç°kæ¬¡çš„æ•°ç»„ä¸­æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°</h3><p>kè¿›åˆ¶çš„ä¸¤ä¸ªæ•°ï¼Œåœ¨iä½ä¸Šæ— è¿›ä½ç›¸åŠ çš„ç»“æœå°±æ˜¯(c(i)+d(i))%k,é‚£ä¹ˆå¦‚æœkä¸ªç›¸åŒçš„kè¿›åˆ¶æ•°è¿›è¡Œæ— è¿›ä½ç›¸åŠ ï¼Œç›¸åŠ çš„ç»“æœä¸€å®šæ˜¯æ¯ä¸€ä½ä¸Šéƒ½æ˜¯0çš„kè¿›åˆ¶æ•°</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>é—­åŒ…</title>
    <url>/2020/02/27/%E9%97%AD%E5%8C%85/</url>
    <content><![CDATA[<h3 id="ä½ ä¸çŸ¥é“çš„JS"><a href="#ä½ ä¸çŸ¥é“çš„JS" class="headerlink" title="ä½ ä¸çŸ¥é“çš„JS"></a>ä½ ä¸çŸ¥é“çš„JS</h3><blockquote>
<p>é—­åŒ…æ™¦æ¶©éš¾æ‡‚</p>
</blockquote>
<p>å‡½æ•°è®°ä½å¹¶è®¿é—®å…¶æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå«åšé—­åŒ…ç°è±¡ï¼Œè€Œæ­¤æ—¶å‡½æ•°å¯¹ä½œç”¨åŸŸçš„å¼•ç”¨å«åšé—­åŒ…ã€‚</p>
<a id="more"></a>

<p>bar è¿™ä¸ªå‡½æ•°åœ¨å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–çš„åœ°æ–¹è¢«è°ƒç”¨ã€‚é—­åŒ…ä½¿å¾—å‡½æ•°å¯ä»¥ç»§ç»­è®¿é—®å®šä¹‰æ—¶çš„<br>è¯æ³•ä½œç”¨åŸŸ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bar</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> baz = foo()</span><br><span class="line">baz()   <span class="comment">//è°ƒç”¨å¤„</span></span><br></pre></td></tr></table></figure>

<p>æ— è®ºä½¿ç”¨ä½•ç§æ–¹å¼å¯¹å‡½æ•°ç±»å‹çš„å€¼è¿›è¡Œä¼ é€’ï¼Œå½“å‡½æ•°åœ¨åˆ«å¤„è¢«è°ƒç”¨æ—¶éƒ½å¯ä»¥è§‚å¯Ÿåˆ° é—­åŒ…ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a)</span><br><span class="line">    &#125;</span><br><span class="line">    bar(baz)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    fn()  <span class="comment">//è°ƒç”¨å¤„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æ— è®ºé€šè¿‡ä½•ç§æ‰‹æ®µå°†å†…éƒ¨å‡½æ•°ä¼ é€’åˆ°æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–ï¼Œå®ƒéƒ½ä¼šæŒæœ‰å¯¹åŸå§‹å®šä¹‰ä½œç”¨ åŸŸçš„å¼•ç”¨ï¼Œæ— è®ºåœ¨ä½•å¤„æ‰§è¡Œè¿™ä¸ªå‡½æ•°éƒ½ä¼šä½¿ç”¨é—­åŒ…ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fn</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">2</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a)</span><br><span class="line">    &#125;</span><br><span class="line">    fn = baz</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    fn()</span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br><span class="line">bar()</span><br></pre></td></tr></table></figure>


<p>åœ¨å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ã€ Ajax è¯·æ±‚ã€è·¨çª—å£é€šä¿¡ã€Web Workers æˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥(æˆ–è€…åŒæ­¥)ä»»åŠ¡ä¸­ï¼Œåªè¦ä½¿ ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…!<br>â“â“â“ è¿™ä¸ªè¯¥æ€ä¹ˆç†è§£å‘¢</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wait</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(message)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">wait(<span class="string">"hello world"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(timer)</span><br></pre></td></tr></table></figure>

<p>IIFE ä¼šé€šè¿‡å£°æ˜å¹¶ç«‹å³æ‰§è¡Œä¸€ä¸ªå‡½æ•°æ¥åˆ›å»ºä½œç”¨åŸŸ</p>
<p>æ€è€ƒä»¥ä¸‹å‡ ç§æƒ…å†µ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i)</span><br><span class="line">    &#125;,i*<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 5 5 5 5</span></span><br></pre></td></tr></table></figure>


<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i)</span><br><span class="line">        &#125;,i*<span class="number">1000</span>)</span><br><span class="line">    &#125;)(i)</span><br><span class="line"><span class="comment">// 1 2 3 4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">     <span class="comment">// let j = i ç”¨æ¥åœ¨æ¯ä¸ªè¿­ä»£ä¸­å‚¨å­˜ i çš„å€¼</span></span><br><span class="line">     (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">let</span> j = i</span><br><span class="line">         setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">             <span class="built_in">console</span>.log(j)</span><br><span class="line">         &#125;,j*<span class="number">1000</span>)</span><br><span class="line">     &#125;)()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 2 3 4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">let</span> j = i</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(j)</span><br><span class="line">    &#125;,j*<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 2 3 4</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡å—æ¨¡å¼"><a href="#æ¨¡å—æ¨¡å¼" class="headerlink" title="æ¨¡å—æ¨¡å¼"></a>æ¨¡å—æ¨¡å¼</h3><p>foo å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—å®ä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> something = <span class="string">"cool"</span></span><br><span class="line">    <span class="keyword">var</span> annother = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dosomething</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(something)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">doAnnother</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(annother.join(<span class="string">' ! '</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        dosomething,</span><br><span class="line">        doAnnother</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> CoolModule = foo()</span><br><span class="line">CoolModule.dosomething()</span><br><span class="line">CoolModule.doAnnother()</span><br></pre></td></tr></table></figure>

<p>ç•¥å¾®æ”¹é€ åæ˜¯å•ä¾‹æ¨¡å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = (<span class="function"><span class="keyword">function</span> <span class="title">CoolModule</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> something = <span class="string">"cool"</span></span><br><span class="line">    <span class="keyword">var</span> annother = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dosomething</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(something)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">doAnnother</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(annother.join(<span class="string">' ! '</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        dosomething,</span><br><span class="line">        doAnnother</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">foo.dosomething()</span><br><span class="line">foo.doAnnother()</span><br></pre></td></tr></table></figure>


<h3 id="JavaScript-è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ"><a href="#JavaScript-è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ" class="headerlink" title="JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ"></a>JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ</h3><p>æ¯æ¬¡éƒ½æ˜¯å¼¹å‡º nodes.lengthï¼Œ åŸå› æ˜¯ onClick äº‹ä»¶æ˜¯å¼‚æ­¥è§¦å‘çš„ï¼Œfor å¾ªç¯æ—©å·²ç»ç»“æŸã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> nodes = <span class="built_in">document</span>.getElementsByTagName( <span class="string">'div'</span> );</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, len = nodes.length; i &lt; len; i++ )&#123;</span><br><span class="line">    nodes[ i ].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert ( i );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ³•æ˜¯ï¼Œåˆ©ç”¨é—­åŒ…ï¼Œå°†æ¯æ¬¡å¾ªç¯çš„ i å€¼éƒ½å°é—­èµ·æ¥</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, len = nodes.length; i &lt; len; i++ )&#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</span><br><span class="line">        nodes[ i ].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            alert(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="é—­åŒ…åº”ç”¨åœºæ™¯"><a href="#é—­åŒ…åº”ç”¨åœºæ™¯" class="headerlink" title="é—­åŒ…åº”ç”¨åœºæ™¯"></a>é—­åŒ…åº”ç”¨åœºæ™¯</h4><ul>
<li>img ä¸ŠæŠ¥æ•°æ®<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> report = <span class="function"><span class="keyword">function</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">    img.src=src</span><br><span class="line">&#125;</span><br><span class="line">report(<span class="string">""</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>ä½†æ˜¯ report ä¸æ˜¯æ¯æ¬¡éƒ½æˆåŠŸå‘èµ· HTTP è¯·æ±‚ã€‚<br>åŸå› æ˜¯ï¼Œimg åœ¨ report æ˜¯å±€éƒ¨å˜é‡ï¼Œå½“ report å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œ img å°±ä¼šè¢«å›æ”¶ã€‚è€Œæ­¤æ—¶æˆ–è®¸è¿˜æ²¡æ¥å¾—åŠå‘èµ· HTTP è¯·æ±‚</p>
<p>è§£å†³ï¼ŒæŠŠ img ç”¨é—­åŒ…åŒ…è£¹èµ·æ¥</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> report = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> imgs = []</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">        imgs.push(src)</span><br><span class="line">        img.src=src</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line">report(<span class="string">""</span>)</span><br></pre></td></tr></table></figure>

<h4 id="é—­åŒ…ä¸å†…å­˜ç®¡ç†"><a href="#é—­åŒ…ä¸å†…å­˜ç®¡ç†" class="headerlink" title="é—­åŒ…ä¸å†…å­˜ç®¡ç†"></a>é—­åŒ…ä¸å†…å­˜ç®¡ç†</h4><p>ä½¿ç”¨é—­åŒ…çš„åŒæ—¶å®¹æ˜“å½¢æˆå¾ªç¯åº”ç”¨ã€‚<br>åœ¨åŸºäºå¼•ç”¨è®¡æ•°çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸­ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆäº†å¾ªç¯å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æ²¡åŠæ³•è¢«å›æ”¶ã€‚</p>
<p>å¾ªç¯å¼•ç”¨å®ä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignHandler</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> element = <span class="built_in">document</span>.querySelector(<span class="string">"#element"</span>)</span><br><span class="line">     element.onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(element.id)</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


<h4 id="æ‰€æœ‰å›è°ƒå‡½æ•°éƒ½æ˜¯é—­åŒ…çš„ç†è§£"><a href="#æ‰€æœ‰å›è°ƒå‡½æ•°éƒ½æ˜¯é—­åŒ…çš„ç†è§£" class="headerlink" title="æ‰€æœ‰å›è°ƒå‡½æ•°éƒ½æ˜¯é—­åŒ…çš„ç†è§£"></a>æ‰€æœ‰å›è°ƒå‡½æ•°éƒ½æ˜¯é—­åŒ…çš„ç†è§£</h4><blockquote>
<p>å›è°ƒå‡½æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°†ä¼šåœ¨å¦ä¸€ä¸ªå‡½æ•°å®Œæˆæ‰§è¡Œåç«‹å³æ‰§è¡Œã€‚å›è°ƒå‡½æ•°æ˜¯ä¸€ä¸ªä½œä¸ºå‚æ•°ä¼ ç»™å¦ä¸€ä¸ª JavaScript å‡½æ•°çš„å‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°ä¼šåœ¨ä¼ ç»™çš„å‡½æ•°å†…éƒ¨æ‰§è¡Œ</p>
</blockquote>
<p>æ— è®ºé€šè¿‡ä½•ç§æ‰‹æ®µå°†å†…éƒ¨å‡½æ•°ä¼ é€’åˆ°å…¶æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸå¤–ï¼Œå®ƒéƒ½ä¼šæŒæœ‰å¯¹åŸå§‹å®šä¹‰ä½œç”¨åŸŸçš„å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºåœ¨ä»€ä¹ˆåœ°æ–¹æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œéƒ½ä¼šä½¿ç”¨é—­åŒ…ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fn;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log( a );</span><br><span class="line">    &#125;</span><br><span class="line">    fn = baz; <span class="comment">//å°†baz åˆ†é…ç»™å…¨å±€å˜é‡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    fn();</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line">bar(); <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>Server Side Rendering</title>
    <url>/2019/12/29/Server-Side-Rendering/</url>
    <content><![CDATA[<h3 id="å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“"><a href="#å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“"></a>å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“</h3><p>åœ¨å‰åç«¯æ¸²æŸ“ç›¸åŒçš„componentï¼Œå°†è¾“å‡ºä¸€è‡´çš„domç»“æ„ã€‚å®Œå–„çš„componentå±æ€§åŠç”Ÿå‘½å‘¨æœŸä¸å®¢æˆ·ç«¯çš„renderæ—¶æœºæ˜¯reactåŒæ„çš„å…³é”®<br>reactçš„è™šæ‹Ÿdomä»¥å¯¹è±¡æ ‘çš„å½¢å¼ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”æ˜¯å¯ä»¥åœ¨ä»»ä½•æ”¯æŒJavaScriptçš„ç¯å¢ƒä¸­ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æµè§ˆå™¨å’Œnodeä¸­ç”Ÿæˆã€‚è¿™ä¸ºå‰åç«¯åŒæ„æä¾›äº†å…ˆå†³æ¡ä»¶ã€‚</p>
<a id="more"></a>

<h4 id="å‚è€ƒæ–‡çŒ®ï¼š"><a href="#å‚è€ƒæ–‡çŒ®ï¼š" class="headerlink" title="å‚è€ƒæ–‡çŒ®ï¼š"></a>å‚è€ƒæ–‡çŒ®ï¼š</h4><ul>
<li><p><a href="https://medium.com/@mahesh_joshi/understanding-server-side-rendering-in-react-in-easy-way-d2984bb7aa51" target="_blank" rel="noopener">å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯æ¸²æŸ“</a></p>
</li>
<li><p><a href="https://www.freecodecamp.org/news/server-side-rendering-your-react-app-in-three-simple-steps-7a82b95db82e/" target="_blank" rel="noopener">ä¸‰éƒ¨å®ç°SSR</a></p>
</li>
</ul>
<blockquote>
<p>Server side rendering is the way how you render the page initially in server and how the fully rendered page is send back to client.</p>
</blockquote>
<blockquote>
<p>æœåŠ¡ç«¯æ¸²æŸ“ï¼šåœ¨æœåŠ¡ç«¯ç”Ÿæˆçš„é¡µé¢ï¼Œåœ¨å®¢æˆ·ç«¯ä½¿ç”¨ã€‚</p>
</blockquote>
<h3 id="CSR-ä¸-SSR-çš„åŒºåˆ«"><a href="#CSR-ä¸-SSR-çš„åŒºåˆ«" class="headerlink" title="CSR ä¸ SSR çš„åŒºåˆ«"></a>CSR ä¸ SSR çš„åŒºåˆ«</h3><ul>
<li>å®¢æˆ·ç«¯æ¸²æŸ“ï¼šæµè§ˆå™¨ä¸‹è½½ä¸€ä¸ªå¾ˆå°çš„HTMLï¼Œå°†JavaScriptå’Œæ–‡ä»¶å¡«å……è¿›å»ï¼Œé¡µé¢æ¸²æŸ“ç”±JSè´Ÿè´£è¿›è¡Œ</li>
<li>æœåŠ¡ç«¯æ¸²æŸ“ï¼šæœåŠ¡å™¨è¿”å›ä¸€å †HTMLå­—ç¬¦ä¸²ï¼Œè®©æµè§ˆå™¨æ˜¾ç¤º</li>
</ul>
<h3 id="SSR-çš„å¼Šç«¯"><a href="#SSR-çš„å¼Šç«¯" class="headerlink" title="SSR çš„å¼Šç«¯"></a>SSR çš„å¼Šç«¯</h3><ol>
<li>å¦‚æœåº”ç”¨å¾ˆå°ï¼ŒSSR å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨å¾ˆå¤§ï¼ŒSSR ä¼šé™ä½æ€§èƒ½</li>
<li>å¢åŠ äº†æœåŠ¡ç«¯ response çš„æ—¶é—´ï¼Œå¦‚æœæœåŠ¡ç«¯ç¹å¿™ï¼Œåˆ™ä¼šæ›´ä¸¥é‡</li>
<li>å¢åŠ äº†response sizeï¼Œé¡µé¢éœ€è¦èŠ±æ¯”è¾ƒé•¿çš„æ—¶é—´å»åŠ è½½</li>
<li>å¢åŠ äº†åº”ç”¨çš„å¤æ‚æ€§</li>
</ol>
<h3 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨-SSR"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨-SSR" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ SSR"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ SSR</h3><ol>
<li><p>SEO</p>
<p>çˆ¬è™«ä¸èƒ½ç†è§£JavaScriptï¼Œå®ƒä»¬åªè®¤è¯† HTMLï¼Œä¸åšæœåŠ¡ç«¯æ¸²æŸ“ï¼Œçˆ¬è™«çœ‹åˆ°çš„æ˜¯ç©ºç™½é¡µé¢</p>
</li>
<li><p>æ›´å¥½çš„é¦–å±æ€§èƒ½ï¼Œä¸éœ€è¦æå‰å…ˆä¸‹è½½ä¸€å † CSS å’Œ JS åæ‰çœ‹åˆ°é¡µé¢</p>
</li>
</ol>
<h3 id="åŒæ„"><a href="#åŒæ„" class="headerlink" title="åŒæ„"></a>åŒæ„</h3><blockquote>
<p>ä¸€å¥—ä»£ç åœ¨æœåŠ¡ç«¯è¿è¡Œä¸€éï¼Œåœ¨å®¢æˆ·ç«¯åˆè¿è¡Œä¸€éï¼ŒæœåŠ¡ç«¯å®Œæˆé¡µé¢æ„å»ºï¼Œå®¢æˆ·ç«¯å®Œæˆäº‹ä»¶ç»‘å®š</p>
</blockquote>
<p>åŒæ„å¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆç¾ğŸ‘»</p>
<ul>
<li>ä¸å®¹å¿½è§†çš„æœåŠ¡å™¨ç«¯å’Œæµè§ˆå™¨ç¯å¢ƒå·®å¼‚ï¼Œwindowã€documentã€DOMä»¥åŠ å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ¸²æŸ“ä¸ä¸€è‡´ã€‚ä¸ä¸€è‡´å¯èƒ½ä¼šé€ æˆé¡µé¢çš„é—ªåŠ¨</li>
<li>å†…å­˜æº¢å‡º æŒ‡ç¨‹åºåœ¨ä¸ºè‡ªèº«ç”³è¯·å†…å­˜æ—¶ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ä¾›è‡ªå·±ä½¿ç”¨ï¼Œå‡ºç°out of memory<ul>
<li>æ³¨å†Œäº‹ä»¶å¿…é¡»æ”¾åœ¨ <code>componentDidMount</code> ã€‚ åœ¨ componentWillMount é‡Œåšç»‘å®šäº‹ä»¶å°±ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºï¼Œå› ä¸º React çš„è®¾è®¡æ˜¯åç«¯æ¸²æŸ“åªä¼šè¿è¡Œ componentDidMount ä¹‹å‰çš„æ“ä½œï¼Œè€Œä¸ä¼šè¿è¡Œ componentWillUnmount æ–¹æ³•ï¼ˆä¸€èˆ¬è§£ç»‘äº‹ä»¶åœ¨è¿™é‡Œï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 id="React-æœåŠ¡ç«¯æ¸²æŸ“åŸç†"><a href="#React-æœåŠ¡ç«¯æ¸²æŸ“åŸç†" class="headerlink" title="React æœåŠ¡ç«¯æ¸²æŸ“åŸç†"></a>React æœåŠ¡ç«¯æ¸²æŸ“åŸç†</h3><blockquote>
<p>React çš„è™šæ‹Ÿ DOM ä»¥å¯¹è±¡æ ‘çš„å½¢å¼å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä»»ä½•æ”¯æŒJavaScriptçš„ç¯å¢ƒä¸­ç”Ÿæˆï¼Œæ‰€ä»¥å¯ä»¥åœ¨æµè§ˆå™¨å’ŒNodeä¸­ç”Ÿæˆã€‚è¿™ä¸ºå‰åç«¯åŒæ„æä¾›äº†å…ˆå†³æ¡ä»¶ã€‚</p>
</blockquote>
<h4 id="è™šæ‹Ÿdom-åœ¨å‰åç«¯éƒ½æ˜¯ä»¥å¯¹è±¡æ ‘çš„å½¢å¼å­˜åœ¨ï¼Œä½†æ˜¯å±•éœ²åŸå‹çš„æ–¹å¼ä¸ä¸€æ ·ã€‚"><a href="#è™šæ‹Ÿdom-åœ¨å‰åç«¯éƒ½æ˜¯ä»¥å¯¹è±¡æ ‘çš„å½¢å¼å­˜åœ¨ï¼Œä½†æ˜¯å±•éœ²åŸå‹çš„æ–¹å¼ä¸ä¸€æ ·ã€‚" class="headerlink" title="è™šæ‹Ÿdom åœ¨å‰åç«¯éƒ½æ˜¯ä»¥å¯¹è±¡æ ‘çš„å½¢å¼å­˜åœ¨ï¼Œä½†æ˜¯å±•éœ²åŸå‹çš„æ–¹å¼ä¸ä¸€æ ·ã€‚"></a>è™šæ‹Ÿdom åœ¨å‰åç«¯éƒ½æ˜¯ä»¥å¯¹è±¡æ ‘çš„å½¢å¼å­˜åœ¨ï¼Œä½†æ˜¯å±•éœ²åŸå‹çš„æ–¹å¼ä¸ä¸€æ ·ã€‚</h4><ul>
<li><p>è™šæ‹Ÿdom â€“ client â€“&gt; DOM Element</p>
<p>Reactæä¾›ReactDOMServer.renderToStringå’ŒReactDOMServer.renderToStaticMarkup å¯å°†å…¶æ¸²æŸ“ä¸ºHTMLå­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>è™šæ‹Ÿdom â€“ server â€“&gt; HTML String </p>
<p>åœ¨æµè§ˆå™¨ï¼ŒReacté€šè¿‡ReactDOMçš„renderæ–¹æ³•å°†è™šæ‹Ÿdomæ¸²æŸ“åˆ°çœŸå®çš„domæ ‘ä¸Šï¼Œç”Ÿæˆç½‘é¡µ</p>
</li>
</ul>
<p>renderToStringï¼Œä¼šä¸ºç»„ä»¶å¢åŠ checksumï¼Œreactåœ¨å®¢æˆ·ç«¯é€šè¿‡checksumåˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°renderï¼Œç›¸åŒåˆ™ä¸é‡æ–°renderï¼Œçœç•¥åˆ›å»ºdomå’ŒæŒ‚è½½domçš„è¿‡ç¨‹ï¼Œæ¥ç€è§¦å‘componentDidMountç­‰äº‹ä»¶æ¥å¤„ç†æœåŠ¡ç«¯ä¸Šçš„æœªå°½äº‹å®œï¼ˆäº‹ä»¶ç»‘å®šç­‰ï¼‰ï¼Œä»è€ŒåŠ å¿«äº†äº¤äº’æ—¶é—´ã€‚ä¸åŒæ—¶ï¼Œç»„ä»¶å°†å®¢æˆ·ç«¯ä¸Šé‡æ–°æŒ‚è½½render</p>
<h3 id="é™æ€èµ„æºå¤„ç†æ–¹æ¡ˆ"><a href="#é™æ€èµ„æºå¤„ç†æ–¹æ¡ˆ" class="headerlink" title="é™æ€èµ„æºå¤„ç†æ–¹æ¡ˆ"></a>é™æ€èµ„æºå¤„ç†æ–¹æ¡ˆ</h3><p>é™æ€èµ„æºï¼šjsã€cssã€img ç­‰éæœåŠ¡å™¨åŠ¨æ€è¿è¡Œç”Ÿæˆçš„æ–‡ä»¶ã€é™æ€èµ„æºè¢«å®šä¹‰ä¸ºä¸€åˆ‡å¯ä»¥åœ¨å®¢æˆ·ç«¯æˆ–ä»£ç†ç«¯ç¼“å­˜çš„èµ„æº</p>
]]></content>
      <tags>
        <tag>SSR</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptæ·±æµ…æ‹·è´</title>
    <url>/2020/03/08/JavaScript%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D/</url>
    <content><![CDATA[<h3 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h3><h4 id="æ‰‹å·¥å®ç°"><a href="#æ‰‹å·¥å®ç°" class="headerlink" title="æ‰‹å·¥å®ç°"></a>æ‰‹å·¥å®ç°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowCopy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> copy = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        copy[i] = obj[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> copy</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<ul>
<li><p>forâ€¦in</p>
<ul>
<li>Enumerable</li>
<li>éå†å¯¹è±¡å±æ€§</li>
<li>key</li>
</ul>
</li>
<li><p>forâ€¦of</p>
<ul>
<li>[Symbol.iterator]</li>
<li>éå†æ•°ç»„</li>
<li>value</li>
</ul>
</li>
</ul>
<h4 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign"></a>Object.assign</h4><p>Object.assign() æ–¹æ³•å¯ä»¥æŠŠä»»æ„å¤šä¸ªçš„æºå¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§æ‹·è´ç»™ç›®æ ‡å¯¹è±¡ï¼Œç„¶åè¿”å›ç›®æ ‡å¯¹è±¡</p>
<h4 id="concat-slice"><a href="#concat-slice" class="headerlink" title="concat/slice"></a>concat/slice</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], &#123;<span class="attr">name</span>:<span class="string">"array"</span>&#125;];</span><br><span class="line"><span class="keyword">const</span> arraySlice= array.slice(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">const</span> arrayConcat = array.concat()</span><br><span class="line">arraySlice[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line"><span class="built_in">console</span>.log(&#123;array&#125;,&#123;arraySlice&#125;)</span><br><span class="line">arrayConcat[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">3</span></span><br><span class="line"><span class="built_in">console</span>.log(&#123;array&#125;,&#123;arrayConcat&#125;)</span><br></pre></td></tr></table></figure>
<p>åŸæ•°ç»„éƒ½å‘ç”Ÿäº†æ”¹å˜</p>
<h3 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h3><h4 id="JSON-parse-JSON-stringify"><a href="#JSON-parse-JSON-stringify" class="headerlink" title="JSON.parse(JSON.stringify())"></a>JSON.parse(JSON.stringify())</h4>]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>é¡¹ç›®è¸©å‘</title>
    <url>/2020/02/17/%E9%A1%B9%E7%9B%AE%E8%B8%A9%E5%9D%91/</url>
    <content><![CDATA[<p>æœ€è¿‘å‘ç°ï¼Œé¡¹ç›®é‡æ„çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå®¹æ˜“å‡ºbug</p>
<ul>
<li><p>é¡¹ç›®é‡æ„ç›¸è¾ƒäºé¡¹ç›® init ï¼Œä¸ä¼šé‚£ä¹ˆè°¨æ…ã€‚é€ æˆæ¼æ´</p>
</li>
<li><p>æµ‹è¯•èµ„æºä¹Ÿæ²¡æœ‰åˆç†åˆ†é…ï¼Œå¯¼è‡´é¡¹ç›®é‡æ„äº†ï¼Œå´æ²¡æœ‰ç»è¿‡æµ‹è¯•ã€‚</p>
<a id="more"></a>
<p>ä¸»è¦é€»è¾‘æ¯”è¾ƒé‡çš„éƒ¨åˆ†åœ¨äºï¼šä¼˜æƒ åˆ¸ å’Œ å€’è®¡æ—¶</p>
</li>
<li><p>DOM ref ä»€ä¹ˆæ—¶å€™ä¼šå˜åŒ–ï¼Œæ„Ÿè§‰ç”¨useEffectç›‘å¬ ref çš„å˜åŒ–ï¼Œå¹¶ä½œå‡ºç›¸åº”ç›‘å¬åŠ¨ä½œæ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºdom ref å¾ˆå°‘éœ€è¦æ”¹å˜çš„ã€‚</p>
</li>
</ul>
<h3 id="å¼¹å‡ºè’™å±‚åï¼Œé¡µé¢ç¦æ­¢æ»šåŠ¨"><a href="#å¼¹å‡ºè’™å±‚åï¼Œé¡µé¢ç¦æ­¢æ»šåŠ¨" class="headerlink" title="å¼¹å‡ºè’™å±‚åï¼Œé¡µé¢ç¦æ­¢æ»šåŠ¨"></a>å¼¹å‡ºè’™å±‚åï¼Œé¡µé¢ç¦æ­¢æ»šåŠ¨</h3><p>ğŸ‘‡å°†é¡µé¢å›ºå®š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">bodyEl.style.position = <span class="string">"fixed"</span>;</span><br></pre></td></tr></table></figure>

<p>ğŸ¤”ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å•Šï¼Œä»¥ä¸Šæ–¹æ³•å°† body ä½ç½®å›ºå®šï¼Œé¡µé¢ä¼šè‡ªåŠ¨åˆ’åˆ°æœ€é¡¶ä¸Šã€‚<br>ğŸ‘‰æ‰€ä»¥å…ˆè®°å½•ä¸‹å½“å‰é¡µé¢çš„æ»šåŠ¨è·ç¦»ï¼Œåœ¨ body æ ·å¼è®¾ç½®ä¸º fixed ä¹‹åï¼Œä¿®æ”¹ body çš„ top å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">bodyEl.style.position = <span class="string">"fixe</span></span><br><span class="line"><span class="string">bodyEl.style.width = "</span><span class="number">100</span>%<span class="string">";</span></span><br><span class="line"><span class="string">bodyEl.style.top = -top + "</span>px<span class="string">";</span></span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•ï¼Œèƒ½ä½¿è’™å±‚é‡Œé¢çš„å†…å®¹ç¦æ­¢æ»šåŠ¨ï¼Œè€Œä¸å½±å“è’™å±‚å¤–é¢çš„å¯æ»šåŠ¨åŒºåŸŸ</p>
<p>å½“éœ€è¦å…³é—­è’™å±‚æ—¶ï¼ŒæŠŠä¸€åˆ‡å¤åŸï¼ŒåŒæ—¶ï¼Œè¿˜æœ‰æ»šåŠ¨åˆ°åŸå…ˆçš„ä½ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line"><span class="keyword">const</span> top = -bodyEl.style.top.split(<span class="string">"px"</span>)[<span class="number">0</span>];</span><br><span class="line">bodyEl.style.position = <span class="string">""</span>;</span><br><span class="line">bodyEl.style.top = <span class="string">""</span>;</span><br><span class="line"><span class="built_in">window</span>.scrollTo(<span class="number">0</span>, top);</span><br></pre></td></tr></table></figure>

<p>componentWillCreate é‡Œé¢è¯·æ±‚æ•°æ®ï¼Œè¯·æ±‚è¶…æ—¶ã€‚ç»è¿‡äº†æ€æ ·çš„è¿‡ç¨‹ã€‚ä¸ºä»€ä¹ˆé¡µé¢è¿‡ä¸€æ®µæ—¶é—´åæ˜¯ç™½å±ã€‚</p>
<h3 id="Provisional-headers-are-shown"><a href="#Provisional-headers-are-shown" class="headerlink" title="Provisional headers are shown"></a>Provisional headers are shown</h3><h3 id="Promise-æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚"><a href="#Promise-æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚" class="headerlink" title="Promise æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚"></a>Promise æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getData1</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      resolve([])</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä½¿ç”¨ promise æ¨¡æ‹Ÿæ¥å£å¼‚å¸¸ï¼Œè¶…æ—¶ï¼Œå¯ä»¥å‘ç°ï¼Œå¦‚æœå°† getData1 æ“ä½œæ”¾åœ¨æœåŠ¡ç«¯è¿›è¡Œï¼ˆcomponentWillCreateï¼‰ï¼Œé‚£ä¹ˆï¼Œé¡µé¢ loading çš„è¿‡ç¨‹éœ€è¦ 10sï¼Œåœ¨è¿™ 10s çš„è¿‡ç¨‹ä¸­ï¼Œé¡µé¢å§‹ç»ˆæ˜¯ loadingçŠ¶æ€ï¼Œé¡µé¢ç™½å±ï¼Œè¦ç­‰ 10s ç­‰å¾…ç»“æŸï¼Œæ‰ä¼šå‡ºç°é¦–å±ã€‚</p>
<p>è€Œå¦‚æœæ”¾åœ¨ componentDidFirstMount ä¸­æ‰§è¡Œï¼Œé¦–å±å†…å®¹å¿«é€ŸåŠ è½½ã€‚ä½†æ˜¯è¦ç­‰åˆ° 10s ä¹‹åï¼Œæ‰ä¼šè¯·æ±‚å…¶ä»–æ¥å£ã€‚</p>
<p>ğŸ¤”é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœå°†è¯·æ±‚ getData1 çš„è¯·æ±‚æ”¾åœ¨ componentDidFirstMount ä¸­ï¼Œç«‹å³æ‰§è¡Œï¼Œç»„ä»¶ä¸­Visibility Change äº‹ä»¶ä¼šç­‰ getData1 å‡½æ•°å®Œå…¨æ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œã€‚<br>ä½†æ˜¯å½“ï¼Œå°† getData1 è¯·æ±‚æ”¾åœ¨ componentDidFirstMount çš„æœ€åä¸€æ­¥ã€‚è™½ç„¶ getData1 ä¹Ÿä¼šä¼˜å…ˆæ‰§è¡Œï¼Œä½†æ˜¯åœ¨ getData1 ç»“æœè¿”å›ä¹‹å‰ï¼ŒVisibility Change äº‹ä»¶ä¹Ÿè§¦å‘äº†ã€‚</p>
<p>åœ¨ componentDidFirstMount ä¹‹åï¼Œ getData1 å’Œ Visibility Changeå®é™…ä¸Šæ˜¯å¹¶åˆ—æ‰§è¡Œçš„ï¼Œäº’ä¸å½±å“ã€‚</p>
<h3 id="const-active-setActive-useState-startToLoad-ï¼Œå½“-startToLoad-å˜åŒ–çš„æ—¶å€™ï¼Œactive-æ˜¯å¦ä¼šå˜åŒ–"><a href="#const-active-setActive-useState-startToLoad-ï¼Œå½“-startToLoad-å˜åŒ–çš„æ—¶å€™ï¼Œactive-æ˜¯å¦ä¼šå˜åŒ–" class="headerlink" title="const [active, setActive] = useState(startToLoad)ï¼Œå½“ startToLoad å˜åŒ–çš„æ—¶å€™ï¼Œactive æ˜¯å¦ä¼šå˜åŒ–"></a><code>const [active, setActive] = useState(startToLoad)</code>ï¼Œå½“ startToLoad å˜åŒ–çš„æ—¶å€™ï¼Œactive æ˜¯å¦ä¼šå˜åŒ–</h3><p>å¦ï¼ŒstartToLoad åªæ˜¯ç»™ active æä¾›äº†ä¸€ä¸ªåˆå§‹å€¼ï¼Œèµ‹å€¼ç»“æŸåï¼Œæ§åˆ¶æƒäº¤ç»™ setActive</p>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p>å½“å¤šä¸ªæ¨¡æ¿æœ‰å¯èƒ½åŒæ—¶æ›´æ–°ä¸€ä¸ªå˜é‡æ—¶ (List)ï¼Œå¹¶ä¸”æ›´æ–°ä¹‹å‰å¯èƒ½è¿˜æœ‰å¼‚æ­¥æ“ä½œï¼Œåœ¨æ›´æ–° List ä¹‹å‰ï¼Œä¸€å®šè¦æ‹¿åˆ°æœ€æ–°çš„ List ä¿¡æ¯ï¼Œè€Œä¸èƒ½é€šè¿‡ä¼ é€’ã€‚å› ä¸ºä»å¼‚æ­¥æ“ä½œä¹‹å‰æ‹¿åˆ°çš„ List ä¸æ˜¯æœ€æ–°çš„ã€‚</p>
<h3 id="æœ¬åœ°è·‘æ²¡é—®é¢˜ï¼Œç”Ÿäº§æœ‰é—®é¢˜"><a href="#æœ¬åœ°è·‘æ²¡é—®é¢˜ï¼Œç”Ÿäº§æœ‰é—®é¢˜" class="headerlink" title="æœ¬åœ°è·‘æ²¡é—®é¢˜ï¼Œç”Ÿäº§æœ‰é—®é¢˜"></a>æœ¬åœ°è·‘æ²¡é—®é¢˜ï¼Œç”Ÿäº§æœ‰é—®é¢˜</h3><ul>
<li>é¡¹ç›®ä¸­æœ‰ä¸¤ä¸ªåŒåæ–‡ä»¶ï¼Œ.js å’Œ .jsx æ–‡ä»¶ï¼Œåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼Œ.tsx æ–‡ä»¶ä¼šæŠŠ .js æºæ–‡ä»¶ç»™è¦†ç›–ï¼Œå¯¼è‡´ç”Ÿäº§ç¯å¢ƒè·‘çš„æ˜¯ç»è¿‡ tsx ç¼–è¯‘åçš„ js æ–‡ä»¶ã€‚</li>
<li>è€Œåœ¨æœ¬åœ°è·‘çš„æ—¶å€™ï¼Œå§‹ç»ˆæ˜¯è·‘çš„æœªç¼–è¯‘çš„ç‰ˆæœ¬ .js æ–‡ä»¶ï¼Œæ‰€ä»¥æµ‹è¯•ç¯å¢ƒä¸ä¼šæœ‰é—®é¢˜ã€‚</li>
<li>ä½†æ˜¯å®¢æˆ·ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯è·‘çš„ js æ–‡ä»¶ã€‚</li>
<li>æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒï¼Œè¦åœ¨ publish ç›®å½•ä¸‹è¿è¡Œé¡¹ç›®</li>
</ul>
]]></content>
      <categories>
        <category>é¡¹ç›®ç»å†</category>
      </categories>
      <tags>
        <tag>é¡¹ç›®ç»å†</tag>
      </tags>
  </entry>
  <entry>
    <title>é¢è¯•é¢˜æ±‡æ€»</title>
    <url>/2020/02/29/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<h3 id="éå†ä¸€ä¸ª-DOM-æ ‘"><a href="#éå†ä¸€ä¸ª-DOM-æ ‘" class="headerlink" title="éå†ä¸€ä¸ª DOM æ ‘"></a>éå†ä¸€ä¸ª DOM æ ‘</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">traversal</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(node &amp;&amp; node.nodeType===<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(node.tagName)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> childs = node.childNodes</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;childs.length;i++)&#123;</span><br><span class="line">        traversal(childs[i])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>

<h3 id="new-æ“ä½œçš„å®ç°"><a href="#new-æ“ä½œçš„å®ç°" class="headerlink" title="new æ“ä½œçš„å®ç°"></a>new æ“ä½œçš„å®ç°</h3><ul>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶æŠŠ this æŒ‡å‘ç©ºå¯¹è±¡</li>
<li>ç»§æ‰¿äº†å‡½æ•°çš„åŸå‹</li>
<li>å±æ€§å’Œæ–¹æ³•è¢«åŠ å…¥åˆ° this å¼•ç”¨çš„å¯¹è±¡ä¸­</li>
<li>æ–°åˆ›å»ºçš„å¯¹è±¡ç”± this å¼•ç”¨ï¼Œæœ€åéšå¼è¿”å› this</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">new</span>(<span class="params">Function</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    obj.__proto__ = <span class="built_in">Function</span>.prototype</span><br><span class="line">    <span class="keyword">let</span> res = <span class="built_in">Function</span>.call(obj)</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span>(res) ===<span class="string">"function"</span> || <span class="keyword">typeof</span>(res) ===<span class="string">"object"</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="proto-å’Œ-prototype-çš„åŒºåˆ«"><a href="#proto-å’Œ-prototype-çš„åŒºåˆ«" class="headerlink" title="__proto__ å’Œ prototype çš„åŒºåˆ«"></a><code>__proto__</code> å’Œ prototype çš„åŒºåˆ«</h3><ul>
<li>å¯¹è±¡æœ‰å±æ€§<code>__proto__</code>,æŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡</li>
</ul>
<h3 id="å®ç°-call-å‡½æ•°"><a href="#å®ç°-call-å‡½æ•°" class="headerlink" title="å®ç° call å‡½æ•°"></a>å®ç° call å‡½æ•°</h3><p><a href="https://github.com/mqyqingfeng/Blog/issues/11" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
<p>call ä½¿ç”¨æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name: <span class="string">"obj name"</span></span><br><span class="line">&#125;</span><br><span class="line">foo.call2(obj)</span><br></pre></td></tr></table></figure>
<p>call ä½œç”¨</p>
<ul>
<li>å°† this æŒ‡å‘äº† obj</li>
<li>æ‰§è¡Œäº† foo å‡½æ•°</li>
</ul>
<p>å˜å½¢</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name:<span class="string">"obj name"</span>,</span><br><span class="line">    foo:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å°†å‡½æ•°å˜æˆå¯¹è±¡çš„å±æ€§</li>
<li>æ‰§è¡Œå‡½æ•°</li>
<li>åˆ é™¤å‡½æ•°<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">obj.fn = foo</span><br><span class="line">obj.fn()</span><br><span class="line"><span class="keyword">delete</span> obj.fn</span><br></pre></td></tr></table></figure>
å®ç°ï¼ŒæˆåŠŸâœ…<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.call2 = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    context.fn = <span class="keyword">this</span></span><br><span class="line">    context.fn()</span><br><span class="line">    <span class="keyword">delete</span> context.fn</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name: <span class="string">"obj name"</span></span><br><span class="line">&#125;</span><br><span class="line">foo.call2(obj)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>å¦‚æœä¼ å…¥å‚æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">hello,age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    <span class="built_in">console</span>.log(hello,age)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name: <span class="string">"obj name"</span></span><br><span class="line">&#125;</span><br><span class="line">foo.call(obj,<span class="string">"hello"</span>,<span class="number">14</span>)</span><br></pre></td></tr></table></figure>


<p>å®ç°æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.call2 = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    context.fn = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">let</span> args = []</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i =<span class="number">1</span>;i&lt;<span class="built_in">arguments</span>.length;i++)&#123;</span><br><span class="line">        args.push(<span class="string">"arguments["</span> + i + <span class="string">"]"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œå argsä¸º ["arguments[1]", "arguments[2]"]</span></span><br><span class="line">    <span class="built_in">eval</span>(<span class="string">'context.fn('</span> + args + <span class="string">')'</span>)</span><br><span class="line">    <span class="keyword">delete</span> context.fn</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">hello,age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    <span class="built_in">console</span>.log(hello,age)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    name: <span class="string">"obj name"</span></span><br><span class="line">&#125;</span><br><span class="line">foo.call2(obj,<span class="string">"hello"</span>,<span class="number">14</span>)</span><br></pre></td></tr></table></figure>

<p>æœ€åï¼Œéœ€è¦æ³¨æ„</p>
<ul>
<li><p>this å‚æ•°å¯ä»¥ä¼  nullï¼Œå½“ä¸º null çš„æ—¶å€™ï¼Œè§†ä¸ºæŒ‡å‘ window å¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> name = <span class="string">"hello"</span></span><br><span class="line"></span><br><span class="line">foo.call2(<span class="literal">null</span>) <span class="comment">// hello</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å‡½æ•°å¯ä»¥æœ‰è¿”å›å€¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        value:<span class="keyword">this</span>.value,</span><br><span class="line">        name:name,</span><br><span class="line">        age:age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">foo.call(bar)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.call2 = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    context = context || <span class="built_in">window</span></span><br><span class="line">    context.fn = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">let</span> args = []</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i =<span class="number">1</span>;i&lt;<span class="built_in">arguments</span>.length;i++)&#123;</span><br><span class="line">        args.push(<span class="string">"arguments["</span> + i + <span class="string">"]"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œå argsä¸º ["arguments[1]", "arguments[2]", "arguments[3]"]</span></span><br><span class="line">    <span class="keyword">const</span> result = <span class="built_in">eval</span>(<span class="string">'context.fn('</span> + args + <span class="string">')'</span>)</span><br><span class="line">    <span class="keyword">delete</span> context.fn</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        value:<span class="keyword">this</span>.value,</span><br><span class="line">        name:name,</span><br><span class="line">        age:age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(foo.call2(bar))</span><br></pre></td></tr></table></figure>


<h3 id="å®ç°-apply-å‡½æ•°"><a href="#å®ç°-apply-å‡½æ•°" class="headerlink" title="å®ç° apply å‡½æ•°"></a>å®ç° apply å‡½æ•°</h3><p>ä¸ call å®ç°æ–¹æ³•ç±»ä¼¼ã€‚åªä¸è¿‡ argument å‚æ•°å¯ä»¥ç›´æ¥é€šè¿‡æ•°ç»„æ‹¿ï¼Œè€Œä¸ç”¨è‡ªå·±ç”Ÿæˆ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.apply = <span class="function"><span class="keyword">function</span> (<span class="params">context, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> context = <span class="built_in">Object</span>(context) || <span class="built_in">window</span>;</span><br><span class="line">    context.fn = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="keyword">if</span> (!arr) &#123;</span><br><span class="line">        result = context.fn();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> args = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">            args.push(<span class="string">'arr['</span> + i + <span class="string">']'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        result = <span class="built_in">eval</span>(<span class="string">'context.fn('</span> + args + <span class="string">')'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> context.fn</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="å®ç°-bind-å‡½æ•°"><a href="#å®ç°-bind-å‡½æ•°" class="headerlink" title="å®ç° bind å‡½æ•°"></a>å®ç° bind å‡½æ•°</h3><p><a href="https://github.com/mqyqingfeng/Blog/issues/12" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
<ul>
<li>è¿”å›å‡½æ•°</li>
<li>å¯ä»¥ä¼ å…¥å‚æ•°<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> foo=&#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bindFoo = bar.bind(foo)</span><br><span class="line">bindFoo()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>å®ç°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind2</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> self = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> self.apply(context)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ï¼Œbind å¯ä»¥å®ç°æŸ¯é‡ŒåŒ–</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">    value: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value);</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">    <span class="built_in">console</span>.log(age);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bindFoo = bar.bind(foo, <span class="string">'daisy'</span>);</span><br><span class="line">bindFoo(<span class="string">'18'</span>);</span><br></pre></td></tr></table></figure>

<p>å®ç°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind2</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> self = <span class="keyword">this</span></span><br><span class="line">    <span class="comment">// è·å–bind2å‡½æ•°ä»ç¬¬äºŒä¸ªå‚æ•°åˆ°æœ€åä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="keyword">const</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ—¶å€™çš„argumentsæ˜¯æŒ‡bindè¿”å›çš„å‡½æ•°ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">        <span class="keyword">const</span> bindArgs = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">        <span class="keyword">return</span> self.apply(context,args.concat(bindArgs))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.bind2 = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span> !== <span class="string">"function"</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Function.prototype.bind - what is trying to be bound is not callable"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fNOP = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> fBound = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> bindArgs = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> self.apply(<span class="keyword">this</span> <span class="keyword">instanceof</span> fNOP ? <span class="keyword">this</span> : context, args.concat(bindArgs));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fNOP.prototype = <span class="keyword">this</span>.prototype;</span><br><span class="line">    fBound.prototype = <span class="keyword">new</span> fNOP();</span><br><span class="line">    <span class="keyword">return</span> fBound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HTTPS-åŸç†"><a href="#HTTPS-åŸç†" class="headerlink" title="HTTPS åŸç†"></a>HTTPS åŸç†</h3><h3 id="åŠ«æŒ-HTTP-è¯·æ±‚"><a href="#åŠ«æŒ-HTTP-è¯·æ±‚" class="headerlink" title="åŠ«æŒ HTTP è¯·æ±‚"></a>åŠ«æŒ HTTP è¯·æ±‚</h3><h3 id="å®ç°-Promise"><a href="#å®ç°-Promise" class="headerlink" title="å®ç° Promise"></a>å®ç° Promise</h3><p><a href="https://github.com/xieranmaya/blog/issues/3" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
<h3 id="å®ç°é¡¹ç›®æŒ‰éœ€åŠ è½½ï¼Œä¾‹å¦‚å¼•å…¥çš„-antd-åªåŠ è½½-button-ç»„ä»¶"><a href="#å®ç°é¡¹ç›®æŒ‰éœ€åŠ è½½ï¼Œä¾‹å¦‚å¼•å…¥çš„-antd-åªåŠ è½½-button-ç»„ä»¶" class="headerlink" title="å®ç°é¡¹ç›®æŒ‰éœ€åŠ è½½ï¼Œä¾‹å¦‚å¼•å…¥çš„ antd åªåŠ è½½ button ç»„ä»¶"></a>å®ç°é¡¹ç›®æŒ‰éœ€åŠ è½½ï¼Œä¾‹å¦‚å¼•å…¥çš„ antd åªåŠ è½½ button ç»„ä»¶</h3>]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
  </entry>
  <entry>
    <title>é¡¹ç›®æ€»ç»“</title>
    <url>/2020/01/10/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>å½“ä¸šåŠ¡å‘å±•åˆ°è¾¾æŸä¸€ç¨‹åº¦ï¼Œæœ‰é™çš„å¼€å‘äººåŠ›å’Œå†—é•¿çš„å¼€å‘æµç¨‹æ— æ³•æ»¡è¶³è“¬å‹ƒå‘å±•çš„ä¸šåŠ¡éœ€æ±‚ã€‚å¦‚æœå®Œå…¨ä¾é ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ï¼Œå”¯æœ‰é€šè¿‡åŠ ç­æ¥è§£å†³ã€‚</p>
<a id="more"></a>

<h3 id="æ–¹å‘"><a href="#æ–¹å‘" class="headerlink" title="æ–¹å‘"></a>æ–¹å‘</h3><p>ç›®æ ‡ç”¨æˆ·æ˜¯å„ä¸ªäº‹ä¸šéƒ¨çš„è¿è¥ï¼Œæ­å»ºé¡µé¢çš„æ“ä½œåº”è¯¥æ˜¯â€å‚»ç“œå¼â€œçš„ï¼Œå³ä¸ç”¨æ‡‚ä»»ä½•æŠ€æœ¯ç›¸å…³çš„çŸ¥è¯†å°±èƒ½å®Œæˆä¸€ä¸ªé¡µé¢çš„æ­å»ºã€‚ä»–æ˜¯ä¸€ä¸ªé¡µé¢æ­å»ºå¹³å°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªæ´»åŠ¨å‘å¸ƒå¹³å°ï¼Œå¯ä»¥ä¾¿æ·åœ°ç‚¹å‡»å‘å¸ƒæŒ‰é’®æ›´æ–°é¡µé¢</p>
<h3 id="æ´»åŠ¨é¡µæ­å»º"><a href="#æ´»åŠ¨é¡µæ­å»º" class="headerlink" title="æ´»åŠ¨é¡µæ­å»º"></a>æ´»åŠ¨é¡µæ­å»º</h3><p>æ‰€è§å³æ‰€å¾—çš„æ“ä½œæ¨¡å¼ï¼Œæä¾›å„ç§ç»„ä»¶ï¼Œé€šè¿‡ç»„åˆé…ç½®å‡ºè½åœ°é¡µã€‚</p>
<ul>
<li>å¯è§†åŒ–é…ç½®ç•Œé¢ï¼š é€šè¿‡é…ç½®å†™å…¥æ•°æ®åº“</li>
<li>æ¥å£ç³»ç»Ÿï¼šè¯»å–å†™å…¥æ•°æ®åº“çš„å†…å®¹ä¿¡æ¯</li>
<li>å‰ç«¯ï¼šæ ¹æ®æ¥å£ä¸‹å‘çš„å†…å®¹å±•ç¤ºé¡µé¢</li>
</ul>
<h3 id="é¡¹ç›®ç‰¹ç‚¹"><a href="#é¡¹ç›®ç‰¹ç‚¹" class="headerlink" title="é¡¹ç›®ç‰¹ç‚¹"></a>é¡¹ç›®ç‰¹ç‚¹</h3><h3 id="é¡¹ç›®éš¾ç‚¹"><a href="#é¡¹ç›®éš¾ç‚¹" class="headerlink" title="é¡¹ç›®éš¾ç‚¹"></a>é¡¹ç›®éš¾ç‚¹</h3><ul>
<li>é«˜åº¦å ä½ï¼Œé˜²æ­¢æ¥¼å±‚åå¡Œä»¥åŠå¿½ç„¶å‡ºç°çš„ç°è±¡</li>
</ul>
<blockquote>
<p>é‡‡ç”¨dangerouslySetInnerHTML, é¡µé¢æŒ‚è½½çš„æ—¶å€™è®¡ç®—å±å¹•å®½åº¦ï¼Œè®¡ç®—å›¾ç‰‡åº”è¯¥å±•ç¤ºçš„é«˜åº¦ã€‚ä¿è¯ç²¾ç¡®å ä½</p>
</blockquote>
<ul>
<li>é‡‡ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå‡å°‘é¦–å±æ¸²æŸ“æ—¶é—´</li>
<li>é”šç‚¹å¯¼èˆªï¼ŒåŠ¨æ€è®¡ç®—é¡µé¢éœ€è¦æ»šåŠ¨çš„é«˜åº¦</li>
</ul>
<blockquote>
<p>å¯¹äºæŸäº›æ¥¼å±‚æ¥è¯´ï¼ˆæ¯”å¦‚äº§å“åˆ—è¡¨ï¼‰ï¼Œç”±äºä¸ç¡®å®šè¿”å›çš„äº§å“æ•°é‡ï¼Œå ä½é«˜åº¦ä¸å‡†ç¡®ã€‚ç›‘å¬ä¸€ä¸ªå…¨å±€çŠ¶æ€ï¼Œå½“å…¨å±€çŠ¶æ€æ”¹å˜åï¼Œé‡æ–°è®¡ç®—éœ€è¦æ»šåŠ¨çš„è·ç¦»ï¼Œå¹¶è¿›è¡Œæ»šåŠ¨ã€‚éœ€è¦åœ¨componentDidMountä¹‹åæ‰§è¡Œã€‚æˆ–è€…ä¹Ÿå¯ä»¥ç”¨setTimeoutï¼Œåœ¨renderä¹‹åæ‰§è¡Œã€‚</p>
</blockquote>
<ul>
<li>å€’è®¡æ—¶ã€‚ä½¿ç”¨requestAnimationFrameã€‚</li>
</ul>
<blockquote>
<p>é€šè¿‡é¡µé¢æŒ‚è½½çš„æ—¶é—´timestampç²¾å‡†å€’è®¡æ—¶ã€‚é˜²æ­¢setTimeoutæ—¶é—´ä¸å‡†ç¡®çš„é—®é¢˜ã€‚åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢é¡µé¢æ¯å±ä¹‹åï¼Œçº¿ç¨‹æ”¾ç¼“çš„é—®é¢˜ï¼Œé€šè¿‡ç›‘å¬visibilityChangeäº‹ä»¶ï¼Œå½“é¡µé¢é‡æ–°å¯è§†æ—¶ï¼Œè¯·æ±‚æœåŠ¡æ¥å£ï¼Œæ›´æ–°å€’è®¡æ—¶æ—¶é—´ã€‚</p>
</blockquote>
<h3 id="é¡¹ç›®ä¸­æœ‰è¶£çš„bug"><a href="#é¡¹ç›®ä¸­æœ‰è¶£çš„bug" class="headerlink" title="é¡¹ç›®ä¸­æœ‰è¶£çš„bug"></a>é¡¹ç›®ä¸­æœ‰è¶£çš„bug</h3><ul>
<li>åº•éƒ¨å¯¼èˆªIOSåŒå‡»ï¼Œé¡µé¢ä¸‹æ»‘</li>
<li>safariæµè§ˆå™¨æŠŠåŠ ä¸ªé»˜è®¤æˆç”µè¯å·ç ï¼Œä½¿å¾—æ–‡å­—é¢œè‰²æ”¹å˜ä¸ºé»‘è‰²</li>
</ul>
]]></content>
      <categories>
        <category>é¡¹ç›®ç»å†</category>
      </categories>
  </entry>
  <entry>
    <title>react å¦‚ä½•åŒºåˆ† class å’Œ function</title>
    <url>/2020/02/29/react-%E5%A6%82%E4%BD%95%E5%8C%BA%E5%88%86-class-%E5%92%8C-function/</url>
    <content><![CDATA[<p>å¸¸è§„ React ç»„ä»¶çš„å®šä¹‰æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>


<p>å¦‚æœ Greeting æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒReact éœ€è¦è°ƒç”¨å®ƒ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = Greeting(props)</span><br></pre></td></tr></table></figure>

<p>ä½†å¦‚æœ Greeting æ˜¯ä¸€ä¸ªç±»ï¼ŒReact éœ€è¦å…ˆç”¨ new æ“ä½œç¬¦å°†å…¶å®ä¾‹åŒ–ï¼Œç„¶å è°ƒç”¨åˆšæ‰ç”Ÿæˆå®ä¾‹çš„ render æ–¹æ³•ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> Greeting(props)</span><br><span class="line"><span class="keyword">const</span> result = instance.render()</span><br></pre></td></tr></table></figure>


<p>åªè¦åœ¨å‡½æ•°è°ƒç”¨å‰åŠ ä¸Š new æ“ä½œç¬¦ï¼Œä½ å°±å¯ä»¥æŠŠä»»ä½•å‡½æ•°å½“åšä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°æ¥ç”¨</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ª &#123;&#125; å¯¹è±¡å¹¶æŠŠ Person ä¸­çš„ this æŒ‡å‘é‚£ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿æˆ‘å¯ä»¥é€šè¿‡ç±»ä¼¼ this.name çš„å½¢å¼å»è®¾ç½®ä¸€äº›ä¸œè¥¿ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡è¿”å›ç»™æˆ‘</span></span><br><span class="line"><span class="keyword">const</span> fred = <span class="keyword">new</span> Person(<span class="string">"fred"</span>) <span class="comment">// Person &#123; name: 'fred' &#125;</span></span><br><span class="line"><span class="keyword">const</span> geroge = Person(<span class="string">"geroge"</span>) <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>new æ“ä½œç¬¦åŒæ—¶ä¹ŸæŠŠæˆ‘ä»¬æ”¾åœ¨ Person.prototype ä¸Šçš„ä¸œè¥¿æ”¾åˆ°äº† fred å¯¹è±¡ä¸Š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fred = <span class="keyword">new</span> Person(<span class="string">"fred"</span>) <span class="comment">// Person &#123; name: 'fred' &#125;</span></span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hello, I' m "</span> + <span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line">fred.sayHi()</span><br></pre></td></tr></table></figure>


<p>é€šè¿‡ç±»æ¥å®ç°ç›¸åŒçš„åŠŸèƒ½</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">    sayHi()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"hello, I'm "</span> + <span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fred = <span class="keyword">new</span> Person(<span class="string">"fred"</span>)</span><br><span class="line">fred.sayHi()</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äºç±»ï¼Œå¦‚æœå¿˜è®°åŠ  new ï¼Œä¼šå¯¼è‡´ç¨‹åºæŠ¥é”™</li>
<li>å¯¹äºå‡½æ•°ï¼Œå¦‚æœå¿˜è®°åŠ  new ï¼Œä¼šå¯¼è‡´ this æŒ‡å‘å…¨å±€æˆ–è€… undefined</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>new Person()</th>
<th>Person()</th>
</tr>
</thead>
<tbody><tr>
<td>class</td>
<td>âœ…this æ˜¯ä¸€ä¸ª Person å®ä¾‹</td>
<td>âŒTypeError</td>
</tr>
<tr>
<td>function</td>
<td>âœ…this æ˜¯ä¸€ä¸ª Person å®ä¾‹</td>
<td>âš ï¸this æ˜¯ window æˆ– undefined</td>
</tr>
</tbody></table>
<p>å¦‚æœ React æ¯æ¬¡è°ƒç”¨å‰éƒ½åŠ  new ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<p>å¯¹äºç®­å¤´å‡½æ•°ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Greeting = <span class="function"><span class="params">()</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line"><span class="keyword">new</span> Greeting(); <span class="comment">// ğŸ”´ Greeting ä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°</span></span><br></pre></td></tr></table></figure>


<ul>
<li><p>ç®­å¤´å‡½æ•°çš„ä¸€ä¸ªé™„å¸¦ä½œç”¨æ˜¯å®ƒæ²¡æœ‰è‡ªå·±çš„ this å€¼ â€”â€” this è§£æè‡ªç¦»å¾—æœ€è¿‘çš„å¸¸è§„å‡½æ•°</p>
</li>
<li><p>ç®­å¤´å‡½æ•°æ²¡æœ‰ thisï¼Œæ„å‘³ç€ä»–ä½œä¸ºæ„é€ å‡½æ•°æ˜¯æ— ç”¨çš„ã€‚</p>
</li>
<li><p>ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).prototype</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;).prototype</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>å¦ä¸€ä¸ªæˆ‘ä»¬ä¸èƒ½æ€»æ˜¯ä½¿ç”¨ new çš„åŸå› æ˜¯å®ƒä¼šå¦¨ç¢ React æ”¯æŒè¿”å›å­—ç¬¦ä¸²æˆ–å…¶å®ƒåŸå§‹ç±»å‹çš„ç»„ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(Greeting())  <span class="comment">// Hello</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Greeting()) <span class="comment">// Greeting &#123;&#125;</span></span><br></pre></td></tr></table></figure>


<p>å¦‚æœä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä¼šè¢« new å®Œå…¨å¿½ç•¥ã€‚å¦‚æœä½ è¿”å›äº†ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œå°±å¥½åƒå®Œå…¨æ²¡æœ‰ return ä¸€æ ·</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Answer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Answer(); <span class="comment">// âœ… 42</span></span><br><span class="line"><span class="keyword">new</span> Answer(); <span class="comment">// ğŸ”´Answer &#123;&#125;</span></span><br></pre></td></tr></table></figure>

<p>æ£€æŸ¥ Greeting æ˜¯å¦æ˜¯ä¸€ä¸ª React ç»„ä»¶ç±»çš„æœ€ç¬¦åˆè¯­è¨€ä¹ æƒ¯çš„æ–¹å¼æ˜¯æµ‹è¯• Greeting.prototype instanceof React.Component</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(B.prototype <span class="keyword">instanceof</span> A); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå‡½æ•°çš„ prototype å¹¶ä¸æŒ‡å‘ä»–çš„åŸå‹ï¼Œ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype <span class="comment">// Person &#123;&#125; ğŸ”´ ä¸æ˜¯ Person çš„åŸå‹</span></span><br><span class="line">Person.__proto__  <span class="comment">// f()&#123;[native code]&#125; âœ… Person çš„åŸå‹</span></span><br></pre></td></tr></table></figure>

<p>å› æ­¤ã€ŒåŸå‹é“¾ã€æ›´åƒæ˜¯ <strong>proto</strong>.<strong>proto</strong>.<strong>proto</strong> è€Œä¸æ˜¯ prototype.prototype.prototype</p>
<p>é‚£ä¹ˆå‡½æ•°å’Œç±»çš„ prototype å±æ€§åˆæ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ç”¨ new è°ƒç”¨é‚£ä¸ªç±»æˆ–å‡½æ•°ç”Ÿæˆçš„æ‰€æœ‰å¯¹è±¡çš„ <strong>proto</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'Hi, I am '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fred = <span class="keyword">new</span> Person(<span class="string">'Fred'</span>); <span class="comment">// è®¾ç½® `fred.__proto__` ä¸º `Person.prototype`</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> Greeting();</span><br><span class="line"><span class="built_in">console</span>.log(c.__proto__); <span class="comment">// Greeting.prototype</span></span><br><span class="line"><span class="built_in">console</span>.log(c.__proto__.__proto__); <span class="comment">// React.Component.prototype</span></span><br><span class="line"><span class="built_in">console</span>.log(c.__proto__.__proto__.__proto__); <span class="comment">// Object.prototype</span></span><br><span class="line"></span><br><span class="line">c.render();      <span class="comment">// åœ¨ c.__proto__ (Greeting.prototype) ä¸Šæ‰¾åˆ°</span></span><br><span class="line">c.setState();    <span class="comment">// åœ¨ c.__proto__.__proto__ (React.Component.prototype) ä¸Šæ‰¾åˆ°</span></span><br><span class="line">c.toString();    <span class="comment">// åœ¨ c.__proto__.__proto__.__proto__ (Object.prototype) ä¸Šæ‰¾åˆ°</span></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>å€’è®¡æ—¶</title>
    <url>/2019/12/28/%E5%80%92%E8%AE%A1%E6%97%B6/</url>
    <content><![CDATA[<h2 id="æœ€è¿‘ç”¨ä¸¤ç§å†™å‘å†™äº†å€’è®¡æ—¶çš„åŠŸèƒ½"><a href="#æœ€è¿‘ç”¨ä¸¤ç§å†™å‘å†™äº†å€’è®¡æ—¶çš„åŠŸèƒ½" class="headerlink" title="æœ€è¿‘ç”¨ä¸¤ç§å†™å‘å†™äº†å€’è®¡æ—¶çš„åŠŸèƒ½"></a>æœ€è¿‘ç”¨ä¸¤ç§å†™å‘å†™äº†å€’è®¡æ—¶çš„åŠŸèƒ½</h2><a id="more"></a>


<h3 id="ç¬¬ä¸€ç§ï¼Œé€šè¿‡requestAnimationFrameå®ç°"><a href="#ç¬¬ä¸€ç§ï¼Œé€šè¿‡requestAnimationFrameå®ç°" class="headerlink" title="ç¬¬ä¸€ç§ï¼Œé€šè¿‡requestAnimationFrameå®ç°"></a>ç¬¬ä¸€ç§ï¼Œé€šè¿‡requestAnimationFrameå®ç°</h3><p>æˆ‘ä»¬ç”¨ Hooks æ¥å®ç°å€’è®¡æ—¶çš„åŠŸèƒ½ã€‚<br>æ‰¾åˆ°ä¸€ç¯‡ç›¸åŒçš„æ–‡ç« ï¼Œ<a href="https://css-tricks.com/using-requestanimationframe-with-react-hooks/" target="_blank" rel="noopener">ç‚¹å‡»</a></p>
<p>åœ¨å‡½æ•°å¼ç»„ä»¶ä¸­ï¼Œæœ‰ä¸‰ç§æ–¹å¼å­˜å‚¨å˜é‡</p>
<ul>
<li>é€šè¿‡ let æˆ–è€… const å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œæ¯å½“ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œè¿™äº›å˜é‡éƒ½ä¼šé‡æ–°è¢«åˆå§‹åŒ–</li>
<li>é€šè¿‡ useState ,åœ¨å¤šæ¬¡é‡æ–°æ¸²æŸ“ä¹‹åï¼Œå®ƒçš„å€¼ä¿æŒä¸å˜ã€‚å¹¶ä¸”ï¼Œå¦‚æœé€šè¿‡ setState æ”¹å˜äº†å®ƒçš„å€¼ï¼Œä¹Ÿä¼šå¼•èµ· é‡æ–°æ¸²æŸ“</li>
<li>useRef</li>
</ul>
<p>useRef æœ€å¼€å§‹ä½¿ç”¨ï¼Œæ˜¯æŒ‡å‘ DOM çš„ï¼Œä½†ä»–çš„ç”¨å¤„å¹¶ä¸ä»…ä»…å¦‚æ­¤ã€‚ä»–æ˜¯ä¸€ä¸ªå¯å˜çš„å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å¤šæ¬¡æ¸²æŸ“åè¿˜èƒ½ä¿æŒä»–çš„å€¼ä¸å˜ã€‚<br>useRef å®šä¹‰çš„å˜é‡ å’Œ useState å®šä¹‰çš„å˜é‡ç›¸ä¼¼ï¼Œé™¤äº†è¯»å–å’Œæ›´æ–°ä»–çš„å€¼é€šè¿‡ .current å±æ€§ï¼Œé™¤äº†æ”¹å˜ä»–çš„å€¼ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“</p>
<p>ğŸ‘‡å½“ Component ç»„ä»¶çš„çˆ¶ç»„ä»¶ä¸åœ render çš„æ—¶å€™ï¼ŒComponent ç»„ä»¶ä¹Ÿä¼šè·Ÿç€renderï¼Œä½†æ˜¯ variable çš„å€¼ä¿æŒä¸å˜ã€‚<br>å…¶ä¸­ setTimeout å‡½æ•°ä¼šæ‰§è¡Œï¼Œä½†æ˜¯ variable çš„å€¼å§‹ç»ˆä¿æŒ 5ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> variable = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    variable = variable + <span class="number">3</span>;</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;variable&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‡ å½“ä½¿ç”¨ useState æ—¶ï¼Œå°±ç®—çˆ¶ç»„ä»¶ä¸é‡æ–°æ¸²æŸ“ï¼Œ variable çš„å€¼è¿˜æ˜¯ä¼šæ¯éš”ä¸€ç§’å¢åŠ  3<br>å› ä¸ºå½“é¡µé¢æ¸²æŸ“æ—¶ï¼ŒsetTimeout ä¼šåœ¨ä¸€ç§’å setVariableï¼Œè€Œ setVariable ä¼šè§¦å‘ç»„ä»¶æ¸²æŸ“ï¼Œè€Œç»„ä»¶æ¸²æŸ“åˆä¼šå¯¼è‡´ setTimeout ä¸€ç§’å setVariable</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> [variable,setVariable] = useState(<span class="number">5</span>)</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        setVariable(variable+<span class="number">3</span>)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;&#123;variable&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p> ğŸ‘‡ å½“ä½¿ç”¨ useRef ï¼Œç»„ä»¶ä¼šè¿”å› 5ï¼Œå¹¶ä¸”ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯ï¼Œå¦‚æœçˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä¼šå¼•èµ· variable æ¯æ¬¡å¢åŠ  3ã€‚<br> âš ï¸ æ³¨æ„ï¼Œç¬¬ä¸€æ¬¡æ¸²æŸ“åï¼ŒsetTimeout æ‰§è¡Œ 1 ç§’ååŠ  3ï¼Œå¹¶ä¸ä¼šå¯¼è‡´ variable åŠ  3ï¼Œå› ä¸ºæ²¡æœ‰è§¦å‘é‡æ¸²æŸ“ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> variable = useRef(<span class="number">5</span>)</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        variable.current += <span class="number">3</span></span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;&#123;variable.current&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>âœ… åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ useRef çš„ä¸¤ä¸ªåœ°æ–¹</p>
<ul>
<li>request animation frame ID</li>
<li>å‰ä¸€æ¬¡çš„ timestamp</li>
</ul>
<h4 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h4><p>useEffect æ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡ï¼Œå› æ­¤ï¼Œç»™ useEffect çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ã€‚<br>ä½†æ˜¯ï¼Œä¼ é€’ç©ºæ•°ç»„æœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œåœ¨åŠ¨ç”»æœŸé—´ï¼Œæˆ‘ä»¬ä¸èƒ½è·å–åˆ°æ­£ç¡®çš„ state ä¿¡æ¯ã€‚<br>ç¬¬äºŒä¸ªå‚æ•°åº”è¯¥æ˜¯ä¸€ç³»åˆ—æ”¹å˜çš„å€¼ï¼Œè€Œå› ä¸ºè¿™äº›å€¼çš„æ”¹å˜ï¼Œç»„ä»¶éœ€è¦ä½œå‡ºç›¸åº”çš„æ”¹å˜ã€‚<br>å¦‚ä¾‹å­æ‰€ç¤ºï¼Œanimation ä¸­çš„ state å€¼ï¼Œå§‹ç»ˆæ˜¯åˆå§‹å€¼ï¼Œä¸ä¼šå› ä¸º setState è€Œå¯¼è‡´ animate ä¸­çš„å€¼å‘ç”Ÿå˜åŒ–ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [state, setState] = React.useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> requestRef = React.useRef()</span><br><span class="line">  <span class="keyword">const</span> animate = <span class="function"><span class="params">time</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// The 'state' will always be the initial value here</span></span><br><span class="line">    requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">  &#125;</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> cancelAnimationFrame(requestRef.current);</span><br><span class="line">  &#125;, []); <span class="comment">// Make sure the effect runs only once</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;state&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£åœ¨ useEffect ä¸­æ€ä¹ˆè·å–æœ€æ–°çŠ¶æ€å‘¢ï¼Ÿ<br>ğŸ™Œé€šè¿‡ <code>setState(prevState =&gt; prevState + delta)</code></p>
<p>å®ç°çš„åŠŸèƒ½æ˜¯ï¼šä» 1 æ•°åˆ° 100ï¼Œ ä¹‹åå›åˆ° 1 é‡æ–°å¼€å§‹è®¡æ•°<br>çœ‹çœ‹ä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Counter = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">const</span> requestRef = React.useRef();</span><br><span class="line">    <span class="keyword">const</span> previousTimeRef = React.useRef();</span><br><span class="line">    <span class="keyword">const</span> animate = <span class="function"><span class="params">time</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (previousTimeRef.current != <span class="literal">undefined</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> deltaTime = time - previousTimeRef.current;</span><br><span class="line">            setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> (prevCount + deltaTime * <span class="number">0.01</span>) % <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        previousTimeRef.current = time;</span><br><span class="line">        requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">    &#125;</span><br><span class="line">    React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> cancelAnimationFrame(requestRef.current);</span><br><span class="line">    &#125;, []); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;Math.round(count)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ğŸ‘ å°†ä¸»è¦é€»è¾‘è¿ç§»åˆ° è‡ªå®šä¹‰Hookã€‚</p>
<ul>
<li>ç®€åŒ–æˆ‘ä»¬çš„ç»„ä»¶ï¼Œéšè—å˜é‡ï¼Œä¸å¯¹ç»„ä»¶å½±å“</li>
<li>è‡ªå®šä¹‰ç»„ä»¶å¯å¤ç”¨</li>
</ul>
<p>ä½œä¸ºå…¬çº¦ï¼Œè‡ªå®šä¹‰ç»„ä»¶åº”è¯¥ä»¥ use å¼€å¤´ï¼Œå¹¶ä¸” hooks çš„è§„åˆ™é€‚ç”¨ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> useAnimationFrame = <span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> requestRef = React.useRef();</span><br><span class="line">    <span class="keyword">const</span> previousTimeRef = React.useRef();</span><br><span class="line">    <span class="keyword">const</span> animate = <span class="function"><span class="params">time</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (previousTimeRef.current != <span class="literal">undefined</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> deltaTime = time - previousTimeRef.current;</span><br><span class="line">            callback(deltaTime)</span><br><span class="line">        &#125;</span><br><span class="line">        previousTimeRef.current = time;</span><br><span class="line">        requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        requestRef.current = requestAnimationFrame(animate);</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> cancelAnimationFrame(requestRef.current);</span><br><span class="line">    &#125;, []);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Counter = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = React.useState(<span class="number">0</span>)</span><br><span class="line">    useAnimationFrame(<span class="function"><span class="params">deltaTime</span> =&gt;</span> &#123;</span><br><span class="line">        setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> (prevCount + deltaTime * <span class="number">0.01</span>) % <span class="number">100</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;Math.round(count)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>é€šè¿‡ <code>document.addEventListener(&quot;visibilitychange&quot;,this.diffTime,false)</code> è§¦å‘å¯è§†ç›‘å¬äº‹ä»¶ã€‚<br>ä½†æ˜¯ï¼Œé€šè¿‡æµè§ˆå™¨æ‰“å¼€çš„é¡µé¢ï¼Œæ¯”å¦‚å¾®ä¿¡æµè§ˆå™¨ï¼Œ <code>safari</code> æµè§ˆå™¨ï¼Œå…¶ä»–æ‰‹æœºè‡ªå¸¦æµè§ˆå™¨ç­‰ç­‰ï¼Œæ˜¯åœ¨å½“å‰é¡µé¢æ–°å¼€çš„ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ <code>visibilitychange</code> äº‹ä»¶ï¼Œç›¸å½“äºä¸€ç›´åœ¨å½“å‰é¡µé¢ï¼Œä»æ¥æ²¡æœ‰ç¦»å¼€è§†å£ã€‚è€Œä¸”æµè§ˆå™¨ä¼šå¯¹æ‰“å¼€çš„ä¹Ÿæ²¡è¿›è¡Œç¼“å­˜ï¼Œé¡µé¢å›é€€ä¸ä¼šé‡æ–°ä» <code>componentwillcreate</code> ç”Ÿå‘½å‘¨æœŸå¼€å§‹ï¼Œåªä¼šä» <code>componentdidmount</code> å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ <code>html</code> ä¸ä¼šé‡æ–°è¯·æ±‚ï¼Œåªä¼šå¯¹å®¢æˆ·ç«¯çš„æ“ä½œé‡æ–°å¼€å§‹æ‰§è¡Œã€‚<br> è§£å†³æ–¹æ³•æ˜¯<br> é™æ€ <code>html</code> ä¸­æ·»åŠ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">id</span>=<span class="string">"refreshed"</span> <span class="attr">value</span>=<span class="string">"no"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>componentDidMount</code> ä¸­æ·»åŠ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">disableHTMLCache = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">"undefined"</span>) &#123;</span><br><span class="line">        <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> e = <span class="built_in">document</span>.getElementById(<span class="string">"refreshed"</span>);</span><br><span class="line">            <span class="keyword">if</span> (e.value == <span class="string">"no"</span>) &#123;</span><br><span class="line">                e.value = <span class="string">"yes"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                e.value = <span class="string">"no"</span>;</span><br><span class="line">                location.reload();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a href="https://developers.google.com/web/updates/2019/02/back-forward-cache" target="_blank" rel="noopener">æµè§ˆå™¨ç‰¹æ€§æ”¯æŒ</a></p>
<h4 id="ç¬¬äºŒç§ï¼Œé€šè¿‡setIntervalå®ç°"><a href="#ç¬¬äºŒç§ï¼Œé€šè¿‡setIntervalå®ç°" class="headerlink" title="ç¬¬äºŒç§ï¼Œé€šè¿‡setIntervalå®ç°"></a>ç¬¬äºŒç§ï¼Œé€šè¿‡setIntervalå®ç°</h4><ul>
<li><p><code>JS</code> ä¸»çº¿ç¨‹æ‰§è¡Œæ—¶æœ‰ä¸€ä¸ªæ ˆå­˜å‚¨è¿è¡Œæ—¶çš„å‡½æ•°ç›¸å…³å˜é‡, é‡åˆ°å‡½æ•°æ—¶ä¼šå…ˆå…¥æ ˆæ‰§è¡Œå®Œåå†å‡ºæ ˆã€‚å½“é‡åˆ° <code>setTimeout</code>  <code>setInterval</code>  <code>requestAnimationFrame</code> ä»¥åŠ <code>I/O</code> æ“ä½œæ—¶ï¼Œè¿™äº›å‡½æ•°ä¼šç«‹åˆ»è¿”å›ä¸€ä¸ªå€¼ï¼ˆå¦‚ <code>setInterval</code> è¿”å›ä¸€ä¸ª <code>intervalID</code> ï¼‰ä¿è¯ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œè€Œå¼‚æ­¥æ“ä½œåˆ™ç”±æµè§ˆå™¨çš„å…¶å®ƒçº¿ç¨‹ç»´æŠ¤ã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œæµè§ˆå™¨ä¼šå°†å…¶å›è°ƒå‡½æ•°æ’å…¥ä¸»çº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå½“ä¸»çº¿ç¨‹æ‰§è¡Œå®Œå½“å‰æ ˆçš„é€»è¾‘åï¼Œæ‰ä¼šä¾æ¬¡æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ </p>
</li>
<li><p>ä½†æ˜¯åœ¨æ¯ä¸ªä»»åŠ¡ä¹‹é—´ï¼Œè¿˜æœ‰ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—çš„å­˜åœ¨ã€‚åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå°†å…ˆæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼Œä¾‹å¦‚ <code>Promise</code>  <code>process.nextTick</code> ç­‰æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´å½“ <code>setInterval(fn, 1000)</code> ç­‰å¾… <code>1</code> ç§’é’Ÿåï¼Œ <code>fn</code> å‡½æ•°ä¼šè¢«æ’å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œä½†å¹¶ä¸ä¸€å®šä¼šç«‹åˆ»æ‰§è¡Œï¼Œè¿˜éœ€è¦ç­‰å¾…å½“å‰ä»»åŠ¡ä»¥åŠå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œã€‚é•¿æ­¤ä»¥å¾€ï¼Œä½¿ç”¨ <code>setInterval</code> çš„è®¡æ—¶å™¨è¶…æ—¶å°†è¶Šæ¥è¶Šä¸¥é‡ã€‚</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'console.log()'</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setTimeOut'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'promise1'</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'promise2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [milliSecs, setmilliSecs] = useState(remainingTime);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> startCountDown = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    milliSecs -= <span class="number">1000</span>;</span><br><span class="line">    setmilliSecs(milliSecs);</span><br><span class="line">    <span class="keyword">if</span> (milliSecs &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">        <span class="keyword">await</span> updateInitialData();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    timer = setInterval(startCountDown, <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>é¡¹ç›®ç»å†</category>
      </categories>
      <tags>
        <tag>é¡¹ç›®ç»å†</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»é›¶å®ç°ä¸€ä¸ªæ»šåŠ¨å¹¿å‘Š</title>
    <url>/2020/02/14/%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%BB%9A%E5%8A%A8%E5%B9%BF%E5%91%8A/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>é¡¹ç›®ç»å†</category>
      </categories>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼</title>
    <url>/2020/02/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<h2 id="JavaScriptæ¨¡å¼"><a href="#JavaScriptæ¨¡å¼" class="headerlink" title="JavaScriptæ¨¡å¼"></a>JavaScriptæ¨¡å¼</h2><a id="more"></a>
<h3 id="å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"><a href="#å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰" class="headerlink" title="å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"></a>å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰</h3><p>è¦æ±‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> uni = <span class="keyword">new</span> Universe()</span><br><span class="line"><span class="keyword">var</span> uni2 = <span class="keyword">new</span> Universe()</span><br><span class="line">uni === uni2</span><br></pre></td></tr></table></figure>

<p>å®ç°<br><strong>é™æ€å±æ€§ä¸­çš„å®ä¾‹</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Universe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> Universe.instance === <span class="string">"object"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> Universe.instance</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.start_time = <span class="number">0</span></span><br><span class="line">    <span class="keyword">this</span>.bang = <span class="string">"Big"</span></span><br><span class="line">    Universe.instance = <span class="keyword">this</span></span><br><span class="line">    <span class="comment">// éšè—è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼ºç‚¹ï¼šinstanceå±æ€§æ˜¯å…¬å¼€çš„ã€‚</p>
<p><strong>é—­åŒ…ä¸­çš„å®ä¾‹</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Universe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> instance;</span><br><span class="line">    Universe = <span class="function"><span class="keyword">function</span> <span class="title">Universe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    &#125;</span><br><span class="line">    Universe.prototype = <span class="keyword">this</span></span><br><span class="line">    instance = <span class="keyword">new</span> Universe()</span><br><span class="line">    instance.constructor = Universe</span><br><span class="line">    instance.start_time = <span class="number">0</span></span><br><span class="line">    instance.bang = <span class="string">"Big"</span></span><br><span class="line">    <span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ„é€ å‡½æ•°å’Œå®ä¾‹åŒ…è£…åœ¨å³æ—¶å‡½æ•°ä¸­</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Universe(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> instance</span><br><span class="line">    Universe = <span class="function"><span class="keyword">function</span> <span class="title">Universe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance</span><br><span class="line">        &#125;</span><br><span class="line">        instance = <span class="keyword">this</span></span><br><span class="line">        <span class="keyword">this</span>.start_time = <span class="number">0</span></span><br><span class="line">        <span class="keyword">this</span>.bang = <span class="string">"Big"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CarMaker</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">CarMaker.prototype.drive = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Vroom, I have "</span> + <span class="keyword">this</span>.doors + <span class="string">" doors"</span></span><br><span class="line">&#125;</span><br><span class="line">CarMaker.factory = <span class="function"><span class="keyword">function</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> constr = type,</span><br><span class="line">        newcar;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> CarMaker[constr] !== <span class="string">"function"</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> &#123;</span><br><span class="line">            name: <span class="string">"Error"</span>,</span><br><span class="line">            message: constr + <span class="string">" doesn't exist"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> CarMaker[constr].prototype.drive !== <span class="string">"function"</span>) &#123;</span><br><span class="line">        CarMaker[constr].prototype = <span class="keyword">new</span> CarMaker()</span><br><span class="line">    &#125;</span><br><span class="line">    newcar = <span class="keyword">new</span> CarMaker[constr]()</span><br><span class="line">    <span class="keyword">return</span> newcar</span><br><span class="line">&#125;</span><br><span class="line">CarMaker.Compact = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.doors = <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line">CarMaker.Convertible = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.doors = <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">CarMaker.SUV = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.doors = <span class="number">24</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> corolla = CarMaker.factory(<span class="string">'Compact'</span>)</span><br><span class="line"><span class="keyword">var</span> solstice = CarMaker.factory(<span class="string">'Convertible'</span>)</span><br><span class="line"><span class="keyword">var</span> cherokee = CarMaker.factory(<span class="string">'SUV'</span>)</span><br><span class="line">corolla.drive()</span><br><span class="line">solstice.drive()</span><br><span class="line">cherokee.drive()</span><br></pre></td></tr></table></figure>

<h3 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> agg = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>,</span><br><span class="line">        data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">        length = data.length;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        next: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> element;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">this</span>.hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">            element = data[index]</span><br><span class="line">            index = index + <span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> element</span><br><span class="line">        &#125;,</span><br><span class="line">        hasNext: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> index &lt; length</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>

<h3 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h3><blockquote>
<p>å®ç°è£…é¥°è€…æ¨¡å¼çš„å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä½¿å¾—æ¯ä¸ªè£…é¥°åˆ™æˆä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡åŒ…å«äº†åº”è¯¥è¢«é‡è½½çš„æ–¹æ³•ã€‚</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sale = <span class="keyword">new</span> Sale(<span class="number">100</span>)</span><br><span class="line">sale = sale.decorate(<span class="string">'fedtax'</span>)</span><br><span class="line">sale = sale.decorate(<span class="string">'quebec'</span>)</span><br><span class="line">sale = sale.decorate(<span class="string">'money'</span>)</span><br><span class="line">sale.getPrice()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sale</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.price = price || <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line">Sale.prototype.getPrice = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.price</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators = &#123;&#125;</span><br><span class="line"></span><br><span class="line">Sale.decorators.fedtax = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> price = <span class="keyword">this</span>.uber.getPrice()</span><br><span class="line">    price += price * <span class="number">5</span> / <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> price</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.quebec = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> price = <span class="keyword">this</span>.uber.getPrice()</span><br><span class="line">    price += price * <span class="number">7.5</span> / <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> price</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Sale.decorators.money = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"$"</span> + <span class="keyword">this</span>.uber.getPrice().toFixed(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.cdn = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"CDN$ "</span> + <span class="keyword">this</span>.uber.getPrice().toFixed(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sale.prototype.decorate = <span class="function"><span class="keyword">function</span> (<span class="params">decorator</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;,</span><br><span class="line">    overrides = <span class="keyword">this</span>.constructor.decorators[decorator],</span><br><span class="line">    i, newobj</span><br><span class="line">  F.prototype = <span class="keyword">this</span></span><br><span class="line">  newobj = <span class="keyword">new</span> F()</span><br><span class="line">  newobj.uber = F.prototype</span><br><span class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> overrides) &#123;</span><br><span class="line">    <span class="keyword">if</span> (overrides.hasOwnProperty(i)) &#123;</span><br><span class="line">      newobj[i] = overrides[i]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newobj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨åˆ—è¡¨å®ç°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sale = <span class="keyword">new</span> Sale(<span class="number">100</span>)</span><br><span class="line">sale.decorate(<span class="string">'fedtax'</span>)</span><br><span class="line">sale.decorate(<span class="string">'quebec'</span>)</span><br><span class="line">sale.decorate(<span class="string">'money'</span>)</span><br><span class="line">sale.getPrice()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sale</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.price = (price &gt; <span class="number">0</span>) || <span class="number">100</span></span><br><span class="line">  <span class="keyword">this</span>.decorators_list = []</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators = &#123;&#125;</span><br><span class="line"></span><br><span class="line">Sale.decorators.fedtax = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params">pirce</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> price + price * <span class="number">5</span> / <span class="number">100</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.quebec = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> price + price * <span class="number">7.5</span> / <span class="number">100</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sale.decorators.money = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"$"</span> + price.toFixed(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.cdn = &#123;</span><br><span class="line">  getPrice: <span class="function"><span class="keyword">function</span> (<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"CDN$ "</span> + price.toFixed(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sale.prototype.decorate = <span class="function"><span class="keyword">function</span> (<span class="params">decorator</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.decorators_list.push(decorator)</span><br><span class="line">&#125;</span><br><span class="line">Sale.prototype.getPrice = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> price = <span class="keyword">this</span>.price,</span><br><span class="line">    i, max = <span class="keyword">this</span>.decorators_list.length,</span><br><span class="line">    name;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; max; i += <span class="number">1</span>) &#123;</span><br><span class="line">    name = <span class="keyword">this</span>.decorators_list[i]</span><br><span class="line">    price = Sale.decorators[name].getPrice(price)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> price</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">varlidator.config = &#123;</span><br><span class="line">  first_name: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">  age: <span class="string">'isNumber'</span>,</span><br><span class="line">  username: <span class="string">'isAlphaNum'</span></span><br><span class="line">&#125;</span><br><span class="line">varlidator.validate(data)</span><br><span class="line"><span class="keyword">if</span> (varlidator.hasErrors()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(varlidator.messages.join(<span class="string">'\n'</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">varlidator.types.inNonEmpty = &#123;</span><br><span class="line">  validate: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value !== <span class="string">""</span></span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: <span class="string">"the value cannot be empty"</span></span><br><span class="line">&#125;</span><br><span class="line">varlidator.types.isNumber = &#123;</span><br><span class="line">  validate: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="built_in">isNaN</span>(value)</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: <span class="string">"the value can only be a valid number"</span></span><br><span class="line">&#125;</span><br><span class="line">varlidator.types.isAlphaNum = &#123;</span><br><span class="line">  validate: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="regexp">/[^a-z0-9]/i</span>.test(value)</span><br><span class="line">  &#125;,</span><br><span class="line">  instructions: <span class="string">"the value can only contain characters and numbers,no special symbols"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> varlidator = &#123;</span><br><span class="line">  types: &#123;&#125;,</span><br><span class="line">  messages: [],</span><br><span class="line">  config: &#123;&#125;,</span><br><span class="line">  validate: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i, msg, type, checker, result_ok</span><br><span class="line">    <span class="keyword">this</span>.messages = []</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> data) &#123;</span><br><span class="line">      <span class="keyword">if</span> (data.hasOwnProperty(i)) &#123;</span><br><span class="line">        type = <span class="keyword">this</span>.config[i]</span><br><span class="line">        checker = <span class="keyword">this</span>.types[type]</span><br><span class="line">        <span class="keyword">if</span> (!type) &#123;</span><br><span class="line">          <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!checker) &#123;</span><br><span class="line">          <span class="keyword">throw</span> &#123;</span><br><span class="line">            name: <span class="string">"ValidationError"</span>,</span><br><span class="line">            message: <span class="string">"No handler to validate type "</span> + type</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        result_ok = checker.validate(data[i])</span><br><span class="line">        <span class="keyword">if</span> (!result_ok) &#123;</span><br><span class="line">          msg = <span class="string">"Invalid value for "</span> + i + <span class="string">"*, "</span> + checker.instructions</span><br><span class="line">          <span class="keyword">this</span>.messages.push(msg)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.hasErrors()</span><br><span class="line">  &#125;,</span><br><span class="line">  hasErrors: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.messages.length !== <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>å…³äº this</title>
    <url>/2020/02/25/%E5%85%B3%E4%BA%8E-this/</url>
    <content><![CDATA[<p>JavaScriptä¸­æ‰€æœ‰çš„å‡½æ•°éƒ½æ˜¯å¯¹è±¡ï¼ŸğŸ¤”è¿™å¥è¯è¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿ<br>ä¸‹é¢ä¾‹å­ä¸­çš„å‡½æ•° foo å’Œå¯¹è±¡ foo æŒ‡ä»£çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ </p>
<a id="more"></a>


<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(&#123;num&#125;)</span><br><span class="line">    foo.count++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo.count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">5</span>) &#123;</span><br><span class="line">        foo(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(foo.count)</span><br></pre></td></tr></table></figure>

<p>forEachã€mapã€filter ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šå›è°ƒå‡½æ•°çš„ this</p>
<p>å¦‚æœæŠŠ null æˆ–è€… undefined ä½œä¸º this çš„ç»‘å®šå¯¹è±¡ä¼ å…¥ callã€apply æˆ–è€… bindï¼Œè¿™äº›å€¼<br>åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®é™…åº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ã€‚<br>é‚£ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¼ å…¥ null å‘¢ï¼Ÿ<br>ğŸ‘‡å±•å¼€æ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"a: "</span> + a + <span class="string">"b: "</span>+ b)</span><br><span class="line">&#125;</span><br><span class="line">foo.apply(<span class="literal">null</span>,[<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"a: "</span> + a + <span class="string">",b: "</span>+ b)</span><br><span class="line">&#125;</span><br><span class="line">foo(...[<span class="number">1</span>,<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<p>â¤ï¸ bind å¯ä»¥å¯¹å‚æ•°è¿›è¡ŒæŸ¯é‡ŒåŒ–</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"a: "</span> + a + <span class="string">",b: "</span>+ b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> bar = foo.bind(<span class="literal">null</span>,<span class="number">2</span>)</span><br><span class="line">bar(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>bind ç®€æ˜“å®ç°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// TODO</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">fn,obj</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fn.apply(obj,<span class="built_in">arguments</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Object.create(null) å’Œ ç©ºå¯¹è±¡ä¸€æ ·å—â“</p>
<p>Object.create(null) åˆ›å»ºäº†ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½†æ˜¯å®ƒæ¯”{}æ›´ç©ºï¼Œä»–ä¸ä¼šåˆ›å»º Object.prototype è¿™ä¸ªå§”æ‰˜</p>
<p>ç®­å¤´å‡½æ•°æ ¹æ®å¤–å±‚çš„ä½œç”¨åŸŸæ¥å†³å®š this</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">    &#125;,<span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a:<span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo.apply(obj)</span><br></pre></td></tr></table></figure>


<p>åŒç®­å¤´å‡½æ•°ä¸€æ ·çš„æ¨¡å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(self.a)</span><br><span class="line">    &#125;,<span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo.apply(obj)</span><br></pre></td></tr></table></figure>

<p>setTimeoutä¸­çš„functionæ˜¯ä¸ªå›è°ƒå‡½æ•°ï¼Œæœ¬è´¨ä¸Šä¸åŒ…è£¹å¥¹çš„fooå‡½æ•°æ²¡æœ‰å…³ç³»ã€‚</p>
<p>this æ˜¯åœ¨è¿è¡Œæ—¶ï¼ŒåŸºäºå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒç»‘å®šçš„</p>
]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <url>/2020/01/17/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<h2 id="æ­£åˆ™åŒ¹é…è¯­æ³•æ±‡æ€»"><a href="#æ­£åˆ™åŒ¹é…è¯­æ³•æ±‡æ€»" class="headerlink" title="æ­£åˆ™åŒ¹é…è¯­æ³•æ±‡æ€»"></a>æ­£åˆ™åŒ¹é…è¯­æ³•æ±‡æ€»</h2><table>
<thead>
<tr>
<th>æ­£åˆ™åŒ¹é…</th>
<th>è¯­æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>regex.test(str)</td>
<td>è¿”å›Booleanå€¼</td>
</tr>
<tr>
<td>str.match(regex)</td>
<td>è¿”å› ç”±åŒ¹é…å†…å®¹ç»„æˆçš„æ•°ç»„</td>
</tr>
<tr>
<td>regex.exec(str)</td>
<td>è¿”å›æ•°ç»„  [åŒ¹é…å†…å®¹ï¼Œindex, input, group]</td>
</tr>
<tr>
<td>str.search(regex)</td>
<td>è¿”å›ç¬¬ä¸€æ¬¡åŒ¹é…regexçš„ä½ç½®</td>
</tr>
<tr>
<td>str.split(regex)</td>
<td>è¿”å›æŒ‰regexåˆ†å‰²çš„æ•°ç»„</td>
</tr>
<tr>
<td>str.replace(regex, callback)</td>
<td>å¯¹åŒ¹é…çš„å†…å®¹è¿›è¡Œcallbackæ›¿æ¢</td>
</tr>
</tbody></table>
<a id="more"></a>
<p> å…ƒå­—ç¬¦          | æè¿°                                   |<br>|â€”â€”â€”â€”â€”â€”-|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“|<br>| \w   | åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦                          |<br>| \s  | åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº[ \f\n\r\t\v]ã€‚               |</p>
<h3 id="å°†çŸ­åˆ’çº¿è½¬æ¢é©¼å³°"><a href="#å°†çŸ­åˆ’çº¿è½¬æ¢é©¼å³°" class="headerlink" title="å°†çŸ­åˆ’çº¿è½¬æ¢é©¼å³°"></a>å°†çŸ­åˆ’çº¿è½¬æ¢é©¼å³°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s1 = <span class="string">"get-element-by-id"</span></span><br><span class="line"><span class="keyword">const</span> s2 = s1.replace(<span class="regexp">/-\w/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.slice(<span class="number">1</span>).toUpperCase()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ•°å­—"><a href="#å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ•°å­—" class="headerlink" title="å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ•°å­—"></a>å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æ•°å­—</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">containNumber</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> regex = <span class="regexp">/\d/</span></span><br><span class="line">    <span class="keyword">return</span> regex.test(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç”µè¯å·ç "><a href="#ç”µè¯å·ç " class="headerlink" title="ç”µè¯å·ç "></a>ç”µè¯å·ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^1[34578]\d&#123;9&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="æ˜¯å¦ä¸ºæ ¼å¼-XXX-XXX-XXXX"><a href="#æ˜¯å¦ä¸ºæ ¼å¼-XXX-XXX-XXXX" class="headerlink" title="æ˜¯å¦ä¸ºæ ¼å¼ XXX-XXX-XXXX"></a>æ˜¯å¦ä¸ºæ ¼å¼ XXX-XXX-XXXX</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^(\d&#123;3&#125;-)&#123;2&#125;\d&#123;4&#125;$/</span></span><br></pre></td></tr></table></figure>

<h3 id="æ˜¯å¦ç¬¦åˆUSDæ ¼å¼"><a href="#æ˜¯å¦ç¬¦åˆUSDæ ¼å¼" class="headerlink" title="æ˜¯å¦ç¬¦åˆUSDæ ¼å¼"></a>æ˜¯å¦ç¬¦åˆUSDæ ¼å¼</h3><ol>
<li>ä»¥ $ å¼€å§‹</li>
<li>æ•´æ•°éƒ¨åˆ†ï¼Œä»ä¸ªä½èµ·ï¼Œæ»¡ 3 ä¸ªæ•°å­—ç”¨ , åˆ†éš”</li>
<li>å¦‚æœä¸ºå°æ•°ï¼Œåˆ™å°æ•°éƒ¨åˆ†é•¿åº¦ä¸º 2</li>
<li>æ­£ç¡®çš„æ ¼å¼å¦‚ï¼š$1,023,032.03 æˆ–è€… $2.03ï¼Œé”™è¯¯çš„æ ¼å¼å¦‚ï¼š$3,432,12.12 æˆ–è€… $34,344.3**</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/^\$\d&#123;1,3&#125;(,\d&#123;3&#125;)*(\.\d&#123;2&#125;)?$/</span></span><br></pre></td></tr></table></figure>

<h3 id="å®ç°åƒä½åˆ†éš”ç¬¦"><a href="#å®ç°åƒä½åˆ†éš”ç¬¦" class="headerlink" title="å®ç°åƒä½åˆ†éš”ç¬¦"></a><strong>å®ç°åƒä½åˆ†éš”ç¬¦</strong></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">format</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> regx = <span class="regexp">/\d&#123;1,3&#125;(?=(\d&#123;3&#125;)+$)/g</span>;</span><br><span class="line">    <span class="keyword">return</span> (number + <span class="string">''</span>).replace(regx, <span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        $mdFormatter$5$mdFormatter$</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        , '</span>)  <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">        $mdFormatter$<span class="number">5</span>$mdFormatter$</span><br><span class="line"></span><br><span class="line">        è¡¨ç¤ºä¸regxç›¸åŒ¹é…çš„å­—ç¬¦ä¸²</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="è·å–urlä¸­å‚æ•°"><a href="#è·å–urlä¸­å‚æ•°" class="headerlink" title="è·å–urlä¸­å‚æ•°"></a><strong>è·å–urlä¸­å‚æ•°</strong></h3><ol>
<li>æŒ‡å®šå‚æ•°åç§°ï¼Œè¿”å›è¯¥å‚æ•°çš„å€¼ æˆ–è€… ç©ºå­—ç¬¦ä¸²</li>
<li>ä¸æŒ‡å®šå‚æ•°åç§°ï¼Œè¿”å›å…¨éƒ¨çš„å‚æ•°å¯¹è±¡ æˆ–è€… {}</li>
<li>å¦‚æœå­˜åœ¨å¤šä¸ªåŒåå‚æ•°ï¼Œåˆ™è¿”å›æ•°ç»„</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUrlParam</span>(<span class="params">url, key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = &#123;&#125;;</span><br><span class="line">    url.replace(<span class="regexp">/\??(\w+)=(\w+)&amp;?/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">match, matchKey, matchValue</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!arr[matchKey]) &#123;</span><br><span class="line">            arr[matchKey] = matchValue;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> temp = arr[matchKey];</span><br><span class="line">            arr[matchKey] = [].concat(temp, matchValue);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (!key) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (ele <span class="keyword">in</span> arr) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ele = key) &#123;</span><br><span class="line">                <span class="keyword">return</span> arr[ele];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="éªŒè¯é‚®ç®±"><a href="#éªŒè¯é‚®ç®±" class="headerlink" title="éªŒè¯é‚®ç®±"></a>éªŒè¯é‚®ç®±</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> email = <span class="regexp">/^[0-9A-Za-z_\-]+\@[0-9A-Za-z_\-]+\.[0-9A-Za-z_\-]+$/</span></span><br></pre></td></tr></table></figure>

<h3 id="èº«ä»½è¯å·ç "><a href="#èº«ä»½è¯å·ç " class="headerlink" title="èº«ä»½è¯å·ç "></a>èº«ä»½è¯å·ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> idCard = <span class="regexp">/(^\d&#123;15&#125;$)|(^\d&#123;18&#125;$)|(^\d&#123;17&#125;(\d|X|x)$)/</span></span><br></pre></td></tr></table></figure>

<h3 id="æ±‰å­—"><a href="#æ±‰å­—" class="headerlink" title="æ±‰å­—"></a>æ±‰å­—</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> text = <span class="regexp">/^[\u4e00-\u9fa5]&#123;0,&#125;$/</span></span><br></pre></td></tr></table></figure>

<h3 id="å»é™¤é¦–å°¾"><a href="#å»é™¤é¦–å°¾" class="headerlink" title="å»é™¤é¦–å°¾/"></a>å»é™¤é¦–å°¾/</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'/asdf//'</span>;</span><br><span class="line">str = str.replace(<span class="regexp">/^\/*|\/*$/g</span>, <span class="string">''</span>);</span><br></pre></td></tr></table></figure>

<h3 id="2017-05-11-æ ¼å¼æ—¥æœŸ"><a href="#2017-05-11-æ ¼å¼æ—¥æœŸ" class="headerlink" title="2017-05-11 æ ¼å¼æ—¥æœŸ"></a>2017-05-11 æ ¼å¼æ—¥æœŸ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> date = <span class="regexp">/^\d&#123;4&#125;\-\d&#123;2&#125;\-\d&#123;2&#125;$/</span></span><br></pre></td></tr></table></figure>

<h3 id="16è¿›åˆ¶é¢œè‰²æ­£åˆ™"><a href="#16è¿›åˆ¶é¢œè‰²æ­£åˆ™" class="headerlink" title="16è¿›åˆ¶é¢œè‰²æ­£åˆ™"></a>16è¿›åˆ¶é¢œè‰²æ­£åˆ™</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> color = <span class="regexp">/^#([a-zA-Z0-9]&#123;6&#125;|[a-zA-Z0-9]&#123;3&#125;)$/</span></span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### **HTMLæ ‡ç­¾**</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span> js</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"&lt;p&gt;dasdsa&lt;/p&gt;nice &lt;br&gt; test&lt;/br&gt;"</span></span><br><span class="line"><span class="keyword">var</span> regx = <span class="regexp">/&lt;[^&lt;&gt;]+&gt;/g</span>;</span><br><span class="line">str = str.replace(regx, <span class="string">''</span>);</span><br></pre></td></tr></table></figure>

<h3 id="å¯†ç å¼ºåº¦æ­£åˆ™"><a href="#å¯†ç å¼ºåº¦æ­£åˆ™" class="headerlink" title="å¯†ç å¼ºåº¦æ­£åˆ™"></a>å¯†ç å¼ºåº¦æ­£åˆ™</h3><ol>
<li>æœ€å°‘6ä½</li>
<li>åŒ…æ‹¬è‡³å°‘1ä¸ªå¤§å†™å­—æ¯</li>
<li>1ä¸ªå°å†™å­—æ¯</li>
<li>1ä¸ªæ•°å­—</li>
<li>1ä¸ªç‰¹æ®Šå­—ç¬¦</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> regx = <span class="regexp">/^.*(?=.&#123;6,&#125;)(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&amp;*? ]).*$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="url"><a href="#url" class="headerlink" title="url"></a>url</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> regx = <span class="regexp">/^((https?|ftp|file):\/\/)?([\da-z\.-]+)\.([a-z\.]&#123;2,6&#125;)([\/\w \.-]*)*\/?$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="lt-OPTION-value-â€å¾…å¤„ç†â€-gt-å¾…å¤„ç†-lt-OPTION-gt"><a href="#lt-OPTION-value-â€å¾…å¤„ç†â€-gt-å¾…å¤„ç†-lt-OPTION-gt" class="headerlink" title="&lt;OPTION value=â€å¾…å¤„ç†â€&gt;å¾…å¤„ç†&lt;/OPTION&gt;"></a>&lt;OPTION value=â€å¾…å¤„ç†â€&gt;å¾…å¤„ç†&lt;/OPTION&gt;</h3><p>å¤„ç†æˆ &lt;OPTION value=â€å¾…å¤„ç†â€&gt;</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> regx = <span class="regexp">/^&lt;.*?&gt;/</span>;</span><br><span class="line"><span class="keyword">var</span> resiult = regx.exec(str)[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>

<h3 id="è·å–æŸ¥è¯¢å­—ç¬¦ä¸²"><a href="#è·å–æŸ¥è¯¢å­—ç¬¦ä¸²" class="headerlink" title="è·å–æŸ¥è¯¢å­—ç¬¦ä¸²"></a>è·å–æŸ¥è¯¢å­—ç¬¦ä¸²</h3><p>function getQuery(name){var reg=new RegExp(â€œ(^|&amp;)â€+name+â€=([^&amp;]*(&amp;|$)â€); var r=window.location.search.substr(1).match(reg); if(r!=null) return unescape(r[2]); return null; }</p>
]]></content>
  </entry>
  <entry>
    <title>ES6</title>
    <url>/2020/01/01/ES6/</url>
    <content><![CDATA[<p>æœ¬æ–‡å¯¹ES6çŸ¥è¯†ç‚¹è¿›è¡Œæ•´ç†</p>
<a id="more"></a>

<h3 id="ç¬¬äºŒç« "><a href="#ç¬¬äºŒç« " class="headerlink" title="ç¬¬äºŒç« "></a>ç¬¬äºŒç« </h3><h4 id="let"><a href="#let" class="headerlink" title="let"></a>let</h4><blockquote>
<p>let æ‰€å£°æ˜çš„å˜é‡åªåœ¨ let å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—ä¸­æœ‰æ•ˆã€‚</p>
</blockquote>
<p>ğŸ¤”å¦‚ä¸‹ä»£ç å—ï¼Œæœ€ç»ˆè¾“å‡º10ã€‚å¦‚æœ var æ”¹æˆ letï¼Œè¾“å‡º6ã€‚<br>åŸå› ï¼švar å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆï¼Œæ‰€ä»¥ï¼Œæ¯å¾ªç¯ä¸€æ¬¡ï¼Œæ–°çš„iå€¼éƒ½ä¼šè¦†ç›–æ—§çš„iå€¼ï¼Œå¯¼è‡´ï¼Œæœ€åè¾“å‡ºçš„æ˜¯æ—§çš„iå€¼ã€‚<br>è€Œ let å£°æ˜çš„ï¼Œå½“å‰çš„ i å€¼åªåœ¨æœ¬è½®å¾ªç¯å†…æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯çš„ i å…¶å®éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ã€‚<br>ğŸ¤”è€Œä¸”ï¼Œå½“è¿è¡Œç»“æŸä¹‹å, var å£°æ˜çš„ i ä¼šæ³„æ¼ä¸ºå…¨å±€å˜é‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = []</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    a[i] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">6</span>]()</span><br></pre></td></tr></table></figure>

<p>ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>let ä¸å­˜åœ¨å˜é‡æå‡</strong></li>
<li><strong>æš‚æ—¶æ€§æ­»åŒº</strong></li>
<li><strong>ä¸å…è®¸é‡å¤å£°æ˜</strong></li>
</ul>
<h4 id="const"><a href="#const" class="headerlink" title="const"></a>const</h4><blockquote>
<p>const å˜é‡åªæ˜¯ä¿è¯å˜é‡åæŒ‡å‘çš„åœ°å€ä¸å˜ï¼Œå¹¶ä¸ä¿è¯è¯¥åœ°å€çš„æ•°æ®ä¸å˜</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = []</span><br><span class="line">a.c = <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>ğŸ§å¦‚æœçœŸçš„æƒ³å†»ç»“å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ Object.freeze</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> b = <span class="built_in">Object</span>.freeze(&#123;&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬ä¸‰ç« -è§£æ„èµ‹å€¼"><a href="#ç¬¬ä¸‰ç« -è§£æ„èµ‹å€¼" class="headerlink" title="ç¬¬ä¸‰ç«  è§£æ„èµ‹å€¼"></a>ç¬¬ä¸‰ç«  è§£æ„èµ‹å€¼</h3><p>å¯¹äº Set ç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b, c] = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>])</span><br></pre></td></tr></table></figure>

<p>åªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰ Iterator æ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fibs</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> b = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">yield</span> a;</span><br><span class="line">        [a, b] = [b, a + b]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> [one, two, three, four, five, six] = fibs()</span><br></pre></td></tr></table></figure>

<h4 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h4><blockquote>
<p>è§£æ„å‡½æ•°å…è®¸æŒ‡å®šé»˜è®¤å€¼</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> [a = <span class="number">3</span>] = []</span><br><span class="line"><span class="comment">// a = 3</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœé»˜è®¤å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ã€‚åªæœ‰å½“å€¼æ˜¯ undefined çš„æ—¶å€™ï¼Œæ‰ä¼šå»æ±‚å€¼ã€‚</p>
<h4 id="å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>å¯¹è±¡çš„è§£æ„èµ‹å€¼</h4><blockquote>
<p>å¯¹è±¡è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹å€¼ç»™å¯¹åº”å˜é‡</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123;</span><br><span class="line">    foo: baz,</span><br><span class="line">    bar</span><br><span class="line">&#125; = &#123;</span><br><span class="line">    foo: <span class="string">"aaa"</span>,</span><br><span class="line">    bar: <span class="string">"bbb"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹è±¡çš„è§£æ„èµ‹å€¼å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚å¦‚æœè§£æ„å¤±è´¥ï¼Œå˜é‡çš„å€¼ç­‰äº undefined</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;</span><br><span class="line">    x = <span class="number">3</span></span><br><span class="line">&#125; = &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"><a href="#å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼" class="headerlink" title="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"></a>å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span></span><br></pre></td></tr></table></figure>

<p>ğŸ§ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ length å±æ€§ï¼Œå› æ­¤å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">    length: len</span><br><span class="line">&#125; = <span class="string">'hello'</span></span><br><span class="line">len <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<h4 id="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"><a href="#æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"></a>æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼</h4><blockquote>
<p>è§£æ„èµ‹å€¼æ—¶ï¼Œå¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼æˆ–è€…å¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚ç”±äº undefined å’Œ null éƒ½æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹ä»–ä»¬è¿›è¡Œè§£æ„èµ‹å€¼ä¼šæŠ¥é”™ã€‚</p>
</blockquote>
<p>ğŸ‘‡æ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡éƒ½æœ‰toStringå±æ€§</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; <span class="attr">toString</span>: s &#125; = <span class="number">123</span></span><br><span class="line">s === <span class="built_in">Number</span>.prototype.toString</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">toString</span>: s &#125; = <span class="literal">true</span></span><br><span class="line">s === <span class="built_in">Boolean</span>.prototype.toString</span><br></pre></td></tr></table></figure>

<h4 id="éå†-map-ç»“æ„"><a href="#éå†-map-ç»“æ„" class="headerlink" title="éå† map ç»“æ„"></a>éå† map ç»“æ„</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">map.set(<span class="string">"first"</span>, <span class="string">"hello"</span>)</span><br><span class="line">map.set(<span class="string">"second"</span>, <span class="string">"world"</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key + <span class="string">" , "</span> + value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬å››ç« -å­—ç¬¦ä¸²çš„æ‰©å±•"><a href="#ç¬¬å››ç« -å­—ç¬¦ä¸²çš„æ‰©å±•" class="headerlink" title="ç¬¬å››ç«  å­—ç¬¦ä¸²çš„æ‰©å±•"></a>ç¬¬å››ç«  å­—ç¬¦ä¸²çš„æ‰©å±•</h3><ul>
<li>includes  </li>
<li>startsWith</li>
<li>endsWith</li>
<li>repeat</li>
<li>padStart</li>
<li>padEnd</li>
</ul>
<h3 id="ç¬¬å…­ç« -æ•°å€¼çš„æ‰©å±•"><a href="#ç¬¬å…­ç« -æ•°å€¼çš„æ‰©å±•" class="headerlink" title="ç¬¬å…­ç«  æ•°å€¼çš„æ‰©å±•"></a>ç¬¬å…­ç«  æ•°å€¼çš„æ‰©å±•</h3><ul>
<li>Number.isFinite</li>
<li>Number.isNaN</li>
<li>Number.parseInt</li>
<li>Number.parseFloat</li>
<li>Number.isInteger</li>
<li>Number.EPSILON</li>
<li>Number.isSafeInteger JavaScriptèƒ½å‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨ -2^53 ~ 2^53 ä¹‹é—´</li>
<li>Number.MAX_SAFE_INTEGER</li>
<li>Number.MIN_SAFE_INTEGER</li>
<li>Math.trunc è¿”å›æ•´æ•°éƒ¨åˆ†</li>
<li>Math.sign  åˆ¤æ–­æ­£è´Ÿ</li>
<li>** æŒ‡æ•°è¿ç®—ç¬¦ a ** b = a^b</li>
</ul>
<h3 id="ç¬¬ä¸ƒç« -æ•°ç»„çš„æ‰©å±•"><a href="#ç¬¬ä¸ƒç« -æ•°ç»„çš„æ‰©å±•" class="headerlink" title="ç¬¬ä¸ƒç«  æ•°ç»„çš„æ‰©å±•"></a>ç¬¬ä¸ƒç«  æ•°ç»„çš„æ‰©å±•</h3><h4 id="Array-from-å°†ä¸¤ç±»å¯¹è±¡è½¬æ¢æˆæ•°ç»„ğŸ‘‡"><a href="#Array-from-å°†ä¸¤ç±»å¯¹è±¡è½¬æ¢æˆæ•°ç»„ğŸ‘‡" class="headerlink" title="Array.from å°†ä¸¤ç±»å¯¹è±¡è½¬æ¢æˆæ•°ç»„ğŸ‘‡"></a>Array.from å°†ä¸¤ç±»å¯¹è±¡è½¬æ¢æˆæ•°ç»„ğŸ‘‡</h4><ul>
<li>ç±»ä¼¼æ•°ç»„å¯¹è±¡ (æœ¬è´¨ä¸Šï¼šå¿…é¡»æœ‰ length å±æ€§)</li>
<li>å¯éå†å¯¹è±¡</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line">  <span class="number">0</span>: <span class="string">"a"</span>,</span><br><span class="line">  <span class="number">1</span>: <span class="string">"b"</span>,</span><br><span class="line">  <span class="number">2</span>: <span class="string">"c"</span>,</span><br><span class="line">  length: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr1 = [].slice.call(arrayLike) <span class="comment">// ES5</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(arrayLike)  <span class="comment">// ES6</span></span><br><span class="line"><span class="built_in">console</span>.log(arr1, arr2)</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‰æ‰©å±•è¿ç®—ç¬¦ä¹Ÿå¯å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„</p>
<blockquote>
<p>æ‰©å±•è¿ç®—ç¬¦è°ƒç”¨çš„æ˜¯éå†å™¨æ¥å£ Symbol.iterator</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> args = [...arguments]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[...document.querySelectorAll(<span class="string">'div'</span>)]</span><br></pre></td></tr></table></figure>

<p>Array.from æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(arr, (x) =&gt; x * x)</span><br></pre></td></tr></table></figure>
<h4 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of"></a>Array.of</h4><blockquote>
<p>å°†ä¸€ç»„å€¼è½¬ä¸ºæ•°ç»„</p>
</blockquote>
<p><strong>Array</strong> åªæœ‰å½“å‚æ•°ä¸ªæ•°ä¸å°‘äº2ä¸ªï¼ŒArrayæ‰è¿”å›ç”±å‚æ•°ç»„æˆçš„æ–°æ•°ç»„ã€‚å‚æ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œä»£è¡¨çš„æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚ </p>
<h4 id="copyWithin-targetå¿…é¡»-startå¯é€‰-endå¯é€‰"><a href="#copyWithin-targetå¿…é¡»-startå¯é€‰-endå¯é€‰" class="headerlink" title="copyWithin(targetå¿…é¡»,startå¯é€‰,endå¯é€‰)"></a>copyWithin(targetå¿…é¡»,startå¯é€‰,endå¯é€‰)</h4><h4 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is"></a>Object.is</h4><p>åˆ¤æ–­ä¿©æ•°æ˜¯å¦ç›¸ç­‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.is(<span class="built_in">isNaN</span>, <span class="built_in">isNaN</span>) === <span class="literal">true</span></span><br><span class="line"><span class="built_in">Object</span>.is(<span class="number">-0</span>, +<span class="number">0</span>) === <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p><strong>indexOf å†…éƒ¨ä½¿ç”¨ ==== è¿›è¡Œåˆ¤æ–­</strong></p>
<h4 id="entries-keys-values"><a href="#entries-keys-values" class="headerlink" title="entries, keys, values"></a>entries, keys, values</h4><h4 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[<span class="literal">NaN</span>].includes(<span class="literal">NaN</span>) <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h4 id="has"><a href="#has" class="headerlink" title="has"></a>has</h4><p>Map çš„ has æ˜¯ç”¨æ¥æŸ¥æ‰¾é”®åçš„<br>Set çš„ has æ˜¯ç”¨æ¥æŸ¥æ‰¾é”®å€¼çš„</p>
<h4 id="æ•°ç»„çš„ç©ºä½"><a href="#æ•°ç»„çš„ç©ºä½" class="headerlink" title="æ•°ç»„çš„ç©ºä½"></a>æ•°ç»„çš„ç©ºä½</h4><blockquote>
<p>ç©ºä½è¡¨ç¤ºä¸å«ä»»ä½•å€¼ Array(3) </p>
</blockquote>
<p>Array.fromï¼Œæ‰©å±•è¿ç®—ç¬¦ï¼Œentriesï¼Œkeysï¼Œvalues ä¼šå°†ç©ºä½è½¬ä¸º undefined</p>
<h3 id="ç¬¬å…«ç« -å‡½æ•°çš„æ‰©å±•"><a href="#ç¬¬å…«ç« -å‡½æ•°çš„æ‰©å±•" class="headerlink" title="ç¬¬å…«ç«  å‡½æ•°çš„æ‰©å±•"></a>ç¬¬å…«ç«  å‡½æ•°çš„æ‰©å±•</h3><h4 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h4><p>ğŸ‘‡undefinedï¼Œå¦‚æœæŠŠåŒ¿åå‡½æ•°æ”¹æˆç®­å¤´å‡½æ•°ï¼Œè¿”å›42 </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.id)</span><br><span class="line">  &#125;, <span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line">foo.call(&#123; <span class="attr">id</span>: <span class="number">42</span> &#125;)</span><br></pre></td></tr></table></figure>

<h4 id="å°¾é€’å½’"><a href="#å°¾é€’å½’" class="headerlink" title="å°¾é€’å½’"></a>å°¾é€’å½’</h4><p>å°¾è°ƒç”¨å°±æ˜¯æŒ‡æŸä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ã€‚å°¾è°ƒç”¨ä¸ä¸€å®šå‡ºç°åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ã€‚<br>å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨è®°å½•â€ï¼Œåˆç§°â€œè°ƒç”¨å¸§â€ï¼ˆcall frameï¼‰ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨è®°å½•ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨è®°å½•ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨è®°å½•æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨è®°å½•æ ˆï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨è®°å½•ï¼Œå°±å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨æ ˆâ€ï¼ˆcall stackï¼‰ã€‚<br>å°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨è®°å½•å°±å¯ä»¥äº†ã€‚<br>é€’å½’éå¸¸è€—è´¹å†…å­˜ï¼Œå› ä¸ºéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨è®°å½•ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿâ€æ ˆæº¢å‡ºâ€é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚ä½†å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨è®°å½•ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šå‘ç”Ÿâ€æ ˆæº¢å‡ºâ€é”™è¯¯ã€‚</p>
<h3 id="ç¬¬ä¹ç« "><a href="#ç¬¬ä¹ç« " class="headerlink" title="ç¬¬ä¹ç« "></a>ç¬¬ä¹ç« </h3><h4 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign"></a>Object.assign</h4><blockquote>
<p>å°†æºå¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾å±æ€§èµ‹å€¼åˆ°ç›®æ ‡å¯¹è±¡ã€‚</p>
</blockquote>
<h3 id="ç¬¬14ç« -Iterator-å’Œ-forâ€¦-of-å¾ªç¯"><a href="#ç¬¬14ç« -Iterator-å’Œ-forâ€¦-of-å¾ªç¯" class="headerlink" title="ç¬¬14ç«  Iterator å’Œ forâ€¦ of å¾ªç¯"></a>ç¬¬14ç«  Iterator å’Œ forâ€¦ of å¾ªç¯</h3><p>éå†å™¨æ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ã€‚ä»»ä½•æ•°æ®ç»“æ„ï¼Œåªè¦éƒ¨ç½²Iteratoræ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œ</p>
<p><strong>Iteratoréå†è¿‡ç¨‹</strong></p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®</li>
<li>ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„nextæ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚</li>
<li>â€¦ </li>
</ul>
<p>æ¯ä¸€æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ï¼ˆè¿”å›ä¸€ä¸ªåŒ…å«valueå’Œdoneä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼‰</p>
<p>ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œåªè¦å…·æœ‰Symbol.iteratorå±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯å¯éå†çš„ï¼Œè°ƒç”¨Symbol.iteratoræ–¹æ³•ï¼Œå°±ä¼šå¾—åˆ°å½“å‰æ•°æ®æ¥å£é»˜è®¤çš„éå†å™¨ç”Ÿæˆå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="keyword">let</span> iter = arr[<span class="built_in">Symbol</span>.iterator]()</span><br><span class="line">iter.next()</span><br><span class="line">iter.next()</span><br><span class="line">iter.next()</span><br><span class="line">iter.next()</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆåœ¨æ„é€ å‡½æ•°çš„åŸå‹é“¾ä¸Šéƒ¨ç½²Symbol.iteratoræ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›éå†å™¨å¯¹è±¡iteratorï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„nextæ–¹æ³•ï¼Œåœ¨è¿”å›ä¸€ä¸ªå€¼çš„æ—¶å€™è‡ªåŠ¨æŠŠæŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªå®ä¾‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Obj</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = value</span><br><span class="line">    <span class="keyword">this</span>.next = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line">Obj.prototype[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> iterator = &#123;</span><br><span class="line">        next: next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> current = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (current) &#123;</span><br><span class="line">            <span class="keyword">var</span> value = current.value</span><br><span class="line">            <span class="keyword">var</span> done = current === <span class="literal">null</span></span><br><span class="line">            current = current.next</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                done: <span class="literal">false</span>,</span><br><span class="line">                value</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                done: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> iterator</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> one = <span class="keyword">new</span> Obj(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">var</span> two = <span class="keyword">new</span> Obj(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span> three = <span class="keyword">new</span> Obj(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">var</span> four = <span class="keyword">new</span> Obj(<span class="number">4</span>)</span><br><span class="line">one.next = two</span><br><span class="line">two.next = three</span><br><span class="line">three.next = four</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">of</span> one) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºå¯¹è±¡æ·»åŠ Iteratoræ¥å£</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    data: [<span class="string">'hello'</span>, <span class="string">'world'</span>],</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">        <span class="keyword">const</span> self = <span class="keyword">this</span></span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            next() &#123;</span><br><span class="line">                <span class="keyword">if</span> (index &lt; self.data.length) &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        value: self.data[index++],</span><br><span class="line">                        done: <span class="literal">false</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        value: <span class="literal">undefined</span>,</span><br><span class="line">                        done: <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼æ•°ç»„å¯¹è±¡è°ƒç”¨æ•°ç»„çš„Symbol.iteratoræ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> iterator = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="string">'a'</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="string">'b'</span>,</span><br><span class="line">    <span class="number">2</span>: <span class="string">'c'</span>,</span><br><span class="line">    <span class="number">3</span>: <span class="string">'d'</span>,</span><br><span class="line">    length: <span class="number">4</span>,</span><br><span class="line">    [<span class="built_in">Symbol</span>.iterator]: <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> iterm <span class="keyword">of</span> iterable) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ"><a href="#è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ" class="headerlink" title="è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ"></a>è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ</h4><p><strong>è§£æ„èµ‹å€¼</strong></p>
<p><strong>æ‰©å±•è¿ç®—ç¬¦</strong><br>åªè¦æŸä¸ªæ•°æ®ç»“æ„éƒ¨ç½²äº†Iteratoræ¥å£ï¼Œå°±å¯ä»¥å¯¹ä»–ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œè½¬æ¢ä¸ºæ•°ç»„</p>
<h4 id="å­—ç¬¦ä¸²çš„Iteratoræ¥å£"><a href="#å­—ç¬¦ä¸²çš„Iteratoræ¥å£" class="headerlink" title="å­—ç¬¦ä¸²çš„Iteratoræ¥å£"></a>å­—ç¬¦ä¸²çš„Iteratoræ¥å£</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> iterator = someString[<span class="built_in">Symbol</span>.iterator]()</span><br></pre></td></tr></table></figure>

<h4 id="iteratoræ¥å£ä¸generatorå‡½æ•°"><a href="#iteratoræ¥å£ä¸generatorå‡½æ•°" class="headerlink" title="iteratoræ¥å£ä¸generatorå‡½æ•°"></a>iteratoræ¥å£ä¸generatorå‡½æ•°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> myIterator = &#123;&#125;</span><br><span class="line">myIterator[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> c = [...myIterator]</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    *[<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'hello'</span>;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'world'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>javascript åŸæœ‰çš„forâ€¦ in å¾ªç¯ï¼Œåªèƒ½è·å¾—å¯¹è±¡çš„é”®åï¼Œä¸èƒ½ç›´æ¥è·å–é”®å€¼ï¼Œforâ€¦ of å¯ä»¥è·å–é”®å€¼</p>
<h3 id="ç¬¬16ç« -Promise-å¯¹è±¡"><a href="#ç¬¬16ç« -Promise-å¯¹è±¡" class="headerlink" title="ç¬¬16ç«  Promise å¯¹è±¡"></a>ç¬¬16ç«  Promise å¯¹è±¡</h3><blockquote>
<p>promise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥ä¼ é€’å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯</p>
</blockquote>
<ul>
<li>promise æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯resolveï¼Œreject</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="comment">/* å¼‚æ­¥æ“ä½œæˆåŠŸ*/</span> ) &#123;</span><br><span class="line">        resolve(value)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(error)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>promiseå®ä¾‹ç”Ÿæˆä¹‹åï¼Œå¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šresolvedå’ŒrejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// failue</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="Promise-prototype-catch"><a href="#Promise-prototype-catch" class="headerlink" title="Promise.prototype.catch()"></a>Promise.prototype.catch()</h4><blockquote>
<p>.then(null, rejection) çš„åˆ«åï¼Œç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒ</p>
</blockquote>
<h4 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all()"></a>Promise.all()</h4><p>promise.all ç”¨äºå°†å¤šä¸ªpromiseå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„promiseå®ä¾‹ã€‚Promise.all æ–¹æ³•çš„å‚æ•°ä¸ä¸€å®šæ˜¯æ•°ç»„ï¼Œä½†æ˜¯å¿…é¡»å…·æœ‰Iteratoræ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸€ä¸ªæˆå‘˜éƒ½æ˜¯Promiseå®ä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.all([p1, p2, p3])</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> promises = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>].map(<span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getJSON(<span class="string">"/post/"</span> + id + <span class="string">".json"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Promise</span>.all(promises).then(<span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>promiseå¯¹è±¡çš„é”™è¯¯å°±æœ‰å†’æ³¡æ€§è´¨ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ä¸ºæ­¢</p>
<blockquote>
<p>ä¸€èˆ¬ä¸è¦åœ¨thenæ–¹æ³•ä¸­å®šä¹‰rejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œè€Œåº”æ€»æ˜¯ä½¿ç”¨catchæ–¹æ³•ï¼Œç†ç”±æ˜¯æ›´æ¥è¿‘åŒæ­¥å†™æ³•ã€‚</p>
</blockquote>
<h3 id="ç¬¬17ç« -å¼‚æ­¥æ“ä½œå’Œ-async-å‡½æ•°"><a href="#ç¬¬17ç« -å¼‚æ­¥æ“ä½œå’Œ-async-å‡½æ•°" class="headerlink" title="ç¬¬17ç«  å¼‚æ­¥æ“ä½œå’Œ async å‡½æ•°"></a>ç¬¬17ç«  å¼‚æ­¥æ“ä½œå’Œ async å‡½æ•°</h3><p>ES6 å‰ï¼Œå¼‚æ­¥ç¼–ç¨‹æ–¹æ³•ï¼š</p>
<ul>
<li>å›è°ƒå‡½æ•°</li>
<li>äº‹ä»¶ç›‘å¬</li>
<li>å‘å¸ƒ/è®¢é˜…</li>
<li>promise å¯¹è±¡</li>
</ul>
<p>** promiseæœ€å¤§çš„é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼ŒåŸæ¥çš„ä»»åŠ¡è¢«promiseåŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹ä¸Šå»éƒ½æ˜¯ä¸€å †thenï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥š**</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>)</span><br><span class="line">g.next()</span><br><span class="line">g.next()</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨ generatorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ˆå³éå†å™¨ï¼‰gï¼Œè¿™æ˜¯generatorå‡½æ•°ä¸åŒäºæ™®é€šå‡½æ•°çš„å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå³æ‰§è¡Œä»–ä¸ä¼šè¿”å›ç»“æœï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡<br>nextæ–¹æ³•çš„ä½œç”¨æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œgeneratorå‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯</p>
<h4 id="generatorå‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"><a href="#generatorå‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†" class="headerlink" title="generatorå‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"></a>generatorå‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†</h4><p>ä¸‹é¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªnextæ–¹æ³•çš„valueå±æ€§ï¼Œè¿”å›è¡¨è¾¾å¼x+2çš„å€¼ï¼Œç¬¬äºŒä¸ªnextæ–¹æ³•å¸¦æœ‰å‚æ•°2ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥generatorå‡½æ•°ï¼Œä½œä¸ºä¸Šä¸ªé˜¶æ®µå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœè¢«å‡½æ•°ä½“å†…çš„yæ¥æ”¶ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥valueå±æ€§è¿”å›çš„å°±æ˜¯2</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>)</span><br><span class="line">g.next()</span><br><span class="line">g.next(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>generatorå‡½æ•°å¯ä»¥éƒ¨ç½²é”™è¯¯å¤„ç†ä»£ç ï¼Œæ•è·å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>)</span><br><span class="line">g.next()</span><br><span class="line">g.throw(<span class="string">'å‡ºé”™äº†'</span>)</span><br></pre></td></tr></table></figure>

<p><strong>generatorå‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿</strong></p>
<h3 id="ç¬¬18ç« -Class"><a href="#ç¬¬18ç« -Class" class="headerlink" title="ç¬¬18ç«  Class"></a>ç¬¬18ç«  Class</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(x, y) &#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y</span><br><span class="line">    &#125;</span><br><span class="line">    toString() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.x + <span class="string">','</span> + <span class="keyword">this</span>.y + <span class="string">')'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// typeof Point === "function" true</span></span><br><span class="line"><span class="comment">// Point === Point.prototype.constructor true</span></span><br></pre></td></tr></table></figure>

<p>ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨ç±»çš„prototypeå±æ€§ä¸Šã€‚åœ¨ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œå®é™…æ˜¯åœ¨è°ƒç”¨ç±»çš„åŸå‹ä¸Šæ–¹æ³•ã€‚<br>ç±»çš„å†…éƒ¨å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„</p>
<p><strong>constructoræ–¹æ³•</strong><br>constructoræ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œ é€šè¿‡newå‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶è‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼Œconstructoræ–¹æ³•é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡ï¼ˆthisï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¿”å›å¦å¤–ä¸€ä¸ªå¯¹è±¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// new Foo() instanceof Foo false</span></span><br></pre></td></tr></table></figure>

<h4 id="class-è¡¨è¾¾å¼"><a href="#class-è¡¨è¾¾å¼" class="headerlink" title="class è¡¨è¾¾å¼"></a>class è¡¨è¾¾å¼</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="class"><span class="keyword">class</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">    sayName() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(<span class="string">'zhang san'</span>)</span><br><span class="line">person.sayName()</span><br></pre></td></tr></table></figure>

<h4 id="class-ç»§æ‰¿"><a href="#class-ç»§æ‰¿" class="headerlink" title="class ç»§æ‰¿"></a>class ç»§æ‰¿</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(x, y, color) &#123;</span><br><span class="line">        <span class="keyword">super</span>(x, y)</span><br><span class="line">        <span class="keyword">this</span>.color = color</span><br><span class="line">    &#125;</span><br><span class="line">    toString() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.color + <span class="string">' '</span> + <span class="keyword">super</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>super æŒ‡ä»£çˆ¶ç±»çš„å®ä¾‹ï¼ˆå³çˆ¶ç±»çš„thiså¯¹è±¡ï¼‰<br>å­ç±»å¿…é¡»åœ¨constructoræ–¹æ³•ä¸­è°ƒç”¨superå¯¹è±¡ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿äº†çˆ¶ç±»çš„thiså¯¹è±¡ï¼Œç„¶åå¯¹å…¶åŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨superæ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°thiså¯¹è±¡</p>
<h4 id="ç±»çš„prototypeå±æ€§å’Œ-proto-å±æ€§"><a href="#ç±»çš„prototypeå±æ€§å’Œ-proto-å±æ€§" class="headerlink" title="ç±»çš„prototypeå±æ€§å’Œ proto å±æ€§"></a>ç±»çš„prototypeå±æ€§å’Œ <strong>proto</strong> å±æ€§</h4><ul>
<li>å­ç±»çš„<strong>proto</strong> å±æ€§è¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼ŒæŒ‡å‘çˆ¶ç±»</li>
<li>å­ç±»çš„prototypeå±æ€§çš„<strong>proto</strong>è¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼ŒæŒ‡å‘çˆ¶ç±»çš„prototypeå±æ€§ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line">B.__proto__ === A</span><br><span class="line">B.prototype.__proto__ === A.prototype</span><br></pre></td></tr></table></figure>

<h4 id="Object-getPrototypeOf"><a href="#Object-getPrototypeOf" class="headerlink" title="Object.getPrototypeOf()"></a>Object.getPrototypeOf()</h4><p>Object.getPrototypeOf()æ–¹æ³•å¯ç”¨äºä»å­ç±»ä¸Šè·å–çˆ¶ç±»</p>
<h4 id="åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿</h4><p>åŸç”Ÿæ„é€ å‡½æ•°å¼è¯­è¨€å†…ç½®çš„æ„é€ å‡½æ•°ï¼Œé€šå¸¸ç”¨æ¥ç”Ÿæˆæ•°æ®ç»“æ„</p>
<ul>
<li>Boolean()</li>
<li>Number()</li>
<li>String()</li>
<li>Array()</li>
<li>Date()</li>
<li>Function()</li>
<li>RegExp()</li>
<li>Error()</li>
<li>Object()</li>
</ul>
<h4 id="class-å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰"><a href="#class-å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰" class="headerlink" title="class å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰"></a>class å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">get</span> prop() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'getter'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> prop(value) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'setterï¼š'</span> + value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> inst = <span class="keyword">new</span> MyClass()</span><br><span class="line">inst.prop = <span class="number">123</span></span><br><span class="line">inst.prop</span><br></pre></td></tr></table></figure>

<h4 id="class-çš„-Generator-æ–¹æ³•"><a href="#class-çš„-Generator-æ–¹æ³•" class="headerlink" title="class çš„ Generator æ–¹æ³•"></a>class çš„ Generator æ–¹æ³•</h4><p>å¦‚æœåœ¨æŸä¸ªæ–¹æ³•é’±åŠ ä¸Šæ˜Ÿå·ï¼ˆ*ï¼‰ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ—¶ä¸€ä¸ªgeneratorå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(...args) &#123;</span><br><span class="line">            <span class="keyword">this</span>.args = args</span><br><span class="line">        &#125;</span><br><span class="line">        *[<span class="built_in">Symbol</span>.iterator]() &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> arg <span class="keyword">of</span> <span class="keyword">this</span>.args) &#123;</span><br><span class="line">                <span class="keyword">yield</span> arg</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="keyword">new</span> Foo(<span class="string">'hello'</span>, <span class="string">'world'</span>)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="class-çš„é™æ€æ–¹æ³•"><a href="#class-çš„é™æ€æ–¹æ³•" class="headerlink" title="class çš„é™æ€æ–¹æ³•"></a>class çš„é™æ€æ–¹æ³•</h4><p>ç±»ç›¸å½“äºå®ä¾‹çš„åŸå‹ï¼Œæ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•éƒ½ä¼šè¢«å®ä¾‹ç»§æ‰¿ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰åŠ ä¸Šstaticå…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»è°ƒç”¨ï¼Œç§°ä¸ºâ€œé™æ€æ–¹æ³•â€</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> classMethod() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> <span class="keyword">extends</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> classMethod() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.classMethod() + <span class="string">', too'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="new-target-å±æ€§"><a href="#new-target-å±æ€§" class="headerlink" title="new.target å±æ€§"></a>new.target å±æ€§</h4><p>new.target è¿”å› new å‘½ä»¤ä½œç”¨çš„æ„é€ å‡½æ•°</p>
<h3 id="ç¬¬20ç« -Module"><a href="#ç¬¬20ç« -Module" class="headerlink" title="ç¬¬20ç«  Module"></a>ç¬¬20ç«  Module</h3><ul>
<li>CommonJS ç”¨äºæœåŠ¡å™¨</li>
<li>AMD ç”¨äºæµè§ˆå™¨</li>
</ul>
<p>ES6 æ¨¡å—çš„è®¾è®¡æ€æƒ³æ˜¯å°½é‡é™æ€åŒ–ï¼Œä½¿å¾—ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥è¾“å‡ºå˜é‡ã€‚CommonJSå’ŒAMDéƒ½åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šè¿™äº›ä¸œè¥¿</p>
<ul>
<li>CommonJSæ¨¡å—å°±æ˜¯å¯¹è±¡ï¼Œè¾“å…¥æ—¶å¿…é¡»æŸ¥æ‰¾å¯¹è±¡å±æ€§</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿è¡Œæ—¶åŠ è½½</span></span><br><span class="line"><span class="keyword">let</span> &#123;</span><br><span class="line">    stat,</span><br><span class="line">    exists,</span><br><span class="line">    readFile</span><br><span class="line">&#125; = requre(<span class="string">'fs'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡exportå‘½ä»¤æ˜¾ç¤ºæŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œè¾“å…¥æ—¶ä¹Ÿé‡‡ç”¨é™æ€å‘½ä»¤çš„å½¢å¼</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¼–è¯‘æ—¶åŠ è½½</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    stat,</span><br><span class="line">    exists,</span><br><span class="line">    readFile</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'fs'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>export ä½¿ç”¨ as é‡å‘½å</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">    v1 <span class="keyword">as</span> streamV1,</span><br><span class="line">    v2 <span class="keyword">as</span> streamV2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>import ä½¿ç”¨ as é‡å‘½å</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    lastname <span class="keyword">as</span> surname</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'./profile'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>import å‘½ä»¤å…·æœ‰æå‡æ•ˆæœï¼Œä¼šæå‡åˆ°æ¨¡å—çš„å¤´éƒ¨é¦–å…ˆæ‰§è¡Œã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">    es6 <span class="keyword">as</span></span><br><span class="line">    <span class="keyword">default</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> <span class="string">'./someModule'</span> ===</span><br><span class="line">    =&gt; ç­‰ä»·</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    es6</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'./someMudule'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> es6</span><br></pre></td></tr></table></figure>

<ul>
<li>æ•´ä½“åŠ è½½</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">'./circle'</span></span><br></pre></td></tr></table></figure>

<h4 id="ES6-æ¨¡å—åŠ è½½çš„å®è´¨"><a href="#ES6-æ¨¡å—åŠ è½½çš„å®è´¨" class="headerlink" title="ES6 æ¨¡å—åŠ è½½çš„å®è´¨"></a>ES6 æ¨¡å—åŠ è½½çš„å®è´¨</h4><p>CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ŒES6æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚</p>
<h4 id="å¾ªç¯åŠ è½½"><a href="#å¾ªç¯åŠ è½½" class="headerlink" title="å¾ªç¯åŠ è½½"></a>å¾ªç¯åŠ è½½</h4><ul>
<li>require å‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½è„šæœ¬å°±ä¼šæ‰§è¡Œæ•´ä¸ªè„šæœ¬ï¼Œç„¶åå†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚CommonJSå¯¹å¾…å¾ªç¯åŠ è½½ï¼Œåªä¼šè¾“å‡ºå·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè¿˜æœªæ‰§è¡Œçš„éƒ¨åˆ†ä¸ä¼šè¾“å‡º</li>
</ul>
]]></content>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ€é•¿å…¬å…±å­åºåˆ—</title>
    <url>/2020/02/19/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97/</url>
    <content><![CDATA[<p>dp[i][j] è¡¨ç¤º str1[0â€¦i] ä¸ str2[0â€¦j] çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦</p>
<a id="more"></a>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">"1A2C3D4B56"</span></span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">"B1D23CA45B6A"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create2DArray</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>(m)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        arr[i] = <span class="built_in">Array</span>(n)</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">commonStr</span>(<span class="params">str1, str2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> len1 = str1.length</span><br><span class="line">    <span class="keyword">const</span> len2 = str2.length</span><br><span class="line">    <span class="keyword">let</span> dp = create2DArray(len1, len2)</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = str1[<span class="number">0</span>] === str2[<span class="number">0</span>] ? <span class="number">1</span> : <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; len1; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="built_in">Math</span>.max(dp[i - <span class="number">1</span>][<span class="number">0</span>], str1[i] === str2[<span class="number">0</span>] ? <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; len2; j++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = <span class="built_in">Math</span>.max(dp[<span class="number">0</span>][j - <span class="number">1</span>], str1[<span class="number">0</span>] === str2[j] ? <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; len1; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; len2; j++) &#123;</span><br><span class="line">            dp[i][j] = <span class="built_in">Math</span>.max(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> (str1[i] === str2[j]) &#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">Math</span>.max(dp[i][j], dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://ww1.sinaimg.cn/large/92babc53ly1gc401r3pbtj20t605o74u.jpg" alt="image.png"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCommon</span>(<span class="params">str1, str2, dp</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> m = str1.length - <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> n = str2.length - <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> index = dp[m - <span class="number">1</span>][n - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">let</span> res = <span class="built_in">Array</span>(index)</span><br><span class="line">    <span class="keyword">while</span> (index &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span> &amp;&amp; dp[m][n] === dp[m][n - <span class="number">1</span>]) &#123;</span><br><span class="line">            n--</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (m &gt; <span class="number">0</span> &amp;&amp; dp[m][n] === dp[m - <span class="number">1</span>][n]) &#123;</span><br><span class="line">            m--</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res)</span><br><span class="line">            res[index--] = str1[m]</span><br><span class="line">            m--</span><br><span class="line">            n--</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.join(<span class="string">''</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>å­—ç¬¦ä¸²</title>
    <url>/2020/02/23/%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    <content><![CDATA[<h3 id="åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºå˜å½¢è¯"><a href="#åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºå˜å½¢è¯" class="headerlink" title="åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºå˜å½¢è¯"></a>åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºå˜å½¢è¯</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isDeformation</span>(<span class="params">str1, str2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!str1 || !str2 || str1.length !== str2.length) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> map = <span class="built_in">Array</span>(<span class="number">256</span>).fill(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; str1.length; i++) &#123;</span><br><span class="line">    map[str1[i]]++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; str2.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (map[str2[i]]-- === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>Typescript</title>
    <url>/2019/12/28/Typescript/</url>
    <content><![CDATA[<h2 id="Typescript-å­¦ä¹ æ•™ç¨‹"><a href="#Typescript-å­¦ä¹ æ•™ç¨‹" class="headerlink" title="Typescript å­¦ä¹ æ•™ç¨‹"></a>Typescript å­¦ä¹ æ•™ç¨‹</h2><a id="more"></a>

<h3 id="typescript-é€šè¿‡ç±»å‹æ³¨è§£æä¾›ç¼–è¯‘æ—¶çš„é™æ€ç±»å‹æ£€æŸ¥"><a href="#typescript-é€šè¿‡ç±»å‹æ³¨è§£æä¾›ç¼–è¯‘æ—¶çš„é™æ€ç±»å‹æ£€æŸ¥" class="headerlink" title="typescript é€šè¿‡ç±»å‹æ³¨è§£æä¾›ç¼–è¯‘æ—¶çš„é™æ€ç±»å‹æ£€æŸ¥"></a>typescript é€šè¿‡ç±»å‹æ³¨è§£æä¾›ç¼–è¯‘æ—¶çš„é™æ€ç±»å‹æ£€æŸ¥</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜æ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> arr: number[] = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="comment">// æ•°ç»„æ³›å‹</span></span><br><span class="line"><span class="keyword">let</span> arr: <span class="built_in">Array</span> &lt; number &gt; = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…ƒç¥–ï¼šè¡¨ç¤ºå·²çŸ¥å…ƒç´ æ•°é‡å’Œç±»å‹çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> x: [string, number]</span><br><span class="line">x = [<span class="string">"Runoob"</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// æšä¸¾ï¼Œç”¨äºå®šä¹‰æ•°å€¼é›†åˆ</span></span><br><span class="line">enum Color &#123;</span><br><span class="line">    Red,</span><br><span class="line">    Green,</span><br><span class="line">    Blue</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> c: Color = Color.Blue</span><br></pre></td></tr></table></figure>

<h3 id="typescript-å˜é‡å£°æ˜"><a href="#typescript-å˜é‡å£°æ˜" class="headerlink" title="typescript å˜é‡å£°æ˜"></a>typescript å˜é‡å£°æ˜</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> [å˜é‡å]: [ç±»å‹] = å€¼</span><br></pre></td></tr></table></figure>

<h3 id="ç±»å‹æ–­è¨€-ï¼ˆType-Assertionï¼‰"><a href="#ç±»å‹æ–­è¨€-ï¼ˆType-Assertionï¼‰" class="headerlink" title="ç±»å‹æ–­è¨€ ï¼ˆType Assertionï¼‰"></a>ç±»å‹æ–­è¨€ ï¼ˆType Assertionï¼‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt; ç±»å‹ &gt; å€¼</span><br><span class="line"></span><br><span class="line">å€¼ <span class="keyword">as</span> ç±»å‹</span><br></pre></td></tr></table></figure>

<h3 id="å¸¦å‚æ•°å‡½æ•°"><a href="#å¸¦å‚æ•°å‡½æ•°" class="headerlink" title="å¸¦å‚æ•°å‡½æ•°"></a>å¸¦å‚æ•°å‡½æ•°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func_name</span>(<span class="params">param1[: datatype], param2[: datatype]</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x: number, y: number</span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯é€‰å‚æ•° è‹¥æˆ‘ä»¬å®šä¹‰äº†å‚æ•°ï¼Œåˆ™å¿…é¡»è¦ä¼ å…¥è¿™äº›å‚æ•°ï¼Œé™¤éè®²å‚æ•°è®¾ä¸ºå¯é€‰ï¼Œå¯é€‰å‚æ•°ä½¿ç”¨é—®å·æ ‡è¯†</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildName</span>(<span class="params">firstName: string, lastName ? : string</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">function_name</span>(<span class="params">param1[: type], param2[: type] = default_value</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculate_discount</span>(<span class="params">price: number, rate: number = <span class="number">0.5</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰©ä½™å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildName</span>(<span class="params">firstName: string, ...restOfName: string[]</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addNumbers</span>(<span class="params">...nums: number[]</span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°é‡è½½ æ–¹æ³•åå­—ç›¸åŒï¼Œè€Œå‚æ•°ä¸åŒï¼Œè¿”å›ç±»å‹å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ç›¸åŒ</span></span><br></pre></td></tr></table></figure>

<h3 id="è”åˆç±»å‹-é€šè¿‡ç®¡é“å°†å˜é‡è®¾ç½®æˆå¤šç§ç±»å‹ï¼Œèµ‹å€¼æ—¶å¯ä»¥æ ¹æ®è®¾ç½®çš„ç±»å‹æ¥èµ‹å€¼"><a href="#è”åˆç±»å‹-é€šè¿‡ç®¡é“å°†å˜é‡è®¾ç½®æˆå¤šç§ç±»å‹ï¼Œèµ‹å€¼æ—¶å¯ä»¥æ ¹æ®è®¾ç½®çš„ç±»å‹æ¥èµ‹å€¼" class="headerlink" title="è”åˆç±»å‹(é€šè¿‡ç®¡é“å°†å˜é‡è®¾ç½®æˆå¤šç§ç±»å‹ï¼Œèµ‹å€¼æ—¶å¯ä»¥æ ¹æ®è®¾ç½®çš„ç±»å‹æ¥èµ‹å€¼)"></a>è”åˆç±»å‹(é€šè¿‡ç®¡é“å°†å˜é‡è®¾ç½®æˆå¤šç§ç±»å‹ï¼Œèµ‹å€¼æ—¶å¯ä»¥æ ¹æ®è®¾ç½®çš„ç±»å‹æ¥èµ‹å€¼)</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Type1 | Type2 | Type3</span><br></pre></td></tr></table></figure>

<h3 id="æ¥å£-ä¸€ç³»åˆ—æŠ½è±¡æ–¹æ³•çš„å£°æ˜ï¼Œä¸€äº›æ–¹æ³•ç‰¹å¾çš„é›†åˆ"><a href="#æ¥å£-ä¸€ç³»åˆ—æŠ½è±¡æ–¹æ³•çš„å£°æ˜ï¼Œä¸€äº›æ–¹æ³•ç‰¹å¾çš„é›†åˆ" class="headerlink" title="æ¥å£(ä¸€ç³»åˆ—æŠ½è±¡æ–¹æ³•çš„å£°æ˜ï¼Œä¸€äº›æ–¹æ³•ç‰¹å¾çš„é›†åˆ)"></a>æ¥å£(ä¸€ç³»åˆ—æŠ½è±¡æ–¹æ³•çš„å£°æ˜ï¼Œä¸€äº›æ–¹æ³•ç‰¹å¾çš„é›†åˆ)</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">interface IPerson &#123;</span><br><span class="line">    firstName: string,</span><br><span class="line">        lastName: string,</span><br><span class="line">        sayHi: <span class="function"><span class="params">()</span> =&gt;</span> string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> customer: IPerson = &#123;</span><br><span class="line">    firstName: <span class="string">"Tom"</span>,</span><br><span class="line">    lastName: <span class="string">"Hanks"</span>,</span><br><span class="line">    sayHi: (): <span class="function"><span class="params">string</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hi there"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(customer.firstName)</span><br><span class="line"><span class="built_in">console</span>.log(customer.sayHi())</span><br></pre></td></tr></table></figure>

<h3 id="è”åˆç±»å‹å’Œæ¥å£"><a href="#è”åˆç±»å‹å’Œæ¥å£" class="headerlink" title="è”åˆç±»å‹å’Œæ¥å£"></a>è”åˆç±»å‹å’Œæ¥å£</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">interface RunOptions &#123;</span><br><span class="line">    program: string</span><br><span class="line">    commandline: string[] | string | <span class="function">(<span class="params">(</span>) =&gt;</span> string)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> options: RunOptions = &#123;</span><br><span class="line">    program: <span class="string">"text1"</span>,</span><br><span class="line">    commandline: <span class="string">"Hello"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> options: RunOptions = &#123;</span><br><span class="line">    program: <span class="string">"text1"</span>,</span><br><span class="line">    commandline: [<span class="string">"Hello"</span>, <span class="string">"world"</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> options: RunOptions = &#123;</span><br><span class="line">    program: <span class="string">"text1"</span>,</span><br><span class="line">    commandline: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"**Hello world**"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¥å£å’Œæ•°ç»„"><a href="#æ¥å£å’Œæ•°ç»„" class="headerlink" title="æ¥å£å’Œæ•°ç»„"></a>æ¥å£å’Œæ•°ç»„</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">interface namelist &#123;</span><br><span class="line">    [index: number]: string</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> list2: namelist = [<span class="string">"John"</span>, <span class="string">"s"</span>, <span class="string">"Bran"</span>]</span><br><span class="line">interface ages &#123;</span><br><span class="line">    [index: string]: number</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> agelist: ages</span><br></pre></td></tr></table></figure>

<h3 id="æ¥å£ç»§æ‰¿ï¼ˆæ¥å£å¯ä»¥é€šè¿‡å…¶ä»–æ¥å£æ¥æ‰©å±•è‡ªå·±ï¼‰"><a href="#æ¥å£ç»§æ‰¿ï¼ˆæ¥å£å¯ä»¥é€šè¿‡å…¶ä»–æ¥å£æ¥æ‰©å±•è‡ªå·±ï¼‰" class="headerlink" title="æ¥å£ç»§æ‰¿ï¼ˆæ¥å£å¯ä»¥é€šè¿‡å…¶ä»–æ¥å£æ¥æ‰©å±•è‡ªå·±ï¼‰"></a>æ¥å£ç»§æ‰¿ï¼ˆæ¥å£å¯ä»¥é€šè¿‡å…¶ä»–æ¥å£æ¥æ‰©å±•è‡ªå·±ï¼‰</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å•æ¥å£ç»§æ‰¿</span></span><br><span class="line">child_interface_name extends super_interface_name</span><br><span class="line"><span class="comment">// å¤šæ¥å£ç»§æ‰¿</span></span><br><span class="line">child_interface_name extends super_interface1_name, super_interface2_name, ..., super_interfaceN_name</span><br><span class="line"><span class="comment">// å•ç»§æ‰¿</span></span><br><span class="line">interface Person &#123;</span><br><span class="line">    age: number</span><br><span class="line">&#125;</span><br><span class="line">interface Musician extends Person &#123;</span><br><span class="line">    instrument: string</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> drummer = <span class="xml"><span class="tag">&lt; <span class="attr">Musician</span> &gt;</span> &#123;&#125;;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¤šç»§æ‰¿</span></span><br><span class="line">interface IParent1 &#123;</span><br><span class="line">    v1: number</span><br><span class="line">&#125;</span><br><span class="line">interface IParent2 &#123;</span><br><span class="line">    v2: number</span><br><span class="line">&#125;</span><br><span class="line">interface Child extends IParent1, IParent2 &#123;&#125;</span><br><span class="line"><span class="keyword">var</span> Iobj: Child = &#123;</span><br><span class="line">    v1: <span class="number">12</span>,</span><br><span class="line">    v2: <span class="number">23</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    engine: string</span><br><span class="line">    <span class="keyword">constructor</span>(engine: string) &#123;</span><br><span class="line">        <span class="keyword">this</span>.engine = engine</span><br><span class="line">    &#125;</span><br><span class="line">    disp(): <span class="keyword">void</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿ç±»çš„æ–¹æ³•é‡å†™</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PrinterClass</span> </span>&#123;</span><br><span class="line">    doPrint(): <span class="keyword">void</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringPrinter</span> <span class="keyword">extends</span> <span class="title">PrinterClass</span> </span>&#123;</span><br><span class="line">    doPrint(): <span class="keyword">void</span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.doPrint()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// static å…³é”®å­—ç”¨äºå®šä¹‰ç±»çš„æ•°æ®æˆå‘˜ä¸ºé™æ€çš„ï¼Œé™æ€æˆå‘˜å¯ä»¥é€šè¿‡ç±»åè°ƒç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StaticMem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> num: number</span><br><span class="line">    <span class="keyword">static</span> disp(): <span class="keyword">void</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"><a href="#è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦" class="headerlink" title="è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"></a>è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦</h3><ul>
<li>public å…¬æœ‰ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®</li>
<li>protected å—ä¿æŠ¤çš„ï¼Œå¯ä»¥è¢«å…¶è‡ªèº«ä»¥åŠå…¶å­ç±»å’Œçˆ¶ç±»è®¿é—®</li>
<li>private ç§æœ‰ï¼Œåªèƒ½è¢«å…¶å®šä¹‰æ‰€åœ¨çš„ç±»è®¿é—®</li>
</ul>
<h3 id="typescript-æ¨¡å—"><a href="#typescript-æ¨¡å—" class="headerlink" title="typescript æ¨¡å—"></a>typescript æ¨¡å—</h3><p>æˆ‘ä»¬ä½¿ç”¨ <code>|=</code> æ¥æ·»åŠ ä¸€ä¸ªæ ‡å¿—<br>ç»„åˆä½¿ç”¨ <code>&amp;=</code> å’Œ <code>~</code> æ¥æ¸…ç†ä¸€ä¸ªæ ‡å¿—<br>ä½¿ç”¨ <code>|</code> æ¥åˆå¹¶æ ‡å¿— </p>
<h2 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a><a href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></h2><h3 id="åŸºç¡€ç±»å‹"><a href="#åŸºç¡€ç±»å‹" class="headerlink" title="åŸºç¡€ç±»å‹"></a>åŸºç¡€ç±»å‹</h3><ul>
<li>æ•°ç»„</li>
</ul>
<p>å®šä¹‰æ–¹å¼æœ‰å¦‚ä¸‹ä¸¤ç§ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> list: number[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> list: <span class="built_in">Array</span> &lt; number &gt;= [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>å…ƒç»„ Tuple</li>
</ul>
<blockquote>
<p>å…ƒç»„ç±»å‹å…è®¸è¡¨ç¤ºä¸€ä¸ªå·²çŸ¥å…ƒç´ æ•°é‡å’Œç±»å‹çš„æ•°ç»„ï¼Œå„å…ƒç´ çš„ç±»å‹ä¸å¿…ç›¸åŒ</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> list: [string, number]</span><br></pre></td></tr></table></figure>

<p>å½“è®¿é—®ä¸€ä¸ªè¶Šç•Œçš„å…ƒç´ ï¼Œä¼šä½¿ç”¨è”åˆç±»å‹æ›¿ä»£</p>
<ul>
<li>ç±»å‹æ–­è¨€</li>
</ul>
<p>ğŸ‘‡å°–æ‹¬å·è¯­æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> someValue: any = <span class="string">"this is a string"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> strLength: number = ( <span class="xml"><span class="tag">&lt; <span class="attr">string</span> &gt;</span> someValue).length;</span></span><br></pre></td></tr></table></figure>

<p>ğŸ‘‡as è¯­æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> someValue: any = <span class="string">"this is a string"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> strLength: number = (someValue <span class="keyword">as</span> string).length;</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‡ç»™å¯¹è±¡å…ƒç´ æŒ‡å®šç±»å‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;</span><br><span class="line">    a,</span><br><span class="line">    b</span><br><span class="line">&#125;: &#123;</span><br><span class="line">    a: string,</span><br><span class="line">    b: number</span><br><span class="line">&#125; = o;</span><br></pre></td></tr></table></figure>


<h3 id="Symbol-ç”¨æ³•"><a href="#Symbol-ç”¨æ³•" class="headerlink" title="Symbol ç”¨æ³•"></a>Symbol ç”¨æ³•</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> sym = <span class="built_in">Symbol</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    [sym]: <span class="string">"value"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj[sym]); <span class="comment">// "value"</span></span><br></pre></td></tr></table></figure>

<h3 id="forâ€¦in-forâ€¦of"><a href="#forâ€¦in-forâ€¦of" class="headerlink" title="forâ€¦in forâ€¦of"></a>forâ€¦in forâ€¦of</h3><p>for..ofå’Œfor..inå‡å¯è¿­ä»£ä¸€ä¸ªåˆ—è¡¨ï¼›ä½†æ˜¯ç”¨äºè¿­ä»£çš„å€¼å´ä¸åŒï¼Œfor..inè¿­ä»£çš„æ˜¯å¯¹è±¡çš„ é”® çš„åˆ—è¡¨ï¼Œè€Œfor..ofåˆ™è¿­ä»£å¯¹è±¡çš„é”®å¯¹åº”çš„å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> list = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> list) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i); <span class="comment">// "0", "1", "2",</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> list) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i); <span class="comment">// "4", "5", "6"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ä¸ªåŒºåˆ«æ˜¯for..inå¯ä»¥æ“ä½œä»»ä½•å¯¹è±¡ï¼›å®ƒæä¾›äº†æŸ¥çœ‹å¯¹è±¡å±æ€§çš„ä¸€ç§æ–¹æ³•ã€‚ ä½†æ˜¯ for..ofå…³æ³¨äºè¿­ä»£å¯¹è±¡çš„å€¼ã€‚å†…ç½®å¯¹è±¡Mapå’ŒSetå·²ç»å®ç°äº†Symbol.iteratoræ–¹æ³•ï¼Œè®©æˆ‘ä»¬å¯ä»¥è®¿é—®å®ƒä»¬ä¿å­˜çš„å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> pets = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"Cat"</span>, <span class="string">"Dog"</span>, <span class="string">"Hamster"</span>]);</span><br><span class="line">pets[<span class="string">"species"</span>] = <span class="string">"mammals"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pet <span class="keyword">in</span> pets) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(pet); <span class="comment">// "species"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pet <span class="keyword">of</span> pets) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(pet); <span class="comment">// "Cat", "Dog", "Hamster"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>Typescript</tag>
      </tags>
  </entry>
  <entry>
    <title>Refs</title>
    <url>/2020/02/13/Refs/</url>
    <content><![CDATA[<h3 id="æœ¬ç¯‡ä»‹ç»-Refs-åŸºç¡€çŸ¥è¯†"><a href="#æœ¬ç¯‡ä»‹ç»-Refs-åŸºç¡€çŸ¥è¯†" class="headerlink" title="æœ¬ç¯‡ä»‹ç» Refs åŸºç¡€çŸ¥è¯†"></a>æœ¬ç¯‡ä»‹ç» Refs åŸºç¡€çŸ¥è¯†</h3><a id="more"></a>

<h3 id="this-inputText-current-æŒ‡ä»£-input-DOM"><a href="#this-inputText-current-æŒ‡ä»£-input-DOM" class="headerlink" title="this.inputText.current æŒ‡ä»£ input DOM"></a>this.inputText.current æŒ‡ä»£ input DOM</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Next</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.input = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.input.current);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.input&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ref-å¯ä»¥ç›´æ¥æ·»åŠ åˆ°-ç»„ä»¶ä¸Šï¼Œref-current-å¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•"><a href="#ref-å¯ä»¥ç›´æ¥æ·»åŠ åˆ°-ç»„ä»¶ä¸Šï¼Œref-current-å¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•" class="headerlink" title="ref å¯ä»¥ç›´æ¥æ·»åŠ åˆ° ç»„ä»¶ä¸Šï¼Œref.current å¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•"></a>ref å¯ä»¥ç›´æ¥æ·»åŠ åˆ° ç»„ä»¶ä¸Šï¼Œref.current å¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•</h3><p><strong>ä»…åœ¨ Child æ˜¯ class ç»„ä»¶æ—¶æœ‰ç”¨</strong></p>
<p><strong>å‡½æ•°å¼ç»„ä»¶æ²¡æœ‰å®ä¾‹</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.inputText = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.inputText.current.click());</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">ref</span>=<span class="string">&#123;this.inputText&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">class Child extends React.Component &#123;</span></span><br><span class="line"><span class="xml">  click() &#123;</span></span><br><span class="line"><span class="xml">    console.log("clicked");</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  render() &#123;</span></span><br><span class="line"><span class="xml">    return <span class="tag">&lt;<span class="name">input</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-forwardRef-ä½¿å‡½æ•°å¼ç»„ä»¶å¯ä»¥å®ç°-å°†-ref-ä¼ é€’ç»™å®ƒçš„ä¸€ä¸ªå­ç»„ä»¶"><a href="#ä½¿ç”¨-forwardRef-ä½¿å‡½æ•°å¼ç»„ä»¶å¯ä»¥å®ç°-å°†-ref-ä¼ é€’ç»™å®ƒçš„ä¸€ä¸ªå­ç»„ä»¶" class="headerlink" title="ä½¿ç”¨ forwardRef ä½¿å‡½æ•°å¼ç»„ä»¶å¯ä»¥å®ç° å°† ref ä¼ é€’ç»™å®ƒçš„ä¸€ä¸ªå­ç»„ä»¶"></a>ä½¿ç”¨ forwardRef ä½¿å‡½æ•°å¼ç»„ä»¶å¯ä»¥å®ç° å°† ref ä¼ é€’ç»™å®ƒçš„ä¸€ä¸ªå­ç»„ä»¶</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ref = React.createRef();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">FancyButton</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> <span class="attr">content</span>=<span class="string">&#123;</span>"<span class="attr">hello</span>"&#125; /&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">const FancyButton = React.forwardRef((props, ref) =&gt; &#123;</span></span><br><span class="line"><span class="xml">  return <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>&#123;props.content&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br></pre></td></tr></table></figure>


<h3 id="å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨ref"><a href="#å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨ref" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨ref"></a>å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨ref</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = React.createRef()</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(inputRef.current)</span><br><span class="line">  &#125;,[])</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="å›è°ƒ-ref"><a href="#å›è°ƒ-ref" class="headerlink" title="å›è°ƒ ref"></a>å›è°ƒ ref</h3><blockquote>
<p>å®ƒèƒ½åŠ©ä½ æ›´ç²¾ç»†åœ°æ§åˆ¶ä½•æ—¶ refs è¢«è®¾ç½®å’Œè§£é™¤ã€‚ä½ ä¼šä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸­æ¥å— React ç»„ä»¶å®ä¾‹æˆ– HTML DOM å…ƒç´ ä½œä¸ºå‚æ•°ï¼Œä»¥ä½¿å®ƒä»¬èƒ½åœ¨å…¶ä»–åœ°æ–¹è¢«å­˜å‚¨å’Œè®¿é—®<br>å›è°ƒ ref å¯ç›´æ¥é€šè¿‡ this.inputText è®¿é—®ï¼Œè€Œä¸æ˜¯åœ¨ this.inputText.current ä¸Šè®¿é—® </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.inputText = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.inputText.value = <span class="string">"hello"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">InputRef</span>=<span class="string">&#123;el</span> =&gt;</span> (this.inputText = el)&#125; /&gt;;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>



<p>React ä¼šåœ¨ç»„ä»¶æŒ‚è½½æ—¶ç»™ current å±æ€§ä¼ å…¥ DOM å…ƒç´ ï¼Œå¹¶åœ¨ç»„ä»¶å¸è½½æ—¶ä¼ å…¥ null å€¼ã€‚ref ä¼šåœ¨ componentDidMount æˆ–componentDidUpdate ç”Ÿå‘½å‘¨æœŸé’©å­è§¦å‘å‰æ›´æ–°</p>
<h3 id="ç»„ä»¶é—´ä¼ é€’å›è°ƒå½¢å¼ref"><a href="#ç»„ä»¶é—´ä¼ é€’å›è°ƒå½¢å¼ref" class="headerlink" title="ç»„ä»¶é—´ä¼ é€’å›è°ƒå½¢å¼ref"></a>ç»„ä»¶é—´ä¼ é€’å›è°ƒå½¢å¼ref</h3><p><strong>this.inputText æŒ‡ä»£äº† input DOM</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Child = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;props.InputRef&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">// åœ¨çˆ¶ç»„ä»¶ä¸­ï¼ŒinputText å°±æ˜¯ å­ç»„ä»¶çš„å¼•ç”¨</span></span><br><span class="line"><span class="xml">class Parent extends React.Component &#123;</span></span><br><span class="line"><span class="xml">  constructor(props) &#123;</span></span><br><span class="line"><span class="xml">    super(props);</span></span><br><span class="line"><span class="xml">    this.inputText = null;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  componentDidMount() &#123;</span></span><br><span class="line"><span class="xml">    this.inputText.value = "hello";</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  render() &#123;</span></span><br><span class="line">    return &lt;Child InputRef=&#123;el =&gt; (this.inputText = el)&#125; /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><p><a href="https://swizec.com/blog/ref-callbacks-measure-react-component-size/swizec/8444" target="_blank" rel="noopener">ref callback å®ä¾‹</a></p>
<h4 id="ä½¿ç”¨-ref-callback-æµ‹é‡-component-size"><a href="#ä½¿ç”¨-ref-callback-æµ‹é‡-component-size" class="headerlink" title="ä½¿ç”¨ ref callback æµ‹é‡ component size"></a>ä½¿ç”¨ ref callback æµ‹é‡ component size</h4><p>å·¥ä½œè¿‡ç¨‹</p>
<ul>
<li>React æ¸²æŸ“ç»„ä»¶ </li>
<li>æµè§ˆå™¨å¸ƒå±€</li>
<li>è§¦å‘ ref callback</li>
<li>ä½¿ç”¨ getBoundingClientRect è·å¾—å…ƒç´ å°ºå¯¸</li>
<li>ä½¿ç”¨è·å¾—çš„å°ºå¯¸</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// class ç»„ä»¶ä¸­çš„æ–¹æ³•ï¼Œconstructor ä¸­çš„å®šä¹‰éœ€è¦å†™ thisï¼Œå…¶ä½™åœ°æ–¹ä¸éœ€è¦</span></span><br><span class="line">  refCallback = <span class="function"><span class="params">el</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (el) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(el.getBoundingClientRect());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.refCallback&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å½“ react æ”¾ç½®æ­¤å…ƒç´ åï¼Œè°ƒç”¨ refCallback , el æ˜¯å¯¹å·²æ”¾ç½®åœ¨é¡µé¢ä¸Š DOM å…ƒç´ çš„å¼•ç”¨</p>
<p>ç›®å‰çœ‹ä¸Šå»å¥½åƒä¸ componentDidMount å·®ä¸å¤šï¼Œä½†æ˜¯å½“ä½ çš„ç»„ä»¶ï¼Œåœ¨æ²¡æœ‰ remount çš„æƒ…å†µä¸‹ï¼Œæ”¹å˜äº†å°ºå¯¸ï¼Œ å°±ä¸å¾—ä¸é€šè¿‡ componentDidUpdate é‡æ–°è®¡ç®—ï¼Œä½†æ˜¯è¿™ä¼š é™·å…¥ æ— é™é€’å½’é™·é˜± ğŸ§<strong>componetdidupdateä¸­æ‰§è¡ŒsetState</strong></p>
<p>ä½¿ç”¨ ref callback ğŸ‘‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReportSize</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    text: faker.lorem.paragraphs(<span class="built_in">Math</span>.random() * <span class="number">10</span>)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  shuffle = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.doReportSize = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      text: faker.lorem.paragraphs(<span class="built_in">Math</span>.random() * <span class="number">10</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  refCallback = <span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (element) &#123;</span><br><span class="line">      <span class="keyword">this</span>.elementRef = element;</span><br><span class="line">      <span class="keyword">this</span>.props.getSize(element.getBoundingClientRect());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.doReportSize) &#123;</span><br><span class="line">      <span class="keyword">this</span>.props.getSize(<span class="keyword">this</span>.elementRef.getBoundingClientRect());</span><br><span class="line">      <span class="keyword">this</span>.doReportSize = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; text &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div ref=&#123;<span class="keyword">this</span>.refCallback&#125; style=&#123;&#123; <span class="attr">border</span>: <span class="string">"1px solid red"</span> &#125;&#125;&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.shuffle&#125;&gt;Shuffle&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;p&gt;&#123;text&#125;&lt;/</span>p&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>æ¢é’±çš„æœ€å°‘è´§å¸æ•°</title>
    <url>/2020/02/19/%E6%8D%A2%E9%92%B1%E7%9A%84%E6%9C%80%E5%B0%91%E8%B4%A7%E5%B8%81%E6%95%B0/</url>
    <content><![CDATA[<p>dp[i][j] çš„å«ä¹‰ï¼Œåœ¨å¯ä»¥ä»»æ„ä½¿ç”¨ arr[0â€¦i]è´§å¸çš„æƒ…å†µä¸‹ï¼Œç»„æˆ j æ‰€éœ€è¦çš„æœ€å°‘å¼ æ•°<br>dp[i][j] = min{ dp[i-1][j], dp[i][j-arr[i]+1]}</p>
<a id="more"></a>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>æ–æ³¢é‚£å¥‘æ•°åˆ—</title>
    <url>/2020/02/18/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/</url>
    <content><![CDATA[<p>æ–æ³¢é‚£å¥‘æ•°åˆ—è§„åˆ™ ï¼š <code>F(N) = F(N-1) + F(N-2)</code><br>æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸º 1ã€1ã€2ã€3â€¦â€¦</p>
<a id="more"></a>
<p>ğŸ‘‡æ™®é€šè§£æ³•ï¼Œå¤æ‚åº¦O(2^n)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Fibonacci(n - <span class="number">1</span>) + Fibonacci(n - <span class="number">2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‡å°¾é€’å½’ä¼˜åŒ–ï¼Œå¤æ‚åº¦O(2^n)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span>(<span class="params">n, sum1 = <span class="number">1</span>, sum2 = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">3</span>) <span class="keyword">return</span> sum2</span><br><span class="line">    <span class="keyword">return</span> Fibonacci(n - <span class="number">1</span>, sum2, sum1 + sum2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ‘‡ä»å·¦åˆ°å³ä¾æ¬¡æ±‚å‡ºæ¯ä¸€é¡¹çš„å€¼ï¼Œé€šè¿‡é¡ºåºè®¡ç®—æ±‚ç¬¬Né¡¹å³å¯ï¼Œç®—æ³•å¤æ‚åº¦O(N)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> pre = <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">3</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        tmp = res</span><br><span class="line">        res = res + pre</span><br><span class="line">        pre = tmp</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>çŸ©é˜µçš„æœ€å°è·¯å¾„å’Œ</title>
    <url>/2020/02/19/%E7%9F%A9%E9%98%B5%E7%9A%84%E6%9C%80%E5%B0%8F%E8%B7%AF%E5%BE%84%E5%92%8C/</url>
    <content><![CDATA[<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>æ€è·¯ï¼šdp[i][j]çš„å€¼è¡¨ç¤ºä»å·¦ä¸Šè§’çš„ä½ç½®èµ°åˆ°(i, j)ä½ç½®çš„æœ€å°è·¯å¾„å’Œ</p>
<a id="more"></a>
<p>ğŸ‘‡js å®šä¹‰äºŒç»´æ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create2DArray</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>(m)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        arr[i] = <span class="built_in">Array</span>(n)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Array(m)ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ empty ,å¿…é¡»è¦åŠ ä¸Šfill,æ‰èƒ½æ­£å¸¸ map</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create2DArray</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> twoDArray = <span class="built_in">Array</span>(m).fill([]).map(<span class="function"><span class="params">_</span> =&gt;</span> <span class="built_in">Array</span>(n))</span><br><span class="line">    <span class="keyword">return</span> twoDArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ğŸ‘‡åŠ¨æ€è§„åˆ’è§£æ³•ï¼šä»¥ç©ºé—´æ¢æ—¶é—´</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> m = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">8</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minPathSum</span>(<span class="params">m</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!m || m.length === <span class="number">0</span> || !m[<span class="number">0</span>] || m[<span class="number">0</span>].length === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">const</span> row = m.length</span><br><span class="line">    <span class="keyword">const</span> col = m[<span class="number">0</span>].length</span><br><span class="line">    <span class="comment">// js å®šä¹‰äºŒç»´æ•°ç»„</span></span><br><span class="line">    <span class="keyword">let</span> dp = create2DArray(row, col)</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = m[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; row; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = dp[i - <span class="number">1</span>][<span class="number">0</span>] + m[i][<span class="number">0</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; col; j++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = dp[<span class="number">0</span>][j - <span class="number">1</span>] + m[<span class="number">0</span>][j]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; row; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; col; j++) &#123;</span><br><span class="line">            dp[i][j] = <span class="built_in">Math</span>.min(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>]) + m[i][j]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[row - <span class="number">1</span>][col - <span class="number">1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>çŸ©é˜µä¸­ä¸€å…±æœ‰ M<em>N ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®éƒ½è®¡ç®—ä¸€æ¬¡ä»(0,0)ä½ç½®åˆ°è¾¾è‡ªå·±çš„æœ€å°è·¯å¾„å’Œï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(M</em>N)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(M*N)</p>
<h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>å‹ç¼©ç©ºé—´ O(M*N) -&gt; O(min{M,N})</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minPathSum</span>(<span class="params">m</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!m || m.length === <span class="number">0</span> || !m[<span class="number">0</span>] || m[<span class="number">0</span>].length === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">const</span> row = m.length</span><br><span class="line">    <span class="keyword">const</span> col = m[<span class="number">0</span>].length</span><br><span class="line">    <span class="keyword">const</span> more = <span class="built_in">Math</span>.max(row, col)</span><br><span class="line">    <span class="keyword">const</span> less = <span class="built_in">Math</span>.min(row, col)</span><br><span class="line">    <span class="keyword">const</span> rowMore = more === row</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>(less)</span><br><span class="line">    arr[<span class="number">0</span>] = m[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; less; i++) &#123;</span><br><span class="line">      arr[i] = arr[i - <span class="number">1</span>] + (rowMore ? m[<span class="number">0</span>][i] : m[i][<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; more; i++) &#123;</span><br><span class="line">      arr[<span class="number">0</span>] = arr[<span class="number">0</span>] + rowMore ? m[i][<span class="number">0</span>] : m[<span class="number">0</span>][i]</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; less; j++) &#123;</span><br><span class="line">        arr[j] = <span class="built_in">Math</span>.min(arr[j - <span class="number">1</span>], arr[j]) + (rowMore ? m[i][j] : m[j][i])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr[less - <span class="number">1</span>]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ€é•¿é€’å¢å­åºåˆ—</title>
    <url>/2020/02/19/%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97/</url>
    <content><![CDATA[<p>ç”Ÿæˆé•¿åº¦ä¸º N çš„æ•°ç»„dpï¼Œdp[i]è¡¨ç¤ºåœ¨arr[i] è¿™ä¸ªæ•°ç»“å°¾çš„æƒ…å†µä¸‹ï¼Œarr[0â€¦i] ä¸­çš„æœ€é•¿é€’å½’å­åºåˆ—</p>
<p>å¦‚æœæœ€é•¿é€’å½’å­åºåˆ—ä»¥arr[i]ç»“å°¾ï¼Œé‚£ä¹ˆåœ¨arr[0â€¦i]ä¸­æ‰€æœ‰æ¯”arr[i]å°çš„æ•°ï¼Œéƒ½å¯ä»¥ä½œä¸ºå€’æ•°ç¬¬äºŒä¸ªæ•°ã€‚åœ¨è¿™ä¹ˆå¤šå€’æ•°ç¬¬äºŒä¸ªæ•°çš„é€‰æ‹©ä¸­ï¼Œä»¥å“ªä¸ªæ•°ç»“å°¾çš„æœ€å¤§é€’å¢å­åºåˆ—æ›´å¤§ï¼Œå°±é€‰å“ªä¸ªæ•°ä½œä¸ºå€’æ•°ç¬¬äºŒä¸ªæ•°ã€‚</p>
<a id="more"></a>

<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">increNum</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> len = arr.length</span><br><span class="line">    <span class="keyword">let</span> dp = <span class="built_in">Array</span>(len)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        dp[i] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] &gt; arr[j]) &#123;</span><br><span class="line">                dp[i] = <span class="built_in">Math</span>.max(dp[i], dp[j] + <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æ ¹æ®dpï¼Œæ±‚å‡ºdpçš„æœ€é•¿é€’å¢å­åºåˆ—</p>
<ol>
<li>æ‰¾åˆ° dp ä¸­çš„æœ€å¤§å€¼çš„ä½ç½® index</li>
<li>ä» index å‘å·¦éå†ï¼Œå¦‚æœæ—¢æœ‰ arr[index] &gt; arr[i], åˆæœ‰ dp[i] + 1 = dp[index], i å³ä¸ºæ‰€æ±‚</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generateLIS</span>(<span class="params">arr, dp</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æœ€é•¿é€’å¢å­åºåˆ—é•¿åº¦</span></span><br><span class="line">    <span class="keyword">let</span> len = <span class="number">0</span></span><br><span class="line">    <span class="comment">// æœ€å¤§å€¼æ‰€åœ¨ä½ç½®</span></span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; dp.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dp[i] &gt; len) &#123;</span><br><span class="line">            index = i</span><br><span class="line">            len = dp[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> lis = <span class="built_in">Array</span>(len)</span><br><span class="line">    lis[--len] = arr[index]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = index; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &lt; arr[index] &amp;&amp; dp[i] + <span class="number">1</span> === dp[index]) &#123;</span><br><span class="line">            lis[--len] = arr[i]</span><br><span class="line">            index = i</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lis</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!arr || arr.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> dp = increNum(arr)</span><br><span class="line">    <span class="keyword">return</span> generateLIS(arr, dp)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—dpæ•°ç»„çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼ŒgenerateLISæ—¶é—´å¤æ‚åº¦ä¸ºO(N)ï¼Œæ‰€ä»¥æ•´ä¸ªè¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)</p>
<h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>ğŸ˜“ <strong>æœªå®Œæˆ</strong><br>é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ¥è¿›è¡Œä¼˜åŒ–ã€‚æ—¶é—´å¤æ‚åº¦O(NlogN)</p>
<ol>
<li>å…ˆç”Ÿæˆé•¿åº¦ä¸º N çš„æ•°ç»„ endsï¼Œåˆå§‹æ—¶ ends[0] = arr[0]ï¼Œå…¶ä»–ä½ç½®ä¸Šçš„å€¼ä¸º 0</li>
<li>ç”Ÿæˆæ•´å‹å˜é‡rightï¼Œåˆå§‹æ—¶right = 0</li>
<li>ends[0â€¦right] ä¸ºæœ‰æ•ˆåŒºï¼Œends[right+1â€¦N-1] ä¸ºæ— æ•ˆåŒº</li>
<li>å¯¹æœ‰æ•ˆåŒºä¸Šçš„ä½ç½®bï¼Œå¦‚æœæœ‰ ends[b] == cï¼Œè¡¨ç¤ºåˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æ‰€æœ‰é•¿åº¦ä¸ºb+1çš„é€’å¢åºåˆ—ä¸­ï¼Œæœ€å°çš„ç»“å°¾æ•°ä¸ºc</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">increNum</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> len = arr.length</span><br><span class="line">  <span class="keyword">let</span> dp = <span class="built_in">Array</span>(len)</span><br><span class="line">  <span class="keyword">let</span> ends = <span class="built_in">Array</span>(len)</span><br><span class="line">  ends[<span class="number">0</span>] = arr[<span class="number">0</span>]</span><br><span class="line">  dp[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> right = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> l = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> r = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> m = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">    l = <span class="number">0</span>;</span><br><span class="line">    r = right</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">      m = <span class="built_in">Math</span>.floor((l + r) / <span class="number">2</span>)</span><br><span class="line">      <span class="keyword">if</span> (arr[i] &gt; ends[m]) &#123;</span><br><span class="line">        l = m + l</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        l = m - l</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    right = <span class="built_in">Math</span>.max(right, l)</span><br><span class="line">    ends[l] = arr[i]</span><br><span class="line">    dp[i] = l + <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> dp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>æ±‰è¯ºå¡”é—®é¢˜</title>
    <url>/2020/02/19/%E6%B1%89%E8%AF%BA%E5%A1%94%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h3 id="æ±‰è¯ºå¡”é—®é¢˜"><a href="#æ±‰è¯ºå¡”é—®é¢˜" class="headerlink" title="æ±‰è¯ºå¡”é—®é¢˜"></a>æ±‰è¯ºå¡”é—®é¢˜</h3><p>é—®é¢˜ï¼šå‡è®¾æœ‰ from æŸ±å­ï¼Œmid æŸ±å­ï¼ŒtoæŸ±å­ï¼Œéƒ½åœ¨fromçš„åœ†ç›˜1~iå®Œå…¨ç§»åŠ¨åˆ°toï¼Œæœ€ä¼˜è§£ä¸ºï¼š </p>
<ol>
<li>åœ†ç›˜1~i-1ä»fromç§»åŠ¨åˆ°mid</li>
<li>åœ†ç›˜iä»from ç§»åŠ¨åˆ°to</li>
<li>1~i-1ä»mid ç§»åŠ¨åˆ°to</li>
</ol>
<a id="more"></a>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hanoi</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">        func(n, <span class="string">"left"</span>, <span class="string">"mid"</span>, <span class="string">"right"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">n, from, mid, to</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"move from "</span> + <span class="keyword">from</span> + <span class="string">" to "</span> + to)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        func(n - <span class="number">1</span>, <span class="keyword">from</span>, to, mid)</span><br><span class="line">        func(<span class="number">1</span>, <span class="keyword">from</span>, mid, to)</span><br><span class="line">        func(n - <span class="number">1</span>, mid, <span class="keyword">from</span>, to)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¿›é˜¶é—®é¢˜"><a href="#è¿›é˜¶é—®é¢˜" class="headerlink" title="è¿›é˜¶é—®é¢˜"></a>è¿›é˜¶é—®é¢˜</h3><p>æ±‚å½“å‰ä¸€å…±èµ°äº†å¤šå°‘æ­¥<br>ğŸ˜“ <strong>æœªå®Œæˆ</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!arr || arr.length === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> process(arr, arr.length - <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">arr, i, from, mid, to</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (i === <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (arr[i] !== <span class="keyword">from</span> &amp;&amp; arr[i] !== to) <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">  <span class="keyword">if</span> (arr[i] === <span class="keyword">from</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> process(arr, i - <span class="number">1</span>, <span class="keyword">from</span>, to, mid)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> rest = process(arr, i - <span class="number">1</span>, mid, <span class="keyword">from</span>, to)</span><br><span class="line">    <span class="keyword">if</span> (rest === <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; i + rest</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title>å‰ç«¯è¿›é˜¶</title>
    <url>/2020/01/12/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/</url>
    <content><![CDATA[<h3 id="æ•°ç»„APIï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰"><a href="#æ•°ç»„APIï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰" class="headerlink" title="æ•°ç»„APIï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰"></a>æ•°ç»„APIï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰</h3><p>splice/reverse/fill/copyWithin/sort/push/pop/unshift/shift</p>
<h3 id="æ•°ç»„APIï¼ˆä¸æ”¹å˜åŸæ•°ç»„ï¼‰"><a href="#æ•°ç»„APIï¼ˆä¸æ”¹å˜åŸæ•°ç»„ï¼‰" class="headerlink" title="æ•°ç»„APIï¼ˆä¸æ”¹å˜åŸæ•°ç»„ï¼‰"></a>æ•°ç»„APIï¼ˆä¸æ”¹å˜åŸæ•°ç»„ï¼‰</h3><p>slice/map/forEach/every/filter/reduce/entries/find</p>
<a id="more"></a>
<h3 id="reactä¸ºä½•åˆå¹¶å¤šä¸ªsetState"><a href="#reactä¸ºä½•åˆå¹¶å¤šä¸ªsetState" class="headerlink" title="reactä¸ºä½•åˆå¹¶å¤šä¸ªsetState"></a>reactä¸ºä½•åˆå¹¶å¤šä¸ªsetState</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;reactä¸ºäº†æé«˜æ•´ä½“çš„æ¸²æŸ“æ€§èƒ½ï¼Œä¼šå°†ä¸€æ¬¡æ¸²æŸ“å‘¨æœŸä¸­çš„stateè¿›è¡Œåˆå¹¶ï¼Œåœ¨è¿™ä¸ªæ¸²æŸ“å‘¨æœŸä¸­ä½ å¯¹æ‰€æœ‰setStateçš„æ‰€æœ‰è°ƒç”¨éƒ½ä¼šè¢«åˆå¹¶èµ·æ¥ä¹‹åï¼Œå†ä¸€æ¬¡æ€§çš„æ¸²æŸ“ï¼Œè¿™æ ·å¯ä»¥é¿å…é¢‘ç¹çš„è°ƒç”¨setStateå¯¼è‡´é¢‘ç¹çš„æ“ä½œdomï¼Œæé«˜æ¸²æŸ“æ€§èƒ½ã€‚å…·ä½“çš„å®ç°æ–¹é¢ï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºreactä¸­å­˜åœ¨ä¸€ä¸ªçŠ¶æ€å˜é‡isBatchingUpdatesï¼Œå½“å¤„äºæ¸²æŸ“å‘¨æœŸå¼€å§‹æ—¶ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«è®¾ç½®æˆtrueï¼Œæ¸²æŸ“å‘¨æœŸç»“æŸæ—¶ï¼Œä¼šè¢«è®¾ç½®æˆfalseï¼Œreactä¼šæ ¹æ®è¿™ä¸ªçŠ¶æ€å˜é‡ï¼Œå½“å‡ºåœ¨æ¸²æŸ“å‘¨æœŸä¸­æ—¶ï¼Œä»…ä»…åªæ˜¯å°†å½“å‰çš„æ”¹å˜ç¼“å­˜èµ·æ¥ï¼Œç­‰åˆ°æ¸²æŸ“å‘¨æœŸç»“æŸæ—¶ï¼Œå†ä¸€æ¬¡æ€§çš„å…¨éƒ¨renderã€‚</p>
<h3 id="react-diff-åŸç†"><a href="#react-diff-åŸç†" class="headerlink" title="react diff åŸç†"></a>react diff åŸç†</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;æŠŠæ ‘å½¢ç»“æ„æŒ‰ç…§å±‚çº§åˆ†è§£ï¼Œåªæ¯”è¾ƒåŒçº§å…ƒç´ ã€‚</p>
<p>ç»™åˆ—è¡¨ç»“æ„çš„æ¯ä¸ªå•å…ƒæ·»åŠ å”¯ä¸€çš„ key å±æ€§ï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚</p>
<p>React åªä¼šåŒ¹é…ç›¸åŒ class çš„ componentï¼ˆè¿™é‡Œé¢çš„ class æŒ‡çš„æ˜¯ç»„ä»¶çš„åå­—ï¼‰ åˆå¹¶æ“ä½œï¼Œè°ƒç”¨ component çš„ setState æ–¹æ³•çš„æ—¶å€™, React å°†å…¶æ ‡è®°ä¸º dirty.åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸ, React æ£€æŸ¥æ‰€æœ‰æ ‡è®° dirty çš„ component é‡æ–°ç»˜åˆ¶.</p>
<p>é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“ã€‚å¼€å‘äººå‘˜å¯ä»¥é‡å†™ shouldComponentUpdate æé«˜ diff çš„æ€§èƒ½ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè™šæ‹Ÿ-dom-ä¼šæé«˜æ€§èƒ½"><a href="#ä¸ºä»€ä¹ˆè™šæ‹Ÿ-dom-ä¼šæé«˜æ€§èƒ½" class="headerlink" title="ä¸ºä»€ä¹ˆè™šæ‹Ÿ dom ä¼šæé«˜æ€§èƒ½?"></a>ä¸ºä»€ä¹ˆè™šæ‹Ÿ dom ä¼šæé«˜æ€§èƒ½?</h3><p>è™šæ‹Ÿ dom ç›¸å½“äºåœ¨ js å’ŒçœŸå® dom ä¸­é—´åŠ äº†ä¸€ä¸ªç¼“å­˜ï¼Œåˆ©ç”¨ dom diff ç®—æ³•é¿å…äº†æ²¡æœ‰å¿…è¦çš„ dom æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</p>
<p>ç”¨ JavaScript å¯¹è±¡ç»“æ„è¡¨ç¤º DOM æ ‘çš„ç»“æ„ï¼›ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’åˆ°æ–‡æ¡£å½“ä¸­å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€æ£µæ–°çš„å¯¹è±¡æ ‘ã€‚ç„¶åç”¨æ–°çš„æ ‘å’Œæ—§çš„æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè®°å½•ä¸¤æ£µæ ‘å·®å¼‚æŠŠ 2 æ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åˆ°æ­¥éª¤ 1 æ‰€æ„å»ºçš„çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº†ã€‚<br>æ˜“é”™ç‚¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i)</span><br><span class="line">        &#125;)(i)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è·å–liæ ‡ç­¾ä¸­å†…å®¹"><a href="#è·å–liæ ‡ç­¾ä¸­å†…å®¹" class="headerlink" title="è·å–liæ ‡ç­¾ä¸­å†…å®¹"></a>è·å–liæ ‡ç­¾ä¸­å†…å®¹</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"getTestLi()"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>ç¬¬ä¸€è¡Œ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>ç¬¬äºŒè¡Œ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>ç¬¬ä¸‰è¡Œ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">getTestLi</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> objULi = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>).getElementsByTagName(<span class="string">'li'</span>);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; objULi.length; i++) &#123;</span></span><br><span class="line"><span class="actionscript">                objULi[i].onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                    alert(<span class="keyword">this</span>.innerHTML);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>location.reload([bForceGet])</code><br>å‚æ•°ï¼šbForceGet å¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸º falseï¼Œä»å®¢æˆ·ç«¯ç¼“å­˜é‡Œå–å½“å‰é¡µã€‚true, åˆ™ä»¥ GET æ–¹å¼ï¼Œä»æœåŠ¡ç«¯å–æœ€æ–°çš„é¡µé¢, ç›¸å½“äºå®¢æˆ·ç«¯ç‚¹å‡» F5(â€œåˆ·æ–°â€)ã€‚<br>å®é™…åº”ç”¨ä¸­ï¼Œå½“åˆ·æ–°é¡µé¢æ—¶ï¼Œé€šå¸¸ä½¿ç”¨location.reload()æˆ–è€…history.go(0).</p>
<h3 id="ä»€ä¹ˆæ˜¯é—­åŒ…"><a href="#ä»€ä¹ˆæ˜¯é—­åŒ…" class="headerlink" title="ä»€ä¹ˆæ˜¯é—­åŒ…"></a>ä»€ä¹ˆæ˜¯é—­åŒ…</h3><p>é—­åŒ…å°±æ˜¯èƒ½å¤Ÿè¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ã€‚</p>
<ul>
<li>é—­åŒ…çš„ç‰¹æ€§ï¼š</li>
</ul>
<ol>
<li>ä½œä¸ºå‡½æ•°å˜é‡çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå½“å‡½æ•°è¿”å›æ—¶ï¼Œå…¶å¤„äºæ¿€æ´»çŠ¶æ€</li>
<li>é—­åŒ…å°±æ˜¯å½“ä¸€ä¸ªå‡½æ•°è¿”å›æ—¶ï¼Œå¹¶æ²¡æœ‰é‡Šæ”¾èµ„æºçš„æ ˆåŒº</li>
</ol>
<ul>
<li>é—­åŒ…çš„åŸç†ï¼š</li>
</ul>
<p>å› ä¸ºé—­åŒ…åªæœ‰åœ¨è¢«è°ƒç”¨æ—¶æ‰æ‰§è¡Œæ“ä½œï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«ç”¨æ¥å®šä¹‰æ§åˆ¶ç»“æ„ï¼Œå¤šä¸ªå‡½æ•°å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªç›¸åŒçš„ç¯å¢ƒï¼Œè¿™ä½¿å¾—ä»–ä»¬å¯é€šè¿‡æ”¹å˜é‚£ä¸ªç¯å¢ƒç›¸äº’äº¤æµ</p>
<ul>
<li>é—­åŒ…ä½¿ç”¨åœºæ™¯ï¼š</li>
</ul>
<ol>
<li>é‡‡ç”¨å‡½æ•°å¼•ç”¨æ–¹å¼çš„setTimeoutè°ƒç”¨</li>
<li>å°†å‡½æ•°å…³è”åˆ°å¯¹è±¡çš„å®ä¾‹æ–¹æ³•</li>
<li>å°è£…ç›¸å…³çš„åŠŸèƒ½</li>
</ol>
<ul>
<li>é—­åŒ…çš„å¥½å¤„ï¼š</li>
</ul>
<ol>
<li>é€»è¾‘è¿ç»­ï¼Œå½“é—­åŒ…ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨å‚æ•°æ—¶ï¼Œé¿å…è„±ç¦»å½“å‰é€»è¾‘äºŒå•ç‹¬ç¼–å†™é¢å¤–é€»è¾‘</li>
<li>æ–¹ä¾¿è°ƒç”¨ä¸Šä¸‹æ–‡çš„å±€éƒ¨å˜é‡ã€‚</li>
<li>åŠ å¼ºå°è£…ï¼Œå¯ä»¥è¾¾åˆ°å¯¹å˜é‡çš„ä¿æŠ¤ä½œç”¨</li>
</ol>
<p>é—­åŒ…çš„åå¤„ï¼šæµªè´¹å†…å­˜ï¼Œé—­åŒ…ä¸­çš„å˜é‡å¸¸é©»å†…å­˜ï¼Œå¯¹é—­åŒ…çš„ä½¿ç”¨ä¸å½“ä¼šé€ æˆæ— æ•ˆå†…å­˜çš„äº§ç”Ÿã€‚</p>
<h3 id="å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æœ‰ä½•ä¸åŒï¼Ÿ"><a href="#å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æœ‰ä½•ä¸åŒï¼Ÿ" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æœ‰ä½•ä¸åŒï¼Ÿ"></a>å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æœ‰ä½•ä¸åŒï¼Ÿ</h3><blockquote>
<p>æ ¹æœ¬ä¸Šçš„åŒºåˆ«ï¼šå‡½æ•°å¼ç»„ä»¶æ•è·äº†æ¸²æŸ“æ‰€ç”¨çš„å€¼ã€‚ï¼ˆFunction components capture the rendered values.ï¼‰</p>
</blockquote>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"myList"</span>).insertBefore(newItem, existingItem);</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹æ˜¯LeetCodeéƒ¨åˆ†ç®—æ³•é¢˜è§£</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//5. æœ€é•¿å›æ–‡ä¸² ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> longestPalindrome = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> dp = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</span><br><span class="line">        dp[i] = []</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> max = <span class="number">-1</span></span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; s.length; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i + k &lt; s.length; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> j = i + k</span><br><span class="line">            <span class="keyword">if</span> (k === <span class="number">0</span>) &#123;</span><br><span class="line">                dp[i][j] = <span class="literal">true</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[i] === s[j]) &#123;</span><br><span class="line">                    dp[i][j] === <span class="literal">true</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    dp[i][j] === <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[i][j] = (dp[i + <span class="number">1</span>][j - <span class="number">1</span>] &amp;&amp; s[i] === s[j]) ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (j - i &gt; max &amp;&amp; dp[i][j]) &#123;</span><br><span class="line">                max = j - i</span><br><span class="line">                str = s.substring(i, j + <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> fourSumCount = <span class="function"><span class="keyword">function</span>(<span class="params">A, B, C, D</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mp = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; C.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; D.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> sum = C[i] + D[j];</span><br><span class="line">            mp[sum] = mp[sum] + <span class="number">1</span> || <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; A.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; B.length; j++) &#123;</span><br><span class="line">            res += mp[<span class="number">-1</span> * (A[i] + B[j])] || <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//17. Letter Combinations of a Phone Number</span></span><br><span class="line"><span class="keyword">const</span> digitToLetters = &#123;</span><br><span class="line">    <span class="string">'2'</span>: <span class="string">'abc'</span>,</span><br><span class="line">    <span class="string">'3'</span>: <span class="string">'def'</span>,</span><br><span class="line">    <span class="string">'4'</span>: <span class="string">'ghi'</span>,</span><br><span class="line">    <span class="string">'5'</span>: <span class="string">'jkl'</span>,</span><br><span class="line">    <span class="string">'6'</span>: <span class="string">'mno'</span>,</span><br><span class="line">    <span class="string">'7'</span>: <span class="string">'pqrs'</span>,</span><br><span class="line">    <span class="string">'8'</span>: <span class="string">'tuv'</span>,</span><br><span class="line">    <span class="string">'9'</span>: <span class="string">'wxyz'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> letterCombinations = <span class="function"><span class="keyword">function</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (digits.length === <span class="number">0</span>) <span class="keyword">return</span> [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> queue = [<span class="string">''</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; digits.length; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> newQueue = [];</span><br><span class="line">        <span class="keyword">const</span> letters = digitToLetters[digits.charAt(i)];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; letters.length; j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; queue.length; k++)</span><br><span class="line">                newQueue.push(queue[k] + letters.charAt(j));</span><br><span class="line"></span><br><span class="line">        queue = newQueue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> queue;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//18 4Sum</span></span><br><span class="line"><span class="keyword">var</span> fourSum = <span class="function"><span class="keyword">function</span>(<span class="params">nums, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (nums.length == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">    nums.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> target2 = target - nums[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> target3 = target2 - nums[j];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> front = j + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">var</span> back = nums.length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (front &lt; back) &#123;</span><br><span class="line">                <span class="keyword">var</span> sum = nums[front] + nums[back];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (sum &lt; target3)</span><br><span class="line">                    front++;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (sum &gt; target3)</span><br><span class="line">                    back--;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> temp = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">4</span>);</span><br><span class="line">                    temp[<span class="number">0</span>] = nums[i];</span><br><span class="line">                    temp[<span class="number">1</span>] = nums[j];</span><br><span class="line">                    temp[<span class="number">2</span>] = nums[front];</span><br><span class="line">                    temp[<span class="number">3</span>] = nums[back];</span><br><span class="line">                    ret.push(temp);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">while</span> (front &lt; back &amp;&amp; nums[front] === temp[<span class="number">2</span>])</span><br><span class="line">                        front++;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">while</span> (front &lt; back &amp;&amp; nums[back] === temp[<span class="number">3</span>])</span><br><span class="line">                        back--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (j + <span class="number">1</span> &lt; nums.length &amp;&amp; nums[j + <span class="number">1</span>] === nums[j]) ++j;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i + <span class="number">1</span> &lt; nums.length &amp;&amp; nums[i + <span class="number">1</span>] === nums[i]) ++i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//19. Remove Nth Node From End of List</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeNthFromEnd</span>(<span class="params">head, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    removeNthFromEnd(head.next, n);</span><br><span class="line"></span><br><span class="line">    head.end = head.next &amp;&amp;</span><br><span class="line">        head.next.hasOwnProperty(<span class="string">'end'</span>) ? head.next.end + <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (head.end === n) &#123;</span><br><span class="line">        <span class="keyword">var</span> del = head.next;</span><br><span class="line">        head.next = head.next.next;</span><br><span class="line">        del.next = <span class="literal">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (head.end + <span class="number">1</span> === n) &#123;</span><br><span class="line">        <span class="keyword">return</span> head.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//20. Valid Parentheses</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validBraces</span>(<span class="params">braces</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> matches = &#123;</span><br><span class="line">        <span class="string">'('</span>: <span class="string">')'</span>,</span><br><span class="line">        <span class="string">'&#123;'</span>: <span class="string">'&#125;'</span>,</span><br><span class="line">        <span class="string">'['</span>: <span class="string">']'</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> stack = [];</span><br><span class="line">    <span class="keyword">var</span> currentChar;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; braces.length; i++) &#123;</span><br><span class="line">        currentChar = braces[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (matches[currentChar]) &#123; <span class="comment">// opening braces</span></span><br><span class="line">            stack.push(currentChar);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// closing braces</span></span><br><span class="line">            <span class="keyword">if</span> (currentChar !== matches[stack.pop()]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> stack.length === <span class="number">0</span>; <span class="comment">// any unclosed braces left?</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//21. Merge Two Sorted Lists</span></span><br><span class="line"><span class="keyword">var</span> mergeTwoLists = <span class="function"><span class="keyword">function</span>(<span class="params">h1, h2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!h1 || !h2) <span class="comment">// return the non-empty one</span></span><br><span class="line">        <span class="keyword">return</span> h1 || h2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (h1.val &gt; h2.val) <span class="comment">// swap to make sure h1 is always smaller than h2</span></span><br><span class="line">        [h1, h2] = [h2, h1]</span><br><span class="line"></span><br><span class="line">    h1.next = mergeTwoLists(h1.next, h2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> h1;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 22. Generate Parentheses</span></span><br><span class="line"><span class="keyword">var</span> generateParenthesis = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> leftArr = [],</span><br><span class="line">        rightArr = [],</span><br><span class="line">        count, result = [];</span><br><span class="line">    <span class="keyword">for</span> (count = <span class="number">0</span>; count &lt; n; count++) &#123;</span><br><span class="line">        leftArr.push(<span class="string">"("</span>);</span><br><span class="line">        rightArr.push(<span class="string">")"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">left, right, arr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (left &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (right &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> i;</span><br><span class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; right; i++) &#123;</span><br><span class="line">                    arr += <span class="string">")"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            result.push(arr);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        myFunction(left - <span class="number">1</span>, right + <span class="number">1</span>, arr + <span class="string">"("</span>);</span><br><span class="line">        <span class="keyword">if</span> (right &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            myFunction(left, right - <span class="number">1</span>, arr + <span class="string">")"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    myFunction(n - <span class="number">1</span>, <span class="number">1</span>, <span class="string">"("</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//24. Swap Nodes in Pairs</span></span><br><span class="line"><span class="keyword">var</span> swapPairs = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head || !head.next) <span class="keyword">return</span> head;</span><br><span class="line">    <span class="keyword">let</span> one = head;</span><br><span class="line">    head = one.next;</span><br><span class="line">    <span class="keyword">while</span> (one &amp;&amp; one.next) &#123;</span><br><span class="line">        <span class="keyword">let</span> three = one.next.next;</span><br><span class="line">        one.next.next = one;</span><br><span class="line">        one.next = three &amp;&amp; three.next ? three.next : three;</span><br><span class="line">        one = three;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//25. Reverse Nodes in k-Group</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverseKGroup</span>(<span class="params">head, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> tail = head;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; k; i++) &#123;</span><br><span class="line">        tail = tail.next;</span><br><span class="line">        <span class="keyword">if</span> (!tail) <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> next = tail.next;</span><br><span class="line">    tail.next = <span class="literal">null</span>;</span><br><span class="line">    reverse(head);</span><br><span class="line">    head.next = reverseKGroup(next, k);</span><br><span class="line">    <span class="keyword">return</span> tail;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">curr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prev = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (curr) &#123;</span><br><span class="line">        <span class="keyword">var</span> next = curr.next;</span><br><span class="line">        curr.next = prev;</span><br><span class="line">        prev = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> prev;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//27. Remove Element</span></span><br><span class="line"><span class="keyword">var</span> removeElement = <span class="function"><span class="keyword">function</span>(<span class="params">nums, val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> length = nums.length;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] === val) &#123;</span><br><span class="line">            nums.splice(i, <span class="number">1</span>);</span><br><span class="line">            length--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums.length;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//31. Next Permutation</span></span><br><span class="line"><span class="keyword">var</span> nextPermutation = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] &gt; nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x &gt;= i; x--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[x] &gt; nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(nums, i - <span class="number">1</span>, x);</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(nums, i, nums.length - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">a, m, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> t = a[m];</span><br><span class="line">        a[m] = a[n];</span><br><span class="line">        a[n] = t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">a, m, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; m &lt; n; m++, n--) &#123;</span><br><span class="line">            swap(a, m, n);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//39. Combination Sum</span></span><br><span class="line"><span class="keyword">var</span> combinationSum = <span class="function"><span class="keyword">function</span>(<span class="params">candidates, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">new</span> <span class="built_in">Array</span>(target + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> t = <span class="number">0</span>; t &lt;= target; t++) &#123;</span><br><span class="line">        res[t] = <span class="keyword">new</span> <span class="built_in">Array</span>(candidates.length);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; candidates.length; i++) &#123;</span><br><span class="line">            res[t][i] = [];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// res[t][i] = solutions of subproblem of target t and pick from candidates[0..i];</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// initialize</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; candidates.length; i++) &#123;</span><br><span class="line">        res[<span class="number">0</span>][i] = [</span><br><span class="line">            []</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> t = <span class="number">1</span>; t &lt;= target; t++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; candidates.length; i++) &#123;</span><br><span class="line">            <span class="comment">// solutions not start with candidates[i]</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                res[t][i - <span class="number">1</span>].forEach(<span class="function"><span class="params">way</span> =&gt;</span> &#123;</span><br><span class="line">                    res[t][i].push(way);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// solutions start with candidates[i]</span></span><br><span class="line">            <span class="keyword">if</span> (candidates[i] &lt;= t) &#123;</span><br><span class="line">                <span class="comment">// console.log(t + ", " + i);</span></span><br><span class="line">                res[t - candidates[i]][i].forEach(<span class="function"><span class="params">way</span> =&gt;</span> &#123;</span><br><span class="line">                    res[t][i].push(way.concat(candidates[i]));</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res[target][candidates.length - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//40. Combination Sum II</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">combinationSum2</span>(<span class="params">candidates, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res = []; <span class="comment">// [][]</span></span><br><span class="line">    <span class="keyword">var</span> prefix = [];</span><br><span class="line">    candidates.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line">    search(<span class="number">0</span>, target);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">    <span class="comment">// restä¸ºç›®æ ‡å€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params">idx, rest</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rest === <span class="number">0</span> &amp;&amp; idx === candidates.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.push(prefix.slice());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rest &lt; <span class="number">0</span> || idx === candidates.length) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        prefix.push(candidates[idx]);</span><br><span class="line">        search(idx + <span class="number">1</span>, rest - candidates[idx]);</span><br><span class="line">        prefix.pop();</span><br><span class="line">        <span class="keyword">if</span> (prefix[prefix.length - <span class="number">1</span>] !== candidates[idx]) &#123;</span><br><span class="line">            search(idx + <span class="number">1</span>, rest);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//40. Combination Sum II</span></span><br><span class="line"><span class="keyword">var</span> combinationSum = <span class="function"><span class="keyword">function</span>(<span class="params">candidates, target</span>) </span>&#123;</span><br><span class="line">    candidates = candidates.sort(<span class="function"><span class="keyword">function</span>(<span class="params">val1, val2</span>) </span>&#123; <span class="comment">// step 1</span></span><br><span class="line">        <span class="keyword">return</span> val1 &gt; val2 ? <span class="number">1</span> : val1 &lt; val2 ? <span class="number">-1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> solution = [];</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> pushVal = <span class="function"><span class="keyword">function</span>(<span class="params">solution, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; solution.length; ++i) &#123;</span><br><span class="line">            sum += solution[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (sum &gt; target) ? <span class="literal">true</span> : (sum == target &amp;&amp; solution.length == n) ? result.push(solution.slice(<span class="number">0</span>)) : <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> backTracking = <span class="function"><span class="keyword">function</span>(<span class="params">k, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (k != n) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; candidates.length; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; solution[k - <span class="number">1</span>] &gt; candidates[i]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                solution[k] = candidates[i];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (pushVal(solution, n)) &#123;</span><br><span class="line">                    solution.splice(solution.length - <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">arguments</span>.callee(k + <span class="number">1</span>, n);</span><br><span class="line"></span><br><span class="line">                solution.splice(solution.length - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">Math</span>.floor(target / candidates[<span class="number">0</span>]); ++i) &#123;</span><br><span class="line">        backTracking(<span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//46. Permutations</span></span><br><span class="line"><span class="keyword">var</span> permute = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> res = [];</span><br><span class="line">    backtrack(nums, res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">backtrack</span>(<span class="params">nums, res, n = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n === nums.length - <span class="number">1</span>) &#123;</span><br><span class="line">        res.push(nums.slice(<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = n; i &lt; nums.length; i++) &#123;</span><br><span class="line">        swap(nums, i, n);</span><br><span class="line">        backtrack(nums, res, n + <span class="number">1</span>);</span><br><span class="line">        swap(nums, i, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">nums, i, j</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//46. Permutations</span></span><br><span class="line"><span class="keyword">var</span> permute = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> results = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> permutations = <span class="function">(<span class="params">current, remaining</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (remaining.length &lt;= <span class="number">0</span>) results.push(current.slice());</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; remaining.length; i++) &#123; <span class="comment">// Loop through remaining elements</span></span><br><span class="line">                current.push(remaining[i]); <span class="comment">// Insert the iTH element onto the end of current</span></span><br><span class="line">                permutations(current.slice(), remaining.slice(<span class="number">0</span>, i).concat(remaining.slice(i + <span class="number">1</span>))); <span class="comment">// Recurse with inserted element removed</span></span><br><span class="line">                current.pop(); <span class="comment">// Remove last inserted element for next iteration</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    permutations([], nums);</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//48. Rotate Image</span></span><br><span class="line"><span class="keyword">var</span> rotate = <span class="function"><span class="keyword">function</span>(<span class="params">matrix</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; matrix.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = i; j &lt; matrix[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> temp = <span class="number">0</span>;</span><br><span class="line">            temp = matrix[i][j];</span><br><span class="line">            matrix[i][j] = matrix[j][i];</span><br><span class="line">            matrix[j][i] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; matrix.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; matrix.length / <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> temp = <span class="number">0</span>;</span><br><span class="line">            temp = matrix[i][j];</span><br><span class="line">            matrix[i][j] = matrix[i][matrix.length - <span class="number">1</span> - j];</span><br><span class="line">            matrix[i][matrix.length - <span class="number">1</span> - j] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 50. Pow(x,n)</span></span><br><span class="line"><span class="keyword">var</span> myPow = <span class="function"><span class="keyword">function</span>(<span class="params">x, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = n &gt; <span class="number">0</span> ? x : <span class="number">1</span> / x</span><br><span class="line">    n = <span class="built_in">Math</span>.abs(n)</span><br><span class="line">    <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">    <span class="keyword">var</span> pow = <span class="function">(<span class="params">x, n</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> result</span><br><span class="line">        <span class="keyword">if</span> (map.has(n)) &#123;</span><br><span class="line">            <span class="keyword">return</span> map.get(n)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">var</span> m = <span class="built_in">Math</span>.floor(n / <span class="number">2</span>)</span><br><span class="line">        result = pow(x, m) * pow(x, n - m)</span><br><span class="line">        map.set(n, result)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pow(x, n)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> myPow = <span class="function"><span class="keyword">function</span>(<span class="params">x, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span> / myPow(x, -n)</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> === <span class="number">0</span>) <span class="keyword">return</span> myPow(x * x, n / <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> myPow(x * x, <span class="built_in">Math</span>.floor(n / <span class="number">2</span>)) * x</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//53. Maximum Subarray</span></span><br><span class="line"><span class="keyword">var</span> maxSubArray = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> max_so_far = -<span class="literal">Infinity</span>;</span><br><span class="line">    <span class="keyword">let</span> max_here = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> val = nums[i];</span><br><span class="line">        max_here = <span class="built_in">Math</span>.max(val, max_here + val);</span><br><span class="line">        max_so_far = <span class="built_in">Math</span>.max(max_here, max_so_far);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> max_so_far;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> maxSubArray = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ans = nums[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> num <span class="keyword">of</span> nums) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            sum += num</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sum = num</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">Math</span>.max(ans, sum)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//56. Merge Intervals</span></span><br><span class="line"><span class="keyword">var</span> merge = <span class="function"><span class="keyword">function</span>(<span class="params">intervals</span>) </span>&#123;</span><br><span class="line">    intervals.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.start - b.start);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> intervals.reduce(<span class="function">(<span class="params">acc, interval</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (acc.length === <span class="number">0</span>) &#123;</span><br><span class="line">            acc.push(interval);</span><br><span class="line">            <span class="keyword">return</span> acc;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            start: curStart,</span><br><span class="line">            end: curEnd</span><br><span class="line">        &#125; = interval;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            start: lastStart,</span><br><span class="line">            end: lastEnd</span><br><span class="line">        &#125; = acc[acc.length - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (curStart &lt;= lastEnd) &#123;</span><br><span class="line">            <span class="keyword">const</span> newEnd = lastEnd &gt; curEnd ? lastEnd : curEnd;</span><br><span class="line">            acc[acc.length - <span class="number">1</span>] = <span class="keyword">new</span> Interval(lastStart, newEnd);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            acc.push(interval);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, []);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//61. Rotate List</span></span><br><span class="line"><span class="keyword">var</span> rotateRight = <span class="function"><span class="keyword">function</span>(<span class="params">head, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> size = <span class="number">1</span>,</span><br><span class="line">        curr = head,</span><br><span class="line">        positions,</span><br><span class="line">        counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (head === <span class="literal">null</span> || k &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (curr.next !== <span class="literal">null</span>) &#123;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    curr.next = head;</span><br><span class="line"></span><br><span class="line">    positions = <span class="built_in">Math</span>.abs(size - k % size) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    curr = head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (counter &lt; positions) &#123;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        counter++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    head = curr.next;</span><br><span class="line">    curr.next = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//61. Rotate List</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rotateRight</span>(<span class="params">head, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> before = &#123;</span><br><span class="line">        next: head</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> prev = before;</span><br><span class="line">    <span class="keyword">let</span> len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. get total length of list</span></span><br><span class="line">    <span class="keyword">for</span> (; prev.next; prev = prev.next, len++);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. connect original tail to head</span></span><br><span class="line">    <span class="comment">// eg. 1 -&gt; 2 -&gt; 3 -&gt; null</span></span><br><span class="line">    <span class="comment">// =&gt;  [1] -&gt; 2 -&gt; 3 -&gt; [1]</span></span><br><span class="line">    prev.next = head;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// find new head</span></span><br><span class="line">    <span class="keyword">for</span> (prev = before, k = len - k % len; k--; prev = prev.next);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cut the loop</span></span><br><span class="line">    <span class="keyword">let</span> newHead = prev.next;</span><br><span class="line">    prev.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> newHead;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 61. Rotate List</span></span><br><span class="line"><span class="keyword">var</span> rotateRight = <span class="function"><span class="keyword">function</span>(<span class="params">head, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> size = <span class="number">1</span>,</span><br><span class="line">        curr = head,</span><br><span class="line">        positions,</span><br><span class="line">        counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (head === <span class="literal">null</span> || k &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    <span class="keyword">while</span> (curr.next !== <span class="literal">null</span>) &#123;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line">    curr.next = head;</span><br><span class="line">    positions = <span class="built_in">Math</span>.abs(size - k % size) - <span class="number">1</span>;</span><br><span class="line">    curr = head;</span><br><span class="line">    <span class="keyword">while</span> (counter &lt; positions) &#123;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">        counter++;</span><br><span class="line">    &#125;</span><br><span class="line">    head = curr.next;</span><br><span class="line">    curr.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//62. Unique Paths</span></span><br><span class="line"><span class="keyword">const</span> createTwoDimenssionsArray = <span class="function"><span class="keyword">function</span> <span class="title">createTwoDimenssionsArray</span>(<span class="params">row, col, default_val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.apply(<span class="literal">null</span>, <span class="built_in">Array</span>(row)).map(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Array</span>.apply(<span class="literal">null</span>, <span class="built_in">Array</span>(col)).map(<span class="function"><span class="params">()</span> =&gt;</span> default_val);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> uniquePaths = <span class="function"><span class="keyword">function</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> dp = <span class="built_in">Array</span>(m)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        dp[i] = <span class="built_in">Array</span>(n)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][i] = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j] + dp[i][j - <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[m - <span class="number">1</span>][n - <span class="number">1</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// with 2D array</span></span><br><span class="line"><span class="keyword">var</span> uniquePaths = <span class="function"><span class="keyword">function</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span> || n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> res = createTwoDimenssionsArray(m, n, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            res[i][j] = res[i - <span class="number">1</span>][j] + res[i][j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res[m - <span class="number">1</span>][n - <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// with 1D array</span></span><br><span class="line"><span class="keyword">var</span> uniquePaths = <span class="function"><span class="keyword">function</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span> || n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="built_in">Array</span>.apply(<span class="literal">null</span>, <span class="built_in">Array</span>(n)).map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            res[j] = res[j - <span class="number">1</span>] + res[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res[n - <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//62. Unique Paths</span></span><br><span class="line"><span class="keyword">var</span> permutation = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (b &gt; a / <span class="number">2</span>) &#123;</span><br><span class="line">        b = a - b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> mula = <span class="number">1</span>,</span><br><span class="line">        mulb = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; b; i++) &#123;</span><br><span class="line">        mula = mula * (a - i);</span><br><span class="line">        mulb = mulb * (b - i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mula / mulb;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> uniquePaths = <span class="function"><span class="keyword">function</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> permutation(m - <span class="number">1</span> + n - <span class="number">1</span>, m - <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//66. Plus One</span></span><br><span class="line"><span class="keyword">var</span> plusOne = <span class="function"><span class="keyword">function</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length = digits.length;</span><br><span class="line">    <span class="keyword">let</span> i = length - <span class="number">1</span>;</span><br><span class="line">    digits[i]++;</span><br><span class="line">    <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; digits[i] &gt; <span class="number">9</span>) &#123;</span><br><span class="line">        digits[i] = <span class="number">0</span>;</span><br><span class="line">        digits[i - <span class="number">1</span>]++;</span><br><span class="line">        i--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i === <span class="number">0</span> &amp;&amp; digits[<span class="number">0</span>] &gt; <span class="number">9</span>) &#123;</span><br><span class="line">        digits[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        digits.unshift(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> digits;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> plusOne = <span class="function"><span class="keyword">function</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="number">0</span>;</span><br><span class="line">    digits[digits.length - <span class="number">1</span>]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = digits.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        digits[i] += s;</span><br><span class="line">        <span class="keyword">if</span> (digits[i] &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">            s = <span class="number">1</span>;</span><br><span class="line">            digits[i] = digits[i] - <span class="number">10</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            s = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s === <span class="number">1</span>) digits.unshift(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> digits;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> plusOne = <span class="function"><span class="keyword">function</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = digits.reverse()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] + <span class="number">1</span> === <span class="number">10</span>) &#123;</span><br><span class="line">            arr[i] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> (i === arr.length - <span class="number">1</span>) &#123;</span><br><span class="line">                arr[i + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            arr[i] = arr[i] + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.reverse()</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// åè½¬æ•°ç»„ç«Ÿç„¶è¿˜å¿«ä¸€ç‚¹ï¼Œæœ‰é—®é¢˜å§ï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line"><span class="keyword">var</span> plusOne = <span class="function"><span class="keyword">function</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = digits.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (digits[i] + <span class="number">1</span> === <span class="number">10</span>) &#123;</span><br><span class="line">            digits[i] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> (i === <span class="number">0</span>) &#123;</span><br><span class="line">                digits.unshift(<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            digits[i] = digits[i] + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> digits</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//67. Add Binary</span></span><br><span class="line"><span class="keyword">var</span> addBinary = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">var</span> i = a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> j = b.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> carry = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span> || carry &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        carry += i &gt;= <span class="number">0</span> ? <span class="built_in">parseInt</span>(a[i--]) : <span class="number">0</span>;</span><br><span class="line">        carry += j &gt;= <span class="number">0</span> ? <span class="built_in">parseInt</span>(b[j--]) : <span class="number">0</span>;</span><br><span class="line">        result = carry % <span class="number">2</span> + result;</span><br><span class="line">        carry = <span class="built_in">parseInt</span>(carry / <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> addBinary = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a1 = a.split(<span class="string">''</span>).reverse()</span><br><span class="line">    <span class="keyword">var</span> b1 = b.split(<span class="string">''</span>).reverse()</span><br><span class="line">    <span class="keyword">var</span> prefix = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (a1.length &lt; b1.length)[a1, b1] = [b1, a1]</span><br><span class="line">    <span class="keyword">var</span> res = a1.map(<span class="function">(<span class="params">n, i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> num = (b1[i] ? <span class="built_in">parseInt</span>(b1[i]) : <span class="number">0</span>) + prefix + <span class="built_in">parseInt</span>(n)</span><br><span class="line">        prefix = num &gt;= <span class="number">2</span> ? <span class="number">1</span> : <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> num % <span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> (prefix === <span class="number">1</span>) res.push(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> res.reverse().join(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//73. Set Matrix Zeroes</span></span><br><span class="line"><span class="keyword">var</span> setZeroes = <span class="function"><span class="keyword">function</span>(<span class="params">matrix</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = matrix.length;</span><br><span class="line">    <span class="keyword">var</span> l = matrix[<span class="number">0</span>].length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; r; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; l; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (matrix[i][j] === <span class="number">0</span> &amp;&amp; <span class="number">1</span> / matrix[i][j] === <span class="literal">Infinity</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="number">0</span>; x &lt; r; x++) &#123;</span><br><span class="line">                    matrix[x][j] = matrix[x][j] &amp;&amp; <span class="number">-0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> y = <span class="number">0</span>; y &lt; l; y++) &#123;</span><br><span class="line">                    matrix[i][y] = matrix[i][y] &amp;&amp; <span class="number">-0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//74. æœç´¢äºŒç»´çŸ©é˜µ</span></span><br><span class="line"><span class="keyword">var</span> searchMatrix = <span class="function"><span class="keyword">function</span>(<span class="params">matrix, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix.length === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; matrix.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (matrix[i].length === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        <span class="keyword">if</span> (target === <span class="built_in">Number</span>(matrix[i][<span class="number">0</span>]) || (<span class="built_in">Number</span>(matrix[i + <span class="number">1</span>]) &amp;&amp; target === <span class="built_in">Number</span>(matrix[i + <span class="number">1</span>][<span class="number">0</span>]))) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        <span class="keyword">if</span> (target &gt; <span class="built_in">Number</span>(matrix[i][<span class="number">0</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (matrix[i + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">Number</span>(matrix[i + <span class="number">1</span>][<span class="number">0</span>]) &gt; <span class="built_in">Number</span>(target)) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">1</span>; j &lt; matrix[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">Number</span>(matrix[i][j]) === target) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">1</span>; j &lt; matrix[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">Number</span>(matrix[i][j]) === target) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//75. Sort Colors</span></span><br><span class="line"><span class="keyword">var</span> sortColors = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    nums.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//78. å­é›†</span></span><br><span class="line"><span class="keyword">var</span> subsets = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            []</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> [num, ...restNums] = nums;</span><br><span class="line">    <span class="keyword">let</span> restSubSets = subsets(restNums);</span><br><span class="line">    <span class="keyword">return</span> restSubSets.map(<span class="function"><span class="params">set</span> =&gt;</span> [...set, num]).concat(restSubSets);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> subsets = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> ws = [</span><br><span class="line">        []</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>, len = ws.length; j &lt; len; ++j) &#123;</span><br><span class="line">            ws.push(ws[j].concat([nums[i]]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ws;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//82. Remove Duplicates from Sorted List II</span></span><br><span class="line"><span class="keyword">var</span> deleteDuplicates = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dummy = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">var</span> fast = head;</span><br><span class="line">    <span class="keyword">var</span> slow = dummy;</span><br><span class="line">    slow.next = fast;</span><br><span class="line">    <span class="keyword">while</span> (fast !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (fast.next !== <span class="literal">null</span> &amp;&amp; fast.val == fast.next.val) &#123;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (slow.next != fast) &#123;</span><br><span class="line">            slow.next = fast.next;</span><br><span class="line">            fast = slow.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//83. Remove Duplicates from Sorted List</span></span><br><span class="line"><span class="keyword">var</span> deleteDuplicates = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (head.next &amp;&amp; head.next.val === head.val) &#123;</span><br><span class="line">        head.next = head.next.next;</span><br><span class="line">    &#125;</span><br><span class="line">    deleteDuplicates(head.next);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//86. Partition List</span></span><br><span class="line"><span class="keyword">var</span> partition = <span class="function"><span class="keyword">function</span>(<span class="params">head, x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> beforeHead = &#123;</span><br><span class="line">        next: head</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> insertPosition = beforeHead,</span><br><span class="line">        prev = beforeHead,</span><br><span class="line">        node = head;</span><br><span class="line">    <span class="keyword">while</span> (node) &#123;</span><br><span class="line">        <span class="keyword">var</span> next = node.next;</span><br><span class="line">        <span class="keyword">if</span> (node.val &lt; x) &#123;</span><br><span class="line">            <span class="keyword">if</span> (insertPosition.next !== node) &#123;</span><br><span class="line">                prev.next = next;</span><br><span class="line">                node.next = insertPosition.next;</span><br><span class="line">                insertPosition.next = node;</span><br><span class="line">            &#125;</span><br><span class="line">            insertPosition = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prev = node;</span><br><span class="line">        &#125;</span><br><span class="line">        node = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> beforeHead.next;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//88. Merge Sorted Array</span></span><br><span class="line"><span class="keyword">var</span> merge = <span class="function"><span class="keyword">function</span>(<span class="params">nums1, m, nums2, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> nums1_index = m - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> nums2_index = n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> new_tail = m + n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (nums2_index &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums1_index &gt;= <span class="number">0</span> &amp;&amp; nums1[nums1_index] &gt; nums2[nums2_index]) &#123;</span><br><span class="line">            nums1[new_tail] = nums1[nums1_index];</span><br><span class="line">            nums1_index--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nums1[new_tail] = nums2[nums2_index];</span><br><span class="line">            nums2_index--;</span><br><span class="line">        &#125;</span><br><span class="line">        new_tail--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 90. Subsets II</span></span><br><span class="line"><span class="keyword">var</span> subsetsWithDup = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums === <span class="literal">null</span> || nums.length === <span class="number">0</span>) <span class="keyword">return</span> [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> res = [</span><br><span class="line">        []</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">var</span> map = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sort array to void duplicate</span></span><br><span class="line">    nums.sort();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (value <span class="keyword">of</span> nums) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> res) &#123;</span><br><span class="line">            <span class="keyword">var</span> temp = res[i].slice();</span><br><span class="line">            temp.push(value);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// transform into unique string using regx</span></span><br><span class="line">            <span class="keyword">var</span> str = temp.toString().replace(<span class="regexp">/\,/g</span>, <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// using object key to check duplicate</span></span><br><span class="line">            <span class="keyword">if</span> (!map[str]) &#123;</span><br><span class="line">                map[str] = <span class="literal">true</span>;</span><br><span class="line">                res.push(temp);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> subsetsWithDup = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    nums.sort();</span><br><span class="line">    <span class="keyword">var</span> res = [</span><br><span class="line">            []</span><br><span class="line">        ],</span><br><span class="line">        count,</span><br><span class="line">        subRes,</span><br><span class="line">        preLength;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        count = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (nums[i + <span class="number">1</span>] &amp;&amp; nums[i + <span class="number">1</span>] == nums[i]) &#123;</span><br><span class="line">            count += <span class="number">1</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        preLength = res.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; preLength; j++) &#123;</span><br><span class="line">            subRes = res[j].slice();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> x = <span class="number">1</span>; x &lt;= count; x++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (x &gt; <span class="number">0</span>) subRes.push(nums[i]);</span><br><span class="line">                res.push(subRes.slice());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//93. Restore IP Addresses</span></span><br><span class="line">restoreIP = <span class="function">(<span class="params">str, res = []</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (str.length == <span class="number">0</span> &amp;&amp; res.length == <span class="number">4</span>) <span class="keyword">return</span> <span class="built_in">console</span>.log(res)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">Math</span>.min(<span class="number">3</span>, str.length); i++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">parseInt</span>(str.slice(<span class="number">0</span>, i)) &lt; <span class="number">256</span>)</span><br><span class="line">            restoreIP(str.slice(i), res.concat(str.slice(<span class="number">0</span>, i)))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//95. Unique Binary Search Trees II</span></span><br><span class="line"><span class="keyword">var</span> copy = <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!node) <span class="keyword">return</span> node;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">new</span> TreeNode(node.val);</span><br><span class="line">    result.left = copy(node.left);</span><br><span class="line">    result.right = copy(node.right);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> generateTrees = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> levels = [<span class="literal">null</span>, [<span class="keyword">new</span> TreeNode(<span class="number">1</span>)]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> curLevel = levels[i] = [];</span><br><span class="line">        levels[i - <span class="number">1</span>].forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> tmp = <span class="keyword">new</span> TreeNode(i);</span><br><span class="line">            tmp.left = copy(item);</span><br><span class="line">            curLevel.push(tmp);</span><br><span class="line">            <span class="keyword">let</span> source = copy(item);</span><br><span class="line">            <span class="keyword">let</span> node = source;</span><br><span class="line">            <span class="keyword">while</span> (node) &#123;</span><br><span class="line">                <span class="keyword">let</span> oldRight = node.right;</span><br><span class="line">                node.right = <span class="keyword">new</span> TreeNode(i);</span><br><span class="line">                node.right.left = oldRight;</span><br><span class="line">                curLevel.push(copy(source));</span><br><span class="line">                node.right = oldRight;</span><br><span class="line">                node = node.right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> levels[n];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//104. Maximum Depth of Binary Tree</span></span><br><span class="line"><span class="keyword">var</span> maxDepth = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> left = maxDepth(root.left);</span><br><span class="line">    <span class="keyword">var</span> right = maxDepth(root.right);</span><br><span class="line">    <span class="keyword">return</span> (left == <span class="number">0</span> &amp;&amp; right == <span class="number">0</span>) ? <span class="number">1</span> + left + right : <span class="built_in">Math</span>.max(left, right) + <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//110. Balanced Binary Tree</span></span><br><span class="line"><span class="keyword">var</span> isBalanced = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> helper(root) !== <span class="number">-1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> helper = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> left = helper(root.left);</span><br><span class="line">    <span class="keyword">var</span> right = helper(root.right);</span><br><span class="line">    <span class="keyword">if</span> (left === <span class="number">-1</span> || right === <span class="number">-1</span> || <span class="built_in">Math</span>.abs(left - right) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + <span class="built_in">Math</span>.max(left, right);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//111. Minimum Depth of Binary Tree</span></span><br><span class="line"><span class="keyword">var</span> minDepth = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> left = minDepth(root.left);</span><br><span class="line">    <span class="keyword">var</span> right = minDepth(root.right);</span><br><span class="line">    <span class="keyword">return</span> (left == <span class="number">0</span> || right == <span class="number">0</span>) ? left + right + <span class="number">1</span> : <span class="built_in">Math</span>.min(left, right) + <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//112. Path Sum</span></span><br><span class="line"><span class="keyword">var</span> hasPathSum = <span class="function"><span class="keyword">function</span>(<span class="params">root, sum</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (root.left == <span class="literal">null</span> &amp;&amp; root.right == <span class="literal">null</span> &amp;&amp; sum - root.val == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> hasPathSum(root.left, sum - root.val) || hasPathSum(root.right, sum - root.val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//113. Path Sum II</span></span><br><span class="line"><span class="keyword">var</span> pathSum = <span class="function"><span class="keyword">function</span>(<span class="params">root, sum</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> res = [];</span><br><span class="line">    helper(root, res, [], <span class="number">0</span>, sum);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> helper = <span class="function"><span class="keyword">function</span>(<span class="params">root, res, path, curSum, sum</span>) </span>&#123;</span><br><span class="line">    path.push(root.val);</span><br><span class="line">    curSum += root.val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.left === <span class="literal">null</span> &amp;&amp; root.right === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curSum === sum) &#123;</span><br><span class="line">            res.push(path.slice());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.left) &#123;</span><br><span class="line">        helper(root.left, res, path, curSum, sum);</span><br><span class="line">        path.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (root.right) &#123;</span><br><span class="line">        helper(root.right, res, path, curSum, sum);</span><br><span class="line">        path.pop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//119. Pascal's Triangle II</span></span><br><span class="line"><span class="keyword">var</span> getRow = <span class="function"><span class="keyword">function</span>(<span class="params">rowIndex</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> tmp = [<span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">var</span> output = [<span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rowIndex == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">1</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (rowIndex == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt;= rowIndex; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">1</span>; j &lt; tmp.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> addCount = tmp[j - <span class="number">1</span>] + tmp[j];</span><br><span class="line">            output.splice(j, <span class="number">1</span>, addCount);</span><br><span class="line">        &#125;</span><br><span class="line">        output.push(<span class="number">1</span>);</span><br><span class="line">        tmp = output.slice(<span class="number">0</span>, output.length);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//129. Sum Root to Leaf Numbers</span></span><br><span class="line"><span class="keyword">var</span> sumNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum(root, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">n, s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (n == <span class="literal">null</span>) ? <span class="number">0</span> :</span><br><span class="line">            ((n.right == <span class="literal">null</span> &amp;&amp; n.left == <span class="literal">null</span>) ? s * <span class="number">10</span> + n.val :</span><br><span class="line">                sum(n.left, s * <span class="number">10</span> + n.val) + sum(n.right, s * <span class="number">10</span> + n.val));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 136. Single Number</span></span><br><span class="line"><span class="keyword">var</span> singleNumber = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> nums.reduce(<span class="function">(<span class="params">r, n</span>) =&gt;</span> r ^ n);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> singleNumber = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    nums.sort();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] != nums[i + <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> singleNumber = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> hash = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hash[nums[i]]) &#123;</span><br><span class="line">            hash[nums[i]] += <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hash[nums[i]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> h <span class="keyword">in</span> hash) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hash[h] === <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> +h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//141. Linked List Cycle</span></span><br><span class="line"><span class="keyword">var</span> hasCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head || !head.next) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> visited = <span class="built_in">Symbol</span>();</span><br><span class="line">    <span class="keyword">while</span> (head) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head[visited]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        head[visited] = <span class="literal">true</span>;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//141. Linked List Cycle</span></span><br><span class="line"><span class="keyword">var</span> hasCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span> || head.next == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> slow = head; <span class="comment">//slow pointer moves one step forward</span></span><br><span class="line">    <span class="keyword">var</span> fast = head; <span class="comment">//fast pointer moves two steps forward</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">//check if we reached the end of the list, --&gt; not cyclic</span></span><br><span class="line">        <span class="keyword">if</span> (fast.next == <span class="literal">null</span> || fast.next.next == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        <span class="comment">//because fast moves as twice as fast, if it is cyclic,</span></span><br><span class="line">        <span class="comment">//it must reach slow at some point</span></span><br><span class="line">        <span class="keyword">if</span> (fast === slow) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//142. Linked List Cycle II</span></span><br><span class="line"><span class="keyword">var</span> detectCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> __special__ = &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (head === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">helper</span>(<span class="params">head, headnext</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// console.log(head)</span></span><br><span class="line">        <span class="keyword">if</span> (head === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (headnext === __special__) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (headnext === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        head.next = __special__</span><br><span class="line">        <span class="keyword">var</span> result = helper(headnext, headnext.next);</span><br><span class="line">        head.next = headnext;</span><br><span class="line">        <span class="keyword">if</span> (head === result) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> helper(head, head.next)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//147. Insertion Sort List</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertionSortList</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> node = head.next</span><br><span class="line">    <span class="keyword">while</span> (node) &#123;</span><br><span class="line">        <span class="keyword">let</span> prev = head</span><br><span class="line">        <span class="keyword">while</span> (prev !== node &amp;&amp; prev.val &lt;= node.val) &#123;</span><br><span class="line">            prev = prev.next</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (prev === node) &#123;</span><br><span class="line">            <span class="comment">// everyting remains sorted in this pass</span></span><br><span class="line">            node = node.next</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> temp1 = node.val</span><br><span class="line">        <span class="keyword">let</span> temp2 = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">while</span> (prev) &#123;</span><br><span class="line">            <span class="keyword">if</span> (temp1 === <span class="literal">null</span>) &#123;</span><br><span class="line">                temp1 = prev.val</span><br><span class="line">                prev.val = temp2</span><br><span class="line">                temp2 = <span class="literal">null</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (temp2 === <span class="literal">null</span>) &#123;</span><br><span class="line">                temp2 = prev.val</span><br><span class="line">                prev.val = temp1</span><br><span class="line">                temp1 = <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (prev === node) &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            prev = prev.next</span><br><span class="line">        &#125;</span><br><span class="line">        node = node.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//148. Sort List</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeTwo</span>(<span class="params">one, two</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dummy = <span class="keyword">new</span> ListNode(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">var</span> head = dummy;</span><br><span class="line">    <span class="keyword">while</span> (one &amp;&amp; two) &#123;</span><br><span class="line">        <span class="keyword">if</span> (one.val &lt; two.val) &#123;</span><br><span class="line">            head.next = one;</span><br><span class="line">            one = one.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            head.next = two;</span><br><span class="line">            two = two.next;</span><br><span class="line">        &#125;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (one) head.next = one;</span><br><span class="line">    <span class="keyword">if</span> (two) head.next = two;</span><br><span class="line">    <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortList</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head || !head.next) <span class="keyword">return</span> head;</span><br><span class="line">    <span class="keyword">var</span> fast = head,</span><br><span class="line">        slow = head;</span><br><span class="line">    <span class="keyword">while</span> (fast.next &amp;&amp; fast.next.next) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> second = slow.next;</span><br><span class="line">    slow.next = <span class="literal">null</span>;</span><br><span class="line">    head = sortList(head);</span><br><span class="line">    second = sortList(second);</span><br><span class="line">    <span class="keyword">return</span> mergeTwo(head, second);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//152. Maximum Product Subarray</span></span><br><span class="line"><span class="keyword">var</span> maxProduct = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums.length &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> max = -<span class="literal">Infinity</span>,</span><br><span class="line">        min = <span class="number">0</span>,</span><br><span class="line">        cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> n <span class="keyword">of</span> nums) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            min = (min === <span class="number">0</span> ? <span class="number">0</span> : min * n);</span><br><span class="line">            cur = (cur &lt;= <span class="number">1</span> ? n : cur * n);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> tempMin = min;</span><br><span class="line">            min = (cur &lt;= <span class="number">1</span> ? n : cur * n);</span><br><span class="line">            cur = (tempMin === <span class="number">0</span> ? n : tempMin * n);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            min = <span class="number">0</span>;</span><br><span class="line">            cur = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        max = <span class="built_in">Math</span>.max(max, cur);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 160. Intersection of Two Linked Lists</span></span><br><span class="line"><span class="keyword">var</span> getIntersectionNode = <span class="function"><span class="keyword">function</span>(<span class="params">headA, headB</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">set</span> = new Set();</span><br><span class="line">    while (headA || headB) &#123;</span><br><span class="line">        <span class="keyword">if</span> (headA) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">set</span>.has(headA.val)) &#123;</span><br><span class="line">                <span class="keyword">return</span> headA;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span>.add(headA.val);</span><br><span class="line">            headA = headA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        if (headB) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">set</span>.has(headB.val)) &#123;</span><br><span class="line">                <span class="keyword">return</span> headB;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span>.add(headB.val);</span><br><span class="line">            headB = headB.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;;</span><br><span class="line">// 167. Two Sum II - Input array is sorted</span><br><span class="line">const twoSum = (numbers, target) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> table = <span class="keyword">new</span> <span class="built_in">Map</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; numbers.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (table.has(numbers[i])) &#123;</span><br><span class="line">            <span class="keyword">return</span> [table.get(numbers[i]) + <span class="number">1</span>, i + <span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        table.set((target - numbers[i]), i)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Not Found'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.log(twoSum(numbers, <span class="number">6</span>));</span><br><span class="line"><span class="keyword">var</span> twoSum = <span class="function"><span class="keyword">function</span>(<span class="params">numbers, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> l = numbers.length,</span><br><span class="line">        i = <span class="number">0</span>,</span><br><span class="line">        j = l - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (numbers[i] + numbers[j] !== target) &#123;</span><br><span class="line">        numbers[i] + numbers[j] &lt; target ? i++ : j--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [i + <span class="number">1</span>, j + <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> twoSum = <span class="function"><span class="keyword">function</span>(<span class="params">numbers, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> l = numbers.length,</span><br><span class="line">        i = <span class="number">0</span>,</span><br><span class="line">        j = l - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> sum = numbers[i] + numbers[j];</span><br><span class="line">    <span class="keyword">while</span> (sum !== target) &#123;</span><br><span class="line">        sum &lt; target ? i++ : j--;</span><br><span class="line">        sum = numbers[i] + numbers[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [i + <span class="number">1</span>, j + <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//172. Factorial Trailing Zeroes</span></span><br><span class="line"><span class="keyword">var</span> trailingZeroes = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cur = <span class="number">5</span>,</span><br><span class="line">        total = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (cur &lt;= n) &#123;</span><br><span class="line">        total += <span class="built_in">Math</span>.floor(n / cur);</span><br><span class="line">        cur *= <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//189. Rotate Array</span></span><br><span class="line"><span class="keyword">var</span> rotate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        nums.unshift(nums.pop());</span><br><span class="line">        k--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> rotate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> n = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = k; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        nums.unshift(nums.splice(n, <span class="number">1</span>)[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> rotate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    k %= nums.length;</span><br><span class="line">    [].unshift.apply(nums, nums.splice(nums.length - k, k));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> rotate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (k &gt; <span class="number">0</span> &amp;&amp; k--) nums.unshift(nums.pop());</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//190. Reverse Bits</span></span><br><span class="line"><span class="keyword">var</span> reverseBits = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> b = (n.toString(<span class="number">2</span>)).split(<span class="string">''</span>).reverse();</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">parseInt</span>((b.join(<span class="string">''</span>) + <span class="string">'00000000000000000000000000000000000000000000000000000'</span>).substr(<span class="number">0</span>, <span class="number">32</span>), <span class="string">'2'</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> reverseBits = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> binput = (n.toString(<span class="string">'2'</span>, n)).split(<span class="string">''</span>).reverse();</span><br><span class="line">    <span class="keyword">while</span> (binput.length &lt; <span class="number">32</span>) &#123;</span><br><span class="line">        binput.push(<span class="string">'0'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">parseInt</span>(binput.join(<span class="string">''</span>), <span class="string">'2'</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//202. Happy Number</span></span><br><span class="line"><span class="keyword">var</span> isHappy = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> seen = &#123;&#125;;</span><br><span class="line">    <span class="keyword">while</span> (n !== <span class="number">1</span> &amp;&amp; !seen[n]) &#123;</span><br><span class="line">        seen[n] = <span class="literal">true</span>;</span><br><span class="line">        n = sumOfSquares(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n === <span class="number">1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sumOfSquares</span>(<span class="params">numString</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numString.toString().split(<span class="string">''</span>).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">sum, num</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum + <span class="built_in">Math</span>.pow(num, <span class="number">2</span>);</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//203. Remove Linked List Elements</span></span><br><span class="line"><span class="keyword">var</span> removeElements = <span class="function"><span class="keyword">function</span>(<span class="params">head, val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> point = <span class="keyword">new</span> ListNode(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">var</span> res = point;</span><br><span class="line">    <span class="keyword">while</span> (head !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head.val !== val) &#123;</span><br><span class="line">            point.next = head;</span><br><span class="line">            point = point.next;</span><br><span class="line">        &#125;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    point.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> res.next;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//204. Count Primes</span></span><br><span class="line"><span class="keyword">var</span> countPrimes = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> notPrime = <span class="keyword">new</span> <span class="built_in">Array</span>(n);</span><br><span class="line">    notPrime.fill(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (notPrime[i] == <span class="literal">false</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">2</span>; i * j &lt; n; j++) &#123;</span><br><span class="line">            notPrime[i * j] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//206. Reverse Linked List</span></span><br><span class="line"><span class="keyword">var</span> reverseList = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> head ? reverse(head, <span class="literal">null</span>) : head;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">node, previous</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> newHead = node;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// recursive call to tail</span></span><br><span class="line">    <span class="keyword">if</span> (node.next) newHead = reverse(node.next, node);</span><br><span class="line">    <span class="comment">// reverse from tail all the way up to head</span></span><br><span class="line">    node.next = previous;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> newHead;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//209. Minimum Size Subarray Sum</span></span><br><span class="line"><span class="keyword">var</span> minSubArrayLen = <span class="function"><span class="keyword">function</span>(<span class="params">s, nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> numsLen = nums.length,</span><br><span class="line">        sum = <span class="number">0</span>,</span><br><span class="line">        right = <span class="number">0</span>,</span><br><span class="line">        left = <span class="number">0</span>,</span><br><span class="line">        minLen = <span class="built_in">Number</span>.MAX_SAFE_INTEGER;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (right &lt; numsLen) &#123;</span><br><span class="line">        sum += nums[right];</span><br><span class="line">        <span class="keyword">if</span> (sum &gt;= s) &#123;</span><br><span class="line">            <span class="keyword">while</span> (sum &gt;= s) &#123;</span><br><span class="line">                sum -= nums[left];</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">            minLen = <span class="built_in">Math</span>.min(right - left + <span class="number">2</span>, minLen);</span><br><span class="line">        &#125;</span><br><span class="line">        right++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> minLen === <span class="built_in">Number</span>.MAX_SAFE_INTEGER ? <span class="number">0</span> : minLen;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> combinationSum = <span class="function"><span class="keyword">function</span>(<span class="params">candidates, target</span>) </span>&#123;</span><br><span class="line">    candidates = candidates.sort(<span class="function"><span class="keyword">function</span>(<span class="params">val1, val2</span>) </span>&#123; <span class="comment">// step 1</span></span><br><span class="line">        <span class="keyword">return</span> val1 &gt; val2 ? <span class="number">1</span> : val1 &lt; val2 ? <span class="number">-1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// console.log("candidates=["+candidates+"];");</span></span><br><span class="line">    <span class="keyword">var</span> solution = [];</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> pushVal = <span class="function"><span class="keyword">function</span>(<span class="params">solution, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; solution.length; ++i) &#123;</span><br><span class="line">            sum += solution[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// console.log("solution=["+solution+"]; sum="+sum);</span></span><br><span class="line">        <span class="keyword">return</span> (sum &gt; target) ? <span class="literal">true</span> : (sum == target &amp;&amp; solution.length == n) ? result.push(solution.slice(<span class="number">0</span>)) : <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> backTracking = <span class="function"><span class="keyword">function</span>(<span class="params">k, n</span>) </span>&#123; <span class="comment">// step 4</span></span><br><span class="line">        <span class="keyword">if</span> (k != n) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; candidates.length; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; solution[k - <span class="number">1</span>] &gt; candidates[i]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125; <span class="comment">// Elements in a combination (a1, a2, â€¦ , ak) must be in non-descending order. (ie, a1 â‰¤ a2 â‰¤ â€¦ â‰¤ ak).</span></span><br><span class="line">                solution[k] = candidates[i];</span><br><span class="line">                <span class="comment">// console.log("candidates["+i+"]="+candidates[i]+";");</span></span><br><span class="line">                <span class="keyword">if</span> (pushVal(solution, n)) &#123;</span><br><span class="line">                    solution.splice(solution.length - <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">arguments</span>.callee(k + <span class="number">1</span>, n);</span><br><span class="line">                <span class="comment">// console.log("candidates["+i+"]="+candidates[i]+";");</span></span><br><span class="line">                solution.splice(solution.length - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">Math</span>.floor(target / candidates[<span class="number">0</span>]); ++i) &#123; <span class="comment">// step 3</span></span><br><span class="line">        backTracking(<span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//216. Combination Sum III</span></span><br><span class="line"><span class="keyword">var</span> combinationSum3 = <span class="function"><span class="keyword">function</span>(<span class="params">k, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> solution = []; <span class="comment">// length=k all possible Combination</span></span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> used = []; <span class="comment">// [1,2,...,9] each element can only be used once</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> backTracking = <span class="function"><span class="keyword">function</span>(<span class="params">m, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (m == k) &#123;</span><br><span class="line">            <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; solution.length; ++i) &#123;</span><br><span class="line">                sum += solution[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (sum == n) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(solution); <span class="comment">// print out all possible</span></span><br><span class="line">                result.push(solution.slice(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (used[i]) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125; <span class="comment">// when true, express the element(used[i]) has been used</span></span><br><span class="line">                <span class="keyword">if</span> (m &gt; <span class="number">0</span> &amp;&amp; solution[m - <span class="number">1</span>] &gt; i) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125; <span class="comment">// elements can only small to large order</span></span><br><span class="line">                used[i] = <span class="literal">true</span>;</span><br><span class="line">                solution[m] = i;</span><br><span class="line">                <span class="built_in">arguments</span>.callee(m + <span class="number">1</span>, n);</span><br><span class="line">                used[i] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    backTracking(<span class="number">0</span>, n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 217. Contains Duplicate</span></span><br><span class="line"><span class="keyword">var</span> containsDuplicate = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    nums.sort();</span><br><span class="line">    <span class="comment">// duplicate numbers locate side by side in sorted array</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> [i, n] <span class="keyword">of</span> nums.entries())</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; n === nums[i - <span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> containsDuplicate = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hash = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = nums.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hash[nums[i]]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hash[nums[i]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 219. Contains Duplicate II</span></span><br><span class="line"><span class="keyword">var</span> containsNearbyDuplicate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mapObj = &#123;&#125;,</span><br><span class="line">        cur,</span><br><span class="line">        numsLen = nums.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (cur = <span class="number">0</span>; cur &lt; numsLen; cur++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mapObj.hasOwnProperty(nums[cur])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur - mapObj[nums[cur]] &lt;= k) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mapObj[nums[cur]] = cur;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            mapObj[nums[cur]] = cur;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> containsNearbyDuplicate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dict = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> char = nums[i];</span><br><span class="line">        <span class="keyword">if</span> (!dict.hasOwnProperty(char)) &#123;</span><br><span class="line">            dict[char] = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> previousIndex = dict[char];</span><br><span class="line">            <span class="keyword">var</span> diff = i - previousIndex;</span><br><span class="line">            <span class="keyword">if</span> (diff &lt;= k) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            dict[char] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//220. Contains Duplicate III</span></span><br><span class="line"><span class="keyword">var</span> containsNearbyAlmostDuplicate = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!nums || nums.length &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> indices = [nums.length];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// initialize indices array to [0,1,2,3,...].</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</span><br><span class="line">        indices[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sort indices base on their values.</span></span><br><span class="line">    indices = indices.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nums[a] - nums[b];</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// loop through the indices array.</span></span><br><span class="line">    <span class="keyword">var</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nums.length - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = indices[i];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; nums.length; ++j) &#123;</span><br><span class="line">            <span class="keyword">var</span> y = indices[j];</span><br><span class="line">            <span class="keyword">var</span> diff = nums[y] - nums[x];</span><br><span class="line">            <span class="keyword">var</span> di = y &gt; x ? y - x : x - y;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// stop if the difference exceeds t.</span></span><br><span class="line">            <span class="keyword">if</span> (diff &gt; t) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (di &lt;= k) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//226. Invert Binary Tree</span></span><br><span class="line"><span class="keyword">var</span> invertTree = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    [root.left, root.right] = [invertTree(root.right), invertTree(root.left)]</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 228. Summary Ranges</span></span><br><span class="line"><span class="keyword">var</span> summaryRanges = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> start = <span class="number">0</span>, i = <span class="number">1</span>; i &lt;= nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] - nums[i - <span class="number">1</span>] &gt; <span class="number">1</span> || i === nums.length) &#123;</span><br><span class="line">            res.push(nums[start] + (start &lt; i - <span class="number">1</span> ? <span class="string">'-&gt;'</span> + nums[i - <span class="number">1</span>] : <span class="string">''</span>));</span><br><span class="line">            start = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> summaryRanges = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res = [];</span><br><span class="line">    <span class="keyword">var</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        a = nums[i];</span><br><span class="line">        <span class="keyword">while</span> (i &lt; nums.length - <span class="number">1</span> &amp;&amp; nums[i + <span class="number">1</span>] - nums[i] == <span class="number">1</span>) i++;</span><br><span class="line">        <span class="keyword">if</span> (a != nums[i])</span><br><span class="line">            res[j++] = a + <span class="string">"-&gt;"</span> + nums[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res[j++] = a + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> summaryRanges = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">if</span> (!nums.length)</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">if</span> (nums.length === <span class="number">1</span>) &#123;</span><br><span class="line">        result.push(<span class="string">''</span> + nums[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (nums[<span class="number">0</span>] + <span class="number">1</span> !== nums[<span class="number">1</span>])</span><br><span class="line">        result.push(nums[<span class="number">0</span>].toString());</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums.length) &#123;</span><br><span class="line">        <span class="keyword">var</span> tmp = i;</span><br><span class="line">        <span class="keyword">while</span> (nums[i] === nums[i - <span class="number">1</span>] + <span class="number">1</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tmp !== i) &#123;</span><br><span class="line">            result.push(nums[tmp - <span class="number">1</span>] + <span class="string">"-&gt;"</span> + nums[i - <span class="number">1</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (i === nums.length - <span class="number">1</span>)</span><br><span class="line">                result.push(nums[i].toString());</span><br><span class="line">            <span class="keyword">if</span> (i &lt; nums.length - <span class="number">1</span> &amp;&amp; nums[i + <span class="number">1</span>] !== nums[i] + <span class="number">1</span>)</span><br><span class="line">                result.push(nums[i].toString());</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 229. Majority Element II</span></span><br><span class="line"><span class="keyword">var</span> majorityElement = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> numsLength = nums.length;</span><br><span class="line">    <span class="keyword">if</span> (numsLength === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> hasOb = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; numsLength; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (result.indexOf(nums[i]) !== <span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!hasOb[nums[i]]) &#123;</span><br><span class="line">            hasOb[nums[i]] = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            hasOb[nums[i]] += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hasOb[nums[i]] &gt; <span class="built_in">Math</span>.floor(numsLength / <span class="number">3</span>)) &#123;</span><br><span class="line">            result.push(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//231. Power of Two</span></span><br><span class="line"><span class="keyword">var</span> isPowerOfTwo = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n &lt;= <span class="number">0</span> ? <span class="literal">false</span> : !(n &amp; (n - <span class="number">1</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//233. Number of Digit One</span></span><br><span class="line"><span class="keyword">var</span> countDigitOne = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">10</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> base = <span class="built_in">Math</span>.pow(<span class="number">10</span>, n.toString().length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> answer = <span class="built_in">parseInt</span>(n / base);</span><br><span class="line">    <span class="keyword">return</span> countDigitOne(base - <span class="number">1</span>) * answer + (answer === <span class="number">1</span> ? (n - base + <span class="number">1</span>) : base) + countDigitOne(n % base);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> countDigitOne = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> len = n.toString().length;</span><br><span class="line">    <span class="keyword">var</span> base = <span class="built_in">Math</span>.pow(<span class="number">10</span>, len - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> answer = <span class="built_in">parseInt</span>(n / base);</span><br><span class="line">    <span class="keyword">var</span> remainder = n % base;</span><br><span class="line">    <span class="keyword">var</span> oneInBase = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (answer === <span class="number">1</span>) &#123;</span><br><span class="line">        oneInBase = n - base + <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        oneInBase = base;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> countDigitOne(base - <span class="number">1</span>) * answer + oneInBase + countDigitOne(remainder);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//235. Lowest Common Ancestor of a Binary Search Tree</span></span><br><span class="line"><span class="keyword">var</span> lowestCommonAncestor = <span class="function"><span class="keyword">function</span>(<span class="params">root, p, q</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root.val &gt; p.val &amp;&amp; root.val &gt; q.val) &#123;</span><br><span class="line">        <span class="keyword">return</span> lowestCommonAncestor(root.left, p, q);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (root.val &lt; p.val &amp;&amp; root.val &lt; q.val) &#123;</span><br><span class="line">        <span class="keyword">return</span> lowestCommonAncestor(root.right, p, q);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//236. Lowest Common Ancestor of a Binary Tree</span></span><br><span class="line"><span class="keyword">var</span> lowestCommonAncestor = <span class="function"><span class="keyword">function</span>(<span class="params">root, p, q</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (root === p || root === q) <span class="keyword">return</span> root;</span><br><span class="line">    <span class="keyword">var</span> left = lowestCommonAncestor(root.left, p, q);</span><br><span class="line">    <span class="keyword">var</span> right = lowestCommonAncestor(root.right, p, q);</span><br><span class="line">    <span class="keyword">return</span> left !== <span class="literal">null</span> &amp;&amp; right !== <span class="literal">null</span> ? root : left == <span class="literal">null</span> ? right : left;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 237. Delete Node in a Linked List</span></span><br><span class="line"><span class="keyword">var</span> deleteNode = <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (node.val !== <span class="literal">undefined</span> &amp;&amp; node.next !== <span class="literal">undefined</span>) &#123;</span><br><span class="line"></span><br><span class="line">        node.val = node.next.val;</span><br><span class="line">        node.next = node.next.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 238. Product of Array Except Self</span></span><br><span class="line"><span class="keyword">var</span> productExceptSelf = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> n = nums.length</span><br><span class="line">    <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Array</span>(n);</span><br><span class="line">    result.fill(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> left_fac = <span class="number">1</span>,</span><br><span class="line">        right_fac = <span class="number">1</span>,</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; n) &#123;</span><br><span class="line">        result[i] *= left_fac</span><br><span class="line">        left_fac *= nums[i]</span><br><span class="line">        i++</span><br><span class="line">        result[n - i] *= right_fac</span><br><span class="line">        right_fac *= nums[n - i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> productExceptSelf = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i;</span><br><span class="line">    <span class="keyword">var</span> res_before = [];</span><br><span class="line">    <span class="keyword">var</span> res_after = [];</span><br><span class="line">    <span class="comment">//var res = [];</span></span><br><span class="line">    res_before[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    res_after[nums.length - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        res_before[i] = res_before[i - <span class="number">1</span>] * nums[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = nums.length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        res_after[i] = res_after[i + <span class="number">1</span>] * nums[i + <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        res_after[i] = res_before[i] * res_after[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res_after;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//257. Binary Tree Paths</span></span><br><span class="line"><span class="keyword">var</span> binaryTreePaths = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!root.left &amp;&amp; !root.right) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">String</span>(root.val)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> subpaths = binaryTreePaths(root.left).concat(binaryTreePaths(root.right));</span><br><span class="line">    <span class="keyword">return</span> subpaths.map(<span class="function"><span class="params">path</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;root.val&#125;</span>-&gt;<span class="subst">$&#123;path&#125;</span>`</span> );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//258. Add Digits</span></span><br><span class="line"><span class="keyword">var</span> addDigits = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num == <span class="number">0</span> ? <span class="number">0</span> : (num % <span class="number">9</span> == <span class="number">0</span> ? <span class="number">9</span> : (num % <span class="number">9</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//260. Single Number III</span></span><br><span class="line"><span class="keyword">var</span> singleNumber = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t = nums.reduce(<span class="function">(<span class="params">t, n</span>) =&gt;</span> t ^ n, <span class="number">0</span>);</span><br><span class="line">    t = -t &amp; t;</span><br><span class="line">    <span class="keyword">return</span> nums.reduce(<span class="function">(<span class="params">r, n</span>) =&gt;</span> (n &amp; t) ? [r[<span class="number">0</span>] ^ n, r[<span class="number">1</span>]] : [r[<span class="number">0</span>], r[<span class="number">1</span>] ^ n], [<span class="number">0</span>, <span class="number">0</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> singleNumber = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> map = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = nums.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> key = nums[i];</span><br><span class="line">        <span class="keyword">if</span> (!map[key]) &#123;</span><br><span class="line">            map[key] = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">delete</span> map[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> ret = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j <span class="keyword">in</span> map) &#123;</span><br><span class="line">        ret.push(+j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//264. Ugly Number II</span></span><br><span class="line"><span class="keyword">var</span> nthUglyNumber = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = [<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">var</span> p2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> p3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> p5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> m, r2, r3, r5;</span><br><span class="line">    <span class="keyword">var</span> i = cache.length;</span><br><span class="line">    <span class="keyword">for</span> (; i &lt; n; i++) &#123;</span><br><span class="line">        r2 = cache[p2] * <span class="number">2</span>;</span><br><span class="line">        r3 = cache[p3] * <span class="number">3</span>;</span><br><span class="line">        r5 = cache[p5] * <span class="number">5</span>;</span><br><span class="line">        m = <span class="built_in">Math</span>.min(r2, r3, r5);</span><br><span class="line">        <span class="keyword">if</span> (m === r2) p2++;</span><br><span class="line">        <span class="keyword">if</span> (m === r3) p3++;</span><br><span class="line">        <span class="keyword">if</span> (m === r5) p5++;</span><br><span class="line">        cache[i] = m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cache[n - <span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//279. Perfect Squares</span></span><br><span class="line"><span class="keyword">var</span> numSquares = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dp = <span class="keyword">new</span> <span class="built_in">Array</span>(n + <span class="number">1</span>);</span><br><span class="line">    dp.fill(<span class="built_in">Number</span>.MAX_VALUE);</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">var</span> min = <span class="built_in">Number</span>.MAX_VALUE;</span><br><span class="line">        <span class="keyword">var</span> j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i - j * j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            min = <span class="built_in">Math</span>.min(min, dp[i - j * j] + <span class="number">1</span>);</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">        dp[i] = min;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 283. Move Zeroes</span></span><br><span class="line"><span class="keyword">var</span> moveZeroes = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[j] === <span class="number">0</span>) &#123;</span><br><span class="line">            nums.splice(j, <span class="number">1</span>);</span><br><span class="line">            nums.push(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> j++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> moveZeroes = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> pNum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> pZero = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (pNum &lt; nums.length &amp;&amp; pZero &lt; nums.length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[pZero] !== <span class="number">0</span>) &#123;</span><br><span class="line">            pZero++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[pNum] === <span class="number">0</span> || pNum &lt; pZero) &#123;</span><br><span class="line">            pNum++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pZero &lt; pNum) &#123;</span><br><span class="line">            <span class="keyword">var</span> aux = nums[pNum];</span><br><span class="line">            nums[pNum] = nums[pZero];</span><br><span class="line">            nums[pZero] = aux;</span><br><span class="line">            pZero++;</span><br><span class="line">            pNum++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//328. Odd Even Linked List</span></span><br><span class="line"><span class="keyword">var</span> oddEvenList = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!head || !head.next || !head.next.next) <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!head.next.next.next) &#123;</span><br><span class="line">        head.next.next.next = head.next; <span class="comment">// 3 -&gt; 2 -&gt; 3</span></span><br><span class="line">        head.next = head.next.next; <span class="comment">// 1 -&gt; 3 -&gt; 2 -&gt; 3</span></span><br><span class="line">        head.next.next.next = <span class="literal">null</span>; <span class="comment">// 1 -&gt; 3 -&gt; 2</span></span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> odd = head,</span><br><span class="line">        even = head.next,</span><br><span class="line">        first = even;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (even &amp;&amp; even.next) &#123;</span><br><span class="line"></span><br><span class="line">        odd.next = even.next;</span><br><span class="line">        even.next = even.next.next;</span><br><span class="line">        even = even.next;</span><br><span class="line">        odd = odd.next</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    odd.next = first;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//349. Intersection of Two Arrays</span></span><br><span class="line"><span class="keyword">var</span> intersection = <span class="function"><span class="keyword">function</span>(<span class="params">nums1, nums2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> intersection = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// collect unique intersections</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> n <span class="keyword">of</span> nums1)</span><br><span class="line">        <span class="keyword">if</span> (nums2.indexOf(n) !== <span class="number">-1</span>) intersection[n] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// extract intersections and convert to numbers</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(intersection).map(<span class="function"><span class="params">val</span> =&gt;</span> <span class="built_in">parseInt</span>(val));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> intersection = <span class="function"><span class="keyword">function</span>(<span class="params">nums1, nums2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">set</span> = new Set();</span><br><span class="line">    var len1 = nums1.length;</span><br><span class="line">    // var len2=nums2.length;</span><br><span class="line">    for (var i = 0; i &lt; len1; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums2.indexOf(nums1[i]) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">set</span>.add(nums1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var result = Array.from(<span class="keyword">set</span>);</span><br><span class="line">    return result;</span><br><span class="line">&#125;;</span><br><span class="line">//345. Reverse Vowels of a String</span><br><span class="line">var reverseVowels = function(s) &#123;</span><br><span class="line">    <span class="keyword">var</span> inArray = <span class="function"><span class="keyword">function</span>(<span class="params">s, arr</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.toLowerCase() == arr[i]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> v = [<span class="string">'a'</span>, <span class="string">'e'</span>, <span class="string">'i'</span>, <span class="string">'o'</span>, <span class="string">'u'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (inArray(s[i], v)) &#123;</span><br><span class="line">            arr.push(s[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (inArray(s[i], v)) &#123;</span><br><span class="line">            res += arr[arr.length - x];</span><br><span class="line">            x++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res += s[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//350</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSame</span>(<span class="params">arr1, arr2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len1 = arr1.length,</span><br><span class="line">        len2 = arr2.length;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">0</span>,</span><br><span class="line">        j = <span class="number">0</span>,</span><br><span class="line">        result = [];</span><br><span class="line">    <span class="keyword">while</span> (i &lt; len1 &amp;&amp; j &lt; len2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr1[i] == arr2[j]) &#123;</span><br><span class="line">            result.push(arr1[i]);</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr1[i] &lt; arr2[j]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 389. Find the Difference</span></span><br><span class="line"><span class="keyword">var</span> findTheDifference = <span class="function"><span class="keyword">function</span>(<span class="params">s, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">''</span>;</span><br><span class="line">    s = s.split(<span class="string">''</span>).sort().join(<span class="string">''</span>);</span><br><span class="line">    t = t.split(<span class="string">''</span>).sort().join(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; t.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(s[i] === t[i])) &#123;</span><br><span class="line">            str += t[i];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//397. Integer Replacement</span></span><br><span class="line"><span class="keyword">var</span> integerReplacement = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n % <span class="number">2</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> integerReplacement(n / <span class="number">2</span>) + <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.min(integerReplacement(n - <span class="number">1</span>), integerReplacement(n + <span class="number">1</span>)) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> integerReplacement = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    result.push(<span class="number">0</span>);</span><br><span class="line">    result.push(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            result[i] = result[i / <span class="number">2</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result[i] = <span class="built_in">Math</span>.min(result[(i - <span class="number">1</span>) / <span class="number">2</span>], result[(i + <span class="number">1</span>) / <span class="number">2</span>]) + <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result[n];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//401. Binary Watch</span></span><br><span class="line"><span class="keyword">var</span> readBinaryWatch = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt;= <span class="number">59</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((countSetBit(i) + countSetBit(j)) === num) &#123;</span><br><span class="line">                result.push(i + (j &lt; <span class="number">10</span> ? <span class="string">':0'</span> : <span class="string">':'</span>) + j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSetBit</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> binary = num.toString(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; binary.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (binary[i] == <span class="number">1</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//415. Add Strings</span></span><br><span class="line"><span class="keyword">var</span> addStrings = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    num1 = num1.split(<span class="string">''</span>);</span><br><span class="line">    num2 = num2.split(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">var</span> i = num1.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> j = num2.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> up = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> res = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &gt;= <span class="number">0</span> || j &gt;= <span class="number">0</span> || up &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> sum = up;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            sum += <span class="built_in">parseInt</span>(num1[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            sum += <span class="built_in">parseInt</span>(num2[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sum &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">            sum -= <span class="number">10</span>;</span><br><span class="line">            up = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            up = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res = sum + res;</span><br><span class="line">        i--;</span><br><span class="line">        j--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> addStrings = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num1 = num1.split(<span class="string">''</span>).reverse();</span><br><span class="line">    <span class="keyword">var</span> num2 = num2.split(<span class="string">''</span>).reverse();</span><br><span class="line">    <span class="keyword">var</span> len1 = num1.length;</span><br><span class="line">    <span class="keyword">var</span> len2 = num2.length;</span><br><span class="line">    <span class="keyword">var</span> jinwei = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">var</span> newRes;</span><br><span class="line">    <span class="keyword">if</span> (len1 &gt; len2) &#123;</span><br><span class="line">        num1.push(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = len2; j &lt;= len1; j++) &#123;</span><br><span class="line">            num2.push(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len1; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> num = <span class="built_in">parseInt</span>(num1[i]) + <span class="built_in">parseInt</span>(num2[i]) + jinwei;</span><br><span class="line">            <span class="keyword">if</span> (num &lt; <span class="number">10</span>) &#123;</span><br><span class="line">                result.push(num);</span><br><span class="line">                jinwei = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result.push(num - <span class="number">10</span>);</span><br><span class="line">                jinwei = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result[result.length - <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">            result.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        newRes = result.reverse().join(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        num2.push(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = len1; j &lt;= len2; j++) &#123;</span><br><span class="line">            num1.push(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len2; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> num = <span class="built_in">parseInt</span>(num1[i]) + <span class="built_in">parseInt</span>(num2[i]) + jinwei;</span><br><span class="line">            <span class="keyword">if</span> (num &lt; <span class="number">10</span>) &#123;</span><br><span class="line">                result.push(num);</span><br><span class="line">                jinwei = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result.push(num - <span class="number">10</span>);</span><br><span class="line">                jinwei = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result[result.length - <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">            result.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        newRes = result.reverse().join(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (newRes + <span class="string">""</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//437. Path Sum III</span></span><br><span class="line"><span class="keyword">var</span> pathSum = <span class="function"><span class="keyword">function</span>(<span class="params">root, sum</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> findPath(root, sum) + pathSum(root.left, sum) + pathSum(root.right, sum);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">findPath</span>(<span class="params">root, sum</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!root) <span class="keyword">return</span> res;</span><br><span class="line">        <span class="keyword">if</span> (sum == root.val) res++;</span><br><span class="line">        res += findPath(root.left, sum - root.val);</span><br><span class="line">        res += findPath(root.right, sum - root.val);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 441. Arranging Coins</span></span><br><span class="line"><span class="keyword">var</span> arrangeCoins = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.sqrt(<span class="number">2</span> * n) - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> ((t + <span class="number">2</span>) * (t + <span class="number">1</span>) / <span class="number">2</span> &lt;= n) &#123;</span><br><span class="line">            <span class="keyword">return</span> t + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((t + <span class="number">2</span>) * (t + <span class="number">1</span>) / <span class="number">2</span> &gt; n) &#123;</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 445. Add Two Numbers II</span></span><br><span class="line"><span class="keyword">var</span> addTwoNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">l1, l2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> createf = <span class="function">(<span class="params">v, nxt</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> n = <span class="keyword">new</span> ListNode(v);</span><br><span class="line">            n.next = nxt;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;,</span><br><span class="line">        f = <span class="function">(<span class="params">l1, h1, l2, h2</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!l1.next &amp;&amp; !l2.next) &#123;</span><br><span class="line">                <span class="keyword">let</span> s = l1.val + l2.val;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    n: createf(s % <span class="number">10</span>),</span><br><span class="line">                    carry: <span class="built_in">Math</span>.floor(s / <span class="number">10</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> r = f(l1.next || h1,</span><br><span class="line">                    l1.next ? h1 : h2,</span><br><span class="line">                    l2.next || h2,</span><br><span class="line">                    l2.next ? h2 : h1),</span><br><span class="line">                ignore1 = r.ignore1 || !l1.next,</span><br><span class="line">                ignore2 = r.ignore2 || !l2.next,</span><br><span class="line">                sum = (ignore1 ? <span class="number">0</span> : l1.val) +</span><br><span class="line">                (ignore2 ? <span class="number">0</span> : l2.val) +</span><br><span class="line">                r.carry;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                n: (ignore1 &amp;&amp; ignore2 &amp;&amp; sum == <span class="number">0</span>) ? r.n : createf(sum % <span class="number">10</span>, r.n),</span><br><span class="line">                carry: <span class="built_in">Math</span>.floor(sum / <span class="number">10</span>),</span><br><span class="line">                ignore1: ignore1,</span><br><span class="line">                ignore2: ignore2</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        r = f(l1, l2, l2, l1);</span><br><span class="line">    <span class="keyword">return</span> r.carry == <span class="number">0</span> ? r.n : createf(r.carry, r.n);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 445. Add Two Numbers II</span></span><br><span class="line"><span class="keyword">var</span> addTwoNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">l1, l2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> s1 = [];</span><br><span class="line">    <span class="keyword">var</span> s2 = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (l1 !== <span class="literal">null</span>) &#123;</span><br><span class="line">        s1.push(l1.val);</span><br><span class="line">        l1 = l1.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l2 !== <span class="literal">null</span>) &#123;</span><br><span class="line">        s2.push(l2.val);</span><br><span class="line">        l2 = l2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> list = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (s1.length &gt; <span class="number">0</span> || s2.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s1.length &gt; <span class="number">0</span>) sum += s1.pop();</span><br><span class="line">        <span class="keyword">if</span> (s2.length &gt; <span class="number">0</span>) sum += s2.pop();</span><br><span class="line">        list.val = sum % <span class="number">10</span>;</span><br><span class="line">        <span class="comment">//&gt;&gt;è¡¨ç¤ºè¦å‘å³ç§»åŠ¨</span></span><br><span class="line">        <span class="keyword">var</span> head = <span class="keyword">new</span> ListNode((sum / <span class="number">10</span>) &gt;&gt; <span class="number">0</span>);</span><br><span class="line">        head.next = list;</span><br><span class="line">        list = head;</span><br><span class="line">        sum = (sum / <span class="number">10</span>) &gt;&gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list.val === <span class="number">0</span> ? list.next : list;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//447. Number of Boomerangs</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numberOfBoomerangs</span>(<span class="params">points</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="number">0</span>;</span><br><span class="line">    points.forEach(<span class="function"><span class="params">p1</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> map = &#123;&#125;;</span><br><span class="line">        points.forEach(<span class="function"><span class="params">p2</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> dist = <span class="built_in">Math</span>.pow(p1[<span class="number">0</span>] - p2[<span class="number">0</span>], <span class="number">2</span>) + <span class="built_in">Math</span>.pow(p1[<span class="number">1</span>] - p2[<span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">            res += (map[dist] || <span class="number">0</span>) * <span class="number">2</span>;</span><br><span class="line">            map[dist] = (map[dist] || <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//447. Number of Boomerangs</span></span><br><span class="line"><span class="keyword">var</span> numberOfBoomerangs = <span class="function"><span class="keyword">function</span>(<span class="params">points</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = points.length;</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> jk = <span class="number">0</span>; jk &lt; len; jk++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i === jk) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> d = getDistance(points[i], points[jk]);</span><br><span class="line">            <span class="keyword">if</span> (map.get(d)) &#123;</span><br><span class="line">                map.set(d, map.get(d) + <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                map.set(d, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        map.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">m</span>) </span>&#123;</span><br><span class="line">            count += m * (m - <span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDistance</span>(<span class="params">i, j</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (i[<span class="number">0</span>] - j[<span class="number">0</span>]) * (i[<span class="number">0</span>] - j[<span class="number">0</span>]) + (i[<span class="number">1</span>] - j[<span class="number">1</span>]) * (i[<span class="number">1</span>] - j[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 448. Find All Numbers Disappeared in an Array</span></span><br><span class="line"><span class="keyword">var</span> findDisappearedNumbers = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> rtn = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0</span>),</span><br><span class="line">        <span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>(nums);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!s.has(i)) rtn.push(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rtn;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 451. Sort Characters By Frequency</span></span><br><span class="line"><span class="keyword">var</span> frequencySort = <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> tally = str</span><br><span class="line">        .split(<span class="string">''</span>)</span><br><span class="line">        .reduce(<span class="function">(<span class="params">obj, key</span>) =&gt;</span> &#123;</span><br><span class="line">            obj[key] ? obj[key]++ : obj[key] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span></span><br><span class="line">        .keys(tally)</span><br><span class="line">        .map(<span class="function"><span class="params">key</span> =&gt;</span> key.repeat(tally[key]))</span><br><span class="line">        .sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> b.length - a.length)</span><br><span class="line">        .join(<span class="string">''</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> frequencySort = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> map = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> stringArray = s.split(<span class="string">''</span>);</span><br><span class="line">    <span class="comment">//put the character count into a map</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; stringArray.length; i++) &#123;</span><br><span class="line">        map[stringArray[i]] = map[stringArray[i]] + <span class="number">1</span> || <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//sort the map first, then push into the result</span></span><br><span class="line">    <span class="built_in">Object</span>.keys(map).sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> map[b] - map[a]).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; map[v]; j++) &#123;</span><br><span class="line">            result += v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> frequencySort = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> chars = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line">    <span class="keyword">let</span> freqMap = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> ch = s.charAt(i);</span><br><span class="line">        chars.add(ch);</span><br><span class="line">        <span class="keyword">if</span> (!freqMap.hasOwnProperty(ch)) freqMap[ch] = <span class="number">0</span>;</span><br><span class="line">        freqMap[ch]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> bucket = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> chars) &#123;</span><br><span class="line">        <span class="keyword">let</span> freq = freqMap[ch];</span><br><span class="line">        <span class="keyword">if</span> (!bucket.hasOwnProperty(freq)) bucket[freq] = [];</span><br><span class="line">        bucket[freq].push(<span class="keyword">new</span> <span class="built_in">Array</span>(freq + <span class="number">1</span>).join(ch));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = s.length; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bucket.hasOwnProperty(i)) &#123;</span><br><span class="line">            result.push(...bucket[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result.join(<span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//453. Minimum Moves to Equal Array Elements</span></span><br><span class="line"><span class="keyword">var</span> minMoves = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> nums.reduce(<span class="function">(<span class="params">s, n</span>) =&gt;</span> s + n, -nums.length * <span class="built_in">Math</span>.min(...nums))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//454. 4Sum II</span></span><br><span class="line"><span class="keyword">var</span> fourSumCount = <span class="function"><span class="keyword">function</span>(<span class="params">A, B, C, D</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mp = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; C.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; D.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> sum = C[i] + D[j];</span><br><span class="line">            mp[sum] = mp[sum] + <span class="number">1</span> || <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; A.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; B.length; j++) &#123;</span><br><span class="line">            res += mp[<span class="number">-1</span> * (A[i] + B[j])] || <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 454. 4Sum II</span></span><br><span class="line"><span class="keyword">var</span> fourSumCount = <span class="function"><span class="keyword">function</span>(<span class="params">A, B, C, D</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mp = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; C.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; D.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> sum = C[i] + D[j];</span><br><span class="line">            mp[sum] = mp[sum] + <span class="number">1</span> || <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; A.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; B.length; j++) &#123;</span><br><span class="line">            res += mp[<span class="number">-1</span> * (A[i] + B[j])] || <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//461. Hamming Distance</span></span><br><span class="line"><span class="keyword">var</span> hammingDistance = <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x ^ y).toString(<span class="number">2</span>).replace(<span class="regexp">/0/g</span>, <span class="string">''</span>).length;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//462. Minimum Moves to Equal Array Elements II</span></span><br><span class="line"><span class="keyword">var</span> minMoves2 = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    nums.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> mid = <span class="built_in">Math</span>.floor(nums.length / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        res += <span class="built_in">Math</span>.abs(nums[i] - nums[mid]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 463 Island Perimeter</span></span><br><span class="line"><span class="keyword">var</span> islandPerimeter = <span class="function"><span class="keyword">function</span>(<span class="params">grid</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> rows = grid.length;</span><br><span class="line">    <span class="keyword">const</span> cols = grid[<span class="number">0</span>].length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> perimeter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> row = <span class="number">0</span>; row &lt; rows; row++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> col = <span class="number">0</span>; col &lt; cols; col++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!grid[row][col]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            perimeter += <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// abstract the number of adjacent island</span></span><br><span class="line">            <span class="keyword">if</span> (row &gt; <span class="number">0</span> &amp;&amp; grid[row - <span class="number">1</span>][col]) perimeter--;</span><br><span class="line">            <span class="keyword">if</span> (col &gt; <span class="number">0</span> &amp;&amp; grid[row][col - <span class="number">1</span>]) perimeter--;</span><br><span class="line">            <span class="keyword">if</span> (row &lt; rows - <span class="number">1</span> &amp;&amp; grid[row + <span class="number">1</span>][col]) perimeter--;</span><br><span class="line">            <span class="keyword">if</span> (col &lt; cols - <span class="number">1</span> &amp;&amp; grid[row][col + <span class="number">1</span>]) perimeter--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> perimeter;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//475. Heaters</span></span><br><span class="line"><span class="keyword">var</span> findRadius = <span class="function"><span class="keyword">function</span>(<span class="params">houses, heaters</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// We need to find the max of min distance</span></span><br><span class="line">    heaters.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br><span class="line">    <span class="keyword">let</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; houses.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> curr = closestHeaterDistance(houses[i], heaters, <span class="number">0</span>, heaters.length - <span class="number">1</span>);</span><br><span class="line">        max = <span class="built_in">Math</span>.max(max, curr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closestHeaterDistance</span>(<span class="params">house, heaters, low, high</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (low === high) <span class="keyword">return</span> <span class="built_in">Math</span>.abs(house - heaters[low]);</span><br><span class="line">    <span class="keyword">let</span> middle = <span class="built_in">Math</span>.floor((low + high) / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (house &lt; heaters[middle]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (middle === <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">Math</span>.abs(house - heaters[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (house &gt; heaters[middle - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Math</span>.min(<span class="built_in">Math</span>.abs(house - heaters[middle]), <span class="built_in">Math</span>.abs(house - heaters[middle - <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> closestHeaterDistance(house, heaters, low, middle - <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (house &gt; heaters[middle]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (middle === heaters.length - <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">Math</span>.abs(house - heaters[heaters.length - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (house &lt; heaters[middle + <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Math</span>.min(<span class="built_in">Math</span>.abs(house - heaters[middle]), <span class="built_in">Math</span>.abs(house - heaters[middle + <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> closestHeaterDistance(house, heaters, middle + <span class="number">1</span>, high)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//475. Heaters</span></span><br><span class="line"><span class="keyword">var</span> findRadius = <span class="function"><span class="keyword">function</span>(<span class="params">houses, heaters</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> radius = houses.map(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [x, <span class="number">0</span>, <span class="built_in">Number</span>.MAX_VALUE];</span><br><span class="line">    &#125;).concat(heaters.map(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [x, <span class="number">1</span>, <span class="built_in">Number</span>.MAX_VALUE]</span><br><span class="line">    &#125;));</span><br><span class="line">    radius.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a[<span class="number">0</span>] &gt; b[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[<span class="number">0</span>] &lt; b[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">updateRadius</span>(<span class="params">fromLeftToRight</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> indices = [];</span><br><span class="line">        <span class="keyword">var</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; radius.length; i++)</span><br><span class="line">            indices.push(i);</span><br><span class="line">        <span class="keyword">if</span> (!fromLeftToRight) &#123;</span><br><span class="line">            indices.reverse();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> curHeater = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; indices.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> idx = indices[i];</span><br><span class="line">            <span class="keyword">if</span> (radius[idx][<span class="number">1</span>] == <span class="number">1</span>)</span><br><span class="line">                curHeater = radius[idx][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (curHeater)</span><br><span class="line">                radius[idx][<span class="number">2</span>] = <span class="built_in">Math</span>.min(radius[idx][<span class="number">2</span>], <span class="built_in">Math</span>.abs(radius[idx][<span class="number">0</span>] - curHeater));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    updateRadius(<span class="literal">true</span>);</span><br><span class="line">    updateRadius(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; radius.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (radius[i][<span class="number">1</span>] === <span class="number">0</span>) &#123;</span><br><span class="line">            ret = <span class="built_in">Math</span>.max(ret, radius[i][<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//476. Number Complement</span></span><br><span class="line"><span class="keyword">var</span> findComplement = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newN;</span><br><span class="line">    <span class="keyword">var</span> n;</span><br><span class="line">    newN = (num.toString(<span class="number">2</span>)).split(<span class="string">''</span>);</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; newN.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (newN[i] == <span class="string">'1'</span>) &#123;</span><br><span class="line">            result[i] = <span class="string">'0'</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result[i] = <span class="string">'1'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    n = <span class="built_in">parseInt</span>(result.join(<span class="string">''</span>), <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//495. Teemo Attacking</span></span><br><span class="line"><span class="keyword">var</span> findPoisonedDuration = <span class="function"><span class="keyword">function</span>(<span class="params">timeSeries, duration</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timeSeries === <span class="literal">null</span> || timeSeries.length === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; timeSeries.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (timeSeries[i + <span class="number">1</span>] - timeSeries[i] &gt;= duration) &#123;</span><br><span class="line">            count += duration;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            count += timeSeries[i + <span class="number">1</span>] - timeSeries[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count + duration;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 500. Keyboard Row</span></span><br><span class="line"><span class="keyword">var</span> findWords = <span class="function"><span class="keyword">function</span>(<span class="params">words</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> resultWords = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; words.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isSameRow(words[i]))</span><br><span class="line">            resultWords.push(words[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> resultWords;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> isSameRow = <span class="function"><span class="keyword">function</span>(<span class="params">word</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> rowNumber = getKeyboardRow(word.charAt(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; word.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (getKeyboardRow(word.charAt(i)) !== rowNumber)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> getKeyboardRow = <span class="function"><span class="keyword">function</span>(<span class="params">char</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> currentChar = char.toLowerCase();</span><br><span class="line">    <span class="keyword">var</span> charRowMap = &#123;</span><br><span class="line">        <span class="string">"q"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"w"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"e"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"r"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"t"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"y"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"u"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"i"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"o"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"p"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">"a"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"s"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"d"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"f"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"g"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"h"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"j"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"k"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"l"</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="string">"z"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"x"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"c"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"v"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"b"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"n"</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="string">"m"</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> charRowMap[currentChar];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 500. Keyboard Row</span></span><br><span class="line"><span class="keyword">var</span> findWords = <span class="function"><span class="keyword">function</span>(<span class="params">words</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wordsNew = [],</span><br><span class="line">        result = [],</span><br><span class="line">        keyboard = [<span class="string">"qwertyuiop"</span>, <span class="string">"asdfghjkl"</span>, <span class="string">"zxcvbnm"</span>];</span><br><span class="line">    words.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele, index</span>) </span>&#123;</span><br><span class="line">        wordsNew[index] = ele.toLowerCase()</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    wordsNew.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">ele, index</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> flag1 = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; ele.length; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (keyboard[j].indexOf(ele[i]) == <span class="number">-1</span>) &#123;</span><br><span class="line">                    flag1++</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (flag1 === <span class="number">0</span>) &#123;</span><br><span class="line">                result.push(words[index])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 500. Keyboard Row</span></span><br><span class="line"><span class="keyword">var</span> findWords = <span class="function"><span class="keyword">function</span>(<span class="params">words</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">        top: <span class="string">'qwertyuiop'</span>,</span><br><span class="line">        center: <span class="string">'asdfghjkl'</span>,</span><br><span class="line">        bottom: <span class="string">'zxcvbnm'</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> val <span class="keyword">of</span> words) &#123;</span><br><span class="line">        <span class="keyword">let</span> vals = val.toLowerCase();</span><br><span class="line">        <span class="keyword">let</span> target;</span><br><span class="line">        <span class="keyword">let</span> record = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> <span class="built_in">Object</span>.values(obj)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (~v.indexOf(vals[<span class="number">0</span>])) target = v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> alpha <span class="keyword">of</span> vals) &#123;</span><br><span class="line">            <span class="keyword">if</span> (~target.indexOf(alpha)) record += <span class="string">'1'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (record.length === vals.length) arr.push(val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 500. Keyboard Row</span></span><br><span class="line"><span class="keyword">var</span> findWords = <span class="function"><span class="keyword">function</span>(<span class="params">words</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">        top: <span class="string">'qwertyuiop'</span>,</span><br><span class="line">        center: <span class="string">'asdfghjkl'</span>,</span><br><span class="line">        bottom: <span class="string">'zxcvbnm'</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> val <span class="keyword">of</span> words) &#123;</span><br><span class="line">        <span class="keyword">let</span> vals = val.toLowerCase();</span><br><span class="line">        <span class="keyword">let</span> target;</span><br><span class="line">        <span class="keyword">let</span> alpha = vals.split(<span class="string">''</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> <span class="built_in">Object</span>.values(obj)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (~v.indexOf(vals[<span class="number">0</span>])) target = v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (alpha.every(<span class="function"><span class="params">value</span> =&gt;</span> ~target.indexOf(value))) arr.push(val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 500. Keyboard Row</span></span><br><span class="line"><span class="keyword">var</span> findWords = <span class="function">(<span class="params">words</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">Map</span> = &#123;</span><br><span class="line">        q: <span class="number">1</span>,</span><br><span class="line">        w: <span class="number">1</span>,</span><br><span class="line">        e: <span class="number">1</span>,</span><br><span class="line">        r: <span class="number">1</span>,</span><br><span class="line">        t: <span class="number">1</span>,</span><br><span class="line">        y: <span class="number">1</span>,</span><br><span class="line">        u: <span class="number">1</span>,</span><br><span class="line">        i: <span class="number">1</span>,</span><br><span class="line">        o: <span class="number">1</span>,</span><br><span class="line">        p: <span class="number">1</span>,</span><br><span class="line">        a: <span class="number">2</span>,</span><br><span class="line">        s: <span class="number">2</span>,</span><br><span class="line">        d: <span class="number">2</span>,</span><br><span class="line">        f: <span class="number">2</span>,</span><br><span class="line">        g: <span class="number">2</span>,</span><br><span class="line">        h: <span class="number">2</span>,</span><br><span class="line">        j: <span class="number">2</span>,</span><br><span class="line">        k: <span class="number">2</span>,</span><br><span class="line">        l: <span class="number">2</span>,</span><br><span class="line">        z: <span class="number">3</span>,</span><br><span class="line">        x: <span class="number">3</span>,</span><br><span class="line">        c: <span class="number">3</span>,</span><br><span class="line">        v: <span class="number">3</span>,</span><br><span class="line">        b: <span class="number">3</span>,</span><br><span class="line">        n: <span class="number">3</span>,</span><br><span class="line">        m: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> RightWords = []</span><br><span class="line">    words.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (item.length == <span class="number">1</span>) RightWords.push(item)</span><br><span class="line">        temp = <span class="built_in">Map</span>[item[<span class="number">0</span>].toLowerCase()]</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>, length = item.length; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (temp != <span class="built_in">Map</span>[item[i].toLowerCase()]) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i == item.length - <span class="number">1</span>) &#123;</span><br><span class="line">                RightWords.push(item)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> RightWords;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">String</span>.prototype.reverse = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.split(<span class="string">""</span>).reverse().join(<span class="string">""</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 501. Find Mode in Binary Search Tree</span></span><br><span class="line"><span class="keyword">var</span> findMode = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res = [];</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> tem;</span><br><span class="line">    <span class="keyword">var</span> temCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> maxCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> pNode = root;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (pNode !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> pLeft = pNode.left;</span><br><span class="line">        <span class="keyword">if</span> (pLeft) &#123;</span><br><span class="line">            <span class="keyword">while</span> (pLeft.right !== <span class="literal">null</span> &amp;&amp; pLeft.right !== pNode) &#123;</span><br><span class="line">                pLeft = pLeft.right;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pLeft.right === <span class="literal">null</span>) &#123;</span><br><span class="line">                pLeft.right = pNode;</span><br><span class="line">                pNode = pNode.left;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                pLeft.right = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pNode.val === tem) &#123;</span><br><span class="line">            temCount++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (tem !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (temCount &gt; maxCount) &#123;</span><br><span class="line">                    res.length = <span class="number">0</span>;</span><br><span class="line">                    maxCount = temCount;</span><br><span class="line">                    res.push(tem);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (temCount === maxCount) &#123;</span><br><span class="line">                    res.push(tem);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tem = pNode.val;</span><br><span class="line">            temCount = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pNode = pNode.right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (temCount &gt; maxCount) &#123;</span><br><span class="line">        res.length = <span class="number">0</span>;</span><br><span class="line">        maxCount = temCount;</span><br><span class="line">        res.push(tem);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (temCount === maxCount) &#123;</span><br><span class="line">        res.push(tem);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//521. Longest Uncommon Subsequence I</span></span><br><span class="line"><span class="keyword">var</span> findLUSlength = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a == b ? <span class="number">-1</span> : <span class="built_in">Math</span>.max(a.length, b.length);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//525. Contiguous Array</span></span><br><span class="line"><span class="keyword">var</span> findMaxLength = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums.length &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Could save some space by modifying nums but we still use O(n)</span></span><br><span class="line">    <span class="keyword">let</span> sums = [<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">let</span> maxIndexes = &#123;</span><br><span class="line">        <span class="string">'0'</span>: <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        sums.push(sums[i] + (nums[i] || <span class="number">-1</span>));</span><br><span class="line">        maxIndexes[sums[i + <span class="number">1</span>]] = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; sums.length; i++) &#123;</span><br><span class="line">        max = <span class="built_in">Math</span>.max(max, maxIndexes[sums[i]] - i);</span><br><span class="line">        <span class="keyword">if</span> (max &gt;= sums.length - i - <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//530. Minimum Absolute Difference in BST</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMinimumDifference</span>(<span class="params">root, vals = &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    prev: undefined,</span></span></span><br><span class="line"><span class="function"><span class="params">    min: Number.MAX_VALUE</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getMinimumDifference(root.left, vals);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vals.prev &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        vals.min = <span class="built_in">Math</span>.min(<span class="built_in">Math</span>.abs(vals.prev - root.val), vals.min);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vals.prev = root.val;</span><br><span class="line"></span><br><span class="line">    getMinimumDifference(root.right, vals);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> vals.min;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 532. K-diff Pairs in an Array</span></span><br><span class="line"><span class="keyword">var</span> findPairs = <span class="function"><span class="keyword">function</span>(<span class="params">nums, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> seen = &#123;&#125;;</span><br><span class="line">    <span class="keyword">let</span> pairs = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> nums.reduce(<span class="function">(<span class="params">count, a</span>) =&gt;</span> &#123;</span><br><span class="line">        count += isNewPair(seen, pairs, a, a - k) + isNewPair(seen, pairs, a, a + k);</span><br><span class="line">        seen[a] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNewPair</span>(<span class="params">seen, pairs, a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!seen[b]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">let</span> key = a &lt; b ? a + <span class="string">','</span> + b : b + <span class="string">','</span> + a;</span><br><span class="line">    <span class="keyword">if</span> (!pairs[key]) &#123;</span><br><span class="line">        pairs[key] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//541. Reverse String II</span></span><br><span class="line"><span class="keyword">var</span> reverseStr = <span class="function"><span class="keyword">function</span>(<span class="params">s, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = s.length;</span><br><span class="line">    <span class="keyword">if</span> (len &lt; <span class="number">2</span> * k) &#123; <span class="comment">// Check if length is less than 2*k</span></span><br><span class="line">        <span class="keyword">if</span> (len &gt;= k)</span><br><span class="line">            <span class="comment">// reverse the first k chars and leave the rest as orig</span></span><br><span class="line">            <span class="keyword">return</span> s.slice(<span class="number">0</span>, k).reverse() + s.slice(k)</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> s.reverse(); <span class="comment">// if less than k, return orig</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s.slice(<span class="number">0</span>, k).reverse() + <span class="comment">// reverse first k chars</span></span><br><span class="line">        s.slice(k, <span class="number">2</span> * k) + <span class="comment">// leave chars from k to 2k as orig</span></span><br><span class="line">        reverseStr(s.slice(<span class="number">2</span> * k), k); <span class="comment">// recurs</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//557. Reverse Words in a String III</span></span><br><span class="line"><span class="keyword">var</span> reverseWords = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newS = s.split(<span class="string">' '</span>);</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; newS.length; i++) &#123;</span><br><span class="line">        result.push(newS[i].split(<span class="string">''</span>).reverse().join(<span class="string">''</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result.join(<span class="string">' '</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>æµè§ˆå™¨ç¼“å­˜æœºåˆ¶</title>
    <url>/2020/01/03/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<p>å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œè¯·æ±‚çš„æ¥å£è²Œä¼¼è¢«ç¼“å­˜ä½äº†ï¼Œæ˜¾ç¤ºprovisional headers are shown<br>å¦‚ä½•è®©æˆ‘ä»¬çš„æµè§ˆå™¨æ˜¾ç¤ºfrom cache å­—æ ·å‘¢ï¼Ÿä½†æ˜¯æ¥å£æ˜¾ç¤ºçš„æ˜¯cacheï¼šno-cache</p>
<a id="more"></a>

<p>1ã€ å¤ç°æƒ…å†µ<br>2ã€ è§£å†³è¢«éšè—çš„æƒ…å†µ</p>
<p>HTTP æä¾›äº†ç”¨æ¥å¯¹å·²ç¼“å­˜å¯¹è±¡è¿›è¡Œå†éªŒè¯çš„å·¥å…·ï¼Œæœ€å¸¸ç”¨çš„æ˜¯If-Modified-Since é¦–éƒ¨ï¼Œ</p>
<h3 id="è¿‡æœŸæ—¥æœŸå’Œä½¿ç”¨æœŸ"><a href="#è¿‡æœŸæ—¥æœŸå’Œä½¿ç”¨æœŸ" class="headerlink" title="è¿‡æœŸæ—¥æœŸå’Œä½¿ç”¨æœŸ"></a>è¿‡æœŸæ—¥æœŸå’Œä½¿ç”¨æœŸ</h3><p>Cache-Control é¦–éƒ¨å’Œ Expires é¦–éƒ¨ï¼ŒHTTPè®©æ¯ä¸ªåŸå§‹æœåŠ¡å™¨å‘æ¯ä¸ªæ–‡æ¡£é™„åŠ ä¸€ä¸ªâ€è¿‡æœŸæ—¶é—´â€</p>
<h3 id="æœåŠ¡å™¨å†éªŒè¯"><a href="#æœåŠ¡å™¨å†éªŒè¯" class="headerlink" title="æœåŠ¡å™¨å†éªŒè¯"></a>æœåŠ¡å™¨å†éªŒè¯</h3><blockquote>
<p>è¯´æ˜ç¼“å­˜éœ€è¦è¯¢é—®åŸå§‹æœåŠ¡å™¨æ–‡æ¡£æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–</p>
</blockquote>
<ul>
<li>å¦‚æœå†éªŒè¯æ˜¾ç¤ºå†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œç¼“å­˜ä¼šè·å–ä¸€ä»½æ–°çš„æ–‡æ¡£å‰¯æœ¬ï¼Œå¹¶å°†å…¶å­˜åœ¨æ—§æ–‡æ¡£çš„ä½ç½®ä¸Šï¼Œç„¶åå°†æ–‡æ¡£å‘é€ç»™å®¢æˆ·ç«¯</li>
<li>å¦‚æœå†éªŒè¯æ˜¾ç¤ºå†…å®¹æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œç¼“å­˜åªéœ€è¦è·å–æ–°çš„é¦–éƒ¨ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæ–°çš„è¿‡æœŸæ—¶é—´ï¼Œå¹¶å¯¹ç¼“å­˜é¦–éƒ¨è¿›è¡Œæ›´æ–°</li>
</ul>
<h3 id="æ¡ä»¶æ–¹æ³•å†éªŒè¯"><a href="#æ¡ä»¶æ–¹æ³•å†éªŒè¯" class="headerlink" title="æ¡ä»¶æ–¹æ³•å†éªŒè¯"></a>æ¡ä»¶æ–¹æ³•å†éªŒè¯</h3><blockquote>
<p>HTTP å…è®¸ç¼“å­˜å‘åŸå§‹æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¡ä»¶â€GETâ€ï¼Œè¯·æ±‚æœåŠ¡å™¨åªåœ¨æ–‡æ¡£ä¸ç¼“å­˜ä¸­ç°æœ‰çš„å‰¯æœ¬ä¸åŒæ—¶ï¼Œæ‰å›é€å¯¹è±¡ä¸»ä½“</p>
</blockquote>
<h4 id="HTTPå®šä¹‰çš„5ä¸ªæ¡ä»¶é¦–éƒ¨"><a href="#HTTPå®šä¹‰çš„5ä¸ªæ¡ä»¶é¦–éƒ¨" class="headerlink" title="HTTPå®šä¹‰çš„5ä¸ªæ¡ä»¶é¦–éƒ¨"></a>HTTPå®šä¹‰çš„5ä¸ªæ¡ä»¶é¦–éƒ¨</h4><ul>
<li><p>If-Modified-Since:<date> Dateå†éªŒè¯</p>
<ul>
<li>è‡ªæŒ‡å®šæ—¥æœŸåï¼Œæ–‡æ¡£è¢«ä¿®æ”¹ï¼ŒIf-Modified-Since ä¸ºçœŸã€‚GET ä¼šæˆåŠŸæ‰§è¡Œï¼Œæºå¸¦æ–°é¦–éƒ¨çš„æ–°æ–‡æ¡£è¿”å›ç»™ç¼“å­˜ï¼Œæ–°é¦–éƒ¨ä¼šåŒ…å«ä¸€ä¸ªæ–°çš„è¿‡æœŸæ—¶é—´</li>
<li>è‡ªæŒ‡å®šæ—¥æœŸåï¼Œæ–‡æ¡£æœªä¿®æ”¹ï¼Œä¼šæƒ³å®¢æˆ·ç«¯è¿”å›304 not modifiedå“åº”æŠ¥æ–‡ã€‚</li>
<li>åŸå§‹æœåŠ¡å™¨ä¼šå°†æœ€åçš„ä¿®æ”¹æ—¥æœŸé™„åŠ åˆ°æ‰€æä¾›çš„æ–‡æ¡£ä¸Šå»</li>
</ul>
</li>
<li><p>If-None-Match:<tags> å®ä½“æ ‡ç­¾å†éªŒè¯</p>
<ul>
<li>æœ‰äº›æ–‡æ¡£çœ‹ä½ ä¼šè¢«å‘¨æœŸæ€§é‡å†™ï¼Œä½†å®é™…åŒ…å«çš„æ•°æ®é€šå¸¸ä¸€æ ·ã€‚å°½ç®¡å†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯ä¿®æ”¹æ—¥æœŸä¼šå‘ç”Ÿå˜åŒ–</li>
<li>æœ‰äº›æ–‡æ¡£ä¿®æ”¹ï¼Œä½†ä¿®æ”¹çš„å†…å®¹å¹¶ä¸é‡è¦</li>
<li>â€¦ .</li>
</ul>
</li>
</ul>
<p>å®ä½“æ ‡ç­¾æ˜¯é™„åŠ åˆ°æ–‡æ¡£ä¸Šçš„ä»»æ„æ ‡ç­¾ï¼Œå®ƒä»¬å¯èƒ½åŒ…å«äº†æ–‡æ¡£çš„åºåˆ—å·æˆ–ç‰ˆæœ¬å ETag</p>
]]></content>
  </entry>
  <entry>
    <title>æµ‹è¯•é¢˜</title>
    <url>/2019/12/28/%E6%B5%8B%E8%AF%95%E9%A2%98/</url>
    <content><![CDATA[<h2 id="å·¥ä½œä¸­é‡åˆ°çš„JSè®­ç»ƒ"><a href="#å·¥ä½œä¸­é‡åˆ°çš„JSè®­ç»ƒ" class="headerlink" title="å·¥ä½œä¸­é‡åˆ°çš„JSè®­ç»ƒ"></a>å·¥ä½œä¸­é‡åˆ°çš„JSè®­ç»ƒ</h2><a id="more"></a>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">    resolve(<span class="number">3</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">2</span>); <span class="comment">//1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">    resolve(<span class="number">3</span>);</span><br><span class="line">    <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="number">4</span>));</span><br><span class="line">&#125;).then(<span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">2</span>); <span class="comment">//1 2 4 3</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çº¢ç¯ä¸‰ç§’äº®ä¸€æ¬¡ï¼Œç»¿ç¯ä¸€ç§’äº®ä¸€æ¬¡ï¼Œé»„ç¯2ç§’äº®ä¸€æ¬¡ï¼Œæ„æ€å°±æ˜¯3ç§’ï¼Œæ‰§è¡Œä¸€æ¬¡ red å‡½æ•°ï¼Œ2ç§’æ‰§è¡Œä¸€æ¬¡ green å‡½æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">// 1ç§’æ‰§è¡Œä¸€æ¬¡ yellow å‡½æ•°ï¼Œä¸æ–­äº¤æ›¿é‡å¤äº®ç¯ï¼Œæ„æ€å°±æ˜¯æŒ‰ç…§è¿™ä¸ªé¡ºåºä¸€ç›´æ‰§è¡Œè¿™3ä¸ªå‡½æ•°ï¼Œè¿™æ­¥å¯ä»¥å°±åˆ©ç”¨é€’å½’æ¥å®ç°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">Promise</span> = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">"success1"</span>);</span><br><span class="line">    reject(<span class="string">"error"</span>);</span><br><span class="line">    resolve(<span class="string">"success2"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"then:"</span>, res);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"catch:"</span>, err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">red</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"red"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">green</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"green"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">yellow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"yellow"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> step = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Promise</span>.resolve()</span><br><span class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> light(<span class="number">3000</span>, red);</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> light(<span class="number">2000</span>, green);</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> light(<span class="number">1000</span>, yellow);</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            step();</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> light = <span class="function"><span class="keyword">function</span>(<span class="params">timer, color</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            color();</span><br><span class="line">            resolve();</span><br><span class="line">        &#125;, timer);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">step();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰ 8 ä¸ªå›¾ç‰‡èµ„æºçš„ urlï¼Œå·²ç»å­˜å‚¨åœ¨æ•°ç»„ urls ä¸­ï¼ˆå³urls = ['http://example.com/1.jpg', ...., 'http://example.com/8.jpg']ï¼‰ï¼Œè€Œä¸”å·²ç»æœ‰ä¸€ä¸ªå‡½æ•° function loadImgï¼Œè¾“å…¥ä¸€ä¸ª url é“¾æ¥ï¼Œè¿”å›ä¸€ä¸ª Promiseï¼Œè¯¥ Promise åœ¨å›¾ç‰‡ä¸‹è½½å®Œæˆçš„æ—¶å€™ resolveï¼Œä¸‹è½½å¤±è´¥åˆ™ rejectã€‚</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯æˆ‘ä»¬è¦æ±‚ï¼Œä»»æ„æ—¶åˆ»ï¼ŒåŒæ—¶ä¸‹è½½çš„é“¾æ¥æ•°é‡ä¸å¯ä»¥è¶…è¿‡ 3 ä¸ªã€‚</span></span><br><span class="line"><span class="comment">// è¯·å†™ä¸€æ®µä»£ç å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œè¦æ±‚å°½å¯èƒ½å¿«é€Ÿåœ°å°†æ‰€æœ‰å›¾ç‰‡ä¸‹è½½å®Œæˆã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> urls = [</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/getImgDatadata.jpg"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/gray.gif"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/Particle.gif"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/arithmetic.png"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/arithmetic2.gif"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/getImgDataError.jpg"</span>,</span><br><span class="line">    <span class="string">"https://www.kkkk1000.com/images/getImgData/arithmetic.gif"</span>,</span><br><span class="line">    <span class="string">"https://user-gold-cdn.xitu.io/2018/10/29/166be40ccc434be0?w=600&amp;h=342&amp;f=png&amp;s=122185"</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">        img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆ"</span>);</span><br><span class="line">            resolve();</span><br><span class="line">        &#125;;</span><br><span class="line">        img.onerror = reject;</span><br><span class="line">        img.src = url;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">limitLoad</span>(<span class="params">urls, handler, limit</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> sequence = [].concat(urls);</span><br><span class="line">    <span class="keyword">let</span> promises = [];</span><br><span class="line">    promises = sequence.splice(<span class="number">0</span>, limit).map(<span class="function">(<span class="params">url, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> handler(url).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> index;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> sequence</span><br><span class="line">        .reduce(<span class="function">(<span class="params">last, url, currentIndex</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> last</span><br><span class="line">                .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="built_in">Promise</span>.race(promises);</span><br><span class="line">                &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(err);</span><br><span class="line">                &#125;)</span><br><span class="line">                .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    promises[res] = handler(sequence[currentIndex]).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> res;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;, <span class="built_in">Promise</span>.resolve())</span><br><span class="line">        .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Promise</span>.all(promises);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line">limitLoad(urls, loadImg, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Find</span>(<span class="params">target, array</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// write code here</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target === array[i][<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (target &gt; array[i][<span class="number">0</span>] &amp;&amp; array[i + <span class="number">1</span>][<span class="number">0</span>] &amp;&amp; target &lt; array[i + <span class="number">1</span>][<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; array[i][<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (target === array[i][j]) &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="literal">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                    target &gt; array[i][j] &amp;&amp;</span><br><span class="line">                    array[i][j + <span class="number">1</span>] &amp;&amp;</span><br><span class="line">                    target &lt; array[i][j + <span class="number">1</span>]</span><br><span class="line">                ) &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="literal">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Find(<span class="number">5</span>, [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">12</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">13</span>],</span><br><span class="line">    [<span class="number">6</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">15</span>]</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Defer(<span class="function"><span class="keyword">function</span>(<span class="params">res, rej</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            res(<span class="number">1</span>);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test()</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve then 1"</span>, value);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve then 2"</span>, value);</span><br><span class="line">        <span class="keyword">throw</span> <span class="number">2</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"error"</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">//ç»“æœ:</span></span><br><span class="line"><span class="comment">//resolve then 1 1</span></span><br><span class="line"><span class="comment">//resolve then 2 1</span></span><br><span class="line"><span class="comment">//error 2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Defer(<span class="function"><span class="keyword">function</span>(<span class="params">res, rej</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            rej(<span class="number">1</span>);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test2()</span><br><span class="line">    .then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"reject then 1"</span>, value);</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">"error 1"</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"reject then 2"</span>, value);</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">"error 2"</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"error"</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">//ç»“æœ:</span></span><br><span class="line"><span class="comment">//reject then 1 1</span></span><br><span class="line"><span class="comment">//reject then 2 error 2</span></span><br><span class="line"><span class="comment">//error erro 2</span></span><br><span class="line"></span><br><span class="line">test2()</span><br><span class="line">    .then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"reject then 1"</span>, value);</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">"throw error from then 1"</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve then 2"</span>, value);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"error"</span>, e);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">//ç»“æœ:</span></span><br><span class="line"><span class="comment">//reject then 1 1</span></span><br><span class="line"><span class="comment">//error throw error from then 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯·æ±‚æŸä¸ªå›¾ç‰‡èµ„æº</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestImg</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">        img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            resolve(img);</span><br><span class="line">        &#125;;</span><br><span class="line">        img.src = <span class="string">"xxxxxx"</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å»¶æ—¶å‡½æ•°ï¼Œç”¨äºç»™è¯·æ±‚è®¡æ—¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            reject(<span class="string">"å›¾ç‰‡è¯·æ±‚è¶…æ—¶"</span>);</span><br><span class="line">        &#125;, <span class="number">5000</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.race([requestImg(), timeout()])</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">results</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(results);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(reason);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// promiseå®ç°å¹¶è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> datum = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    datum.push(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all(</span><br><span class="line">    datum.map(<span class="function"><span class="params">i</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(i * <span class="number">200</span> + <span class="string">" msåæ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">                resolve(<span class="string">"ç¬¬ "</span> + (i + <span class="number">1</span>) + <span class="string">" ä¸ªpromiseæ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">            &#125;, i * <span class="number">200</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> asyncFun = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> datum = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        datum.push(</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(i * <span class="number">200</span> + <span class="string">"ms åæ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">                    resolve(<span class="string">"ç¬¬ "</span> + (i + <span class="number">1</span>) + <span class="string">" ä¸ª Promise æ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">                &#125;, i * <span class="number">200</span>);</span><br><span class="line">            &#125;)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> result = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> promise <span class="keyword">in</span> datum) &#123;</span><br><span class="line">        result.push(<span class="keyword">await</span> promise);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;;</span><br><span class="line">asyncFun();</span><br><span class="line"></span><br><span class="line"><span class="comment">// promiseå®ç°ä¸²è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> datum = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    datum.push(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> serial = <span class="built_in">Promise</span>.resolve();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> datum) &#123;</span><br><span class="line">    serial = serial.then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(i * <span class="number">200</span> + <span class="string">" ms åæ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">                resolve(<span class="string">"ç¬¬ "</span> + (i + <span class="number">1</span>) + <span class="string">" ä¸ª Promise æ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">            &#125;, i * <span class="number">200</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> datum = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    datum.push(i);</span><br><span class="line">&#125;</span><br><span class="line">datum.reduce(<span class="function">(<span class="params">prev, cur</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> prev.then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(cur * <span class="number">200</span> + <span class="string">" ms åæ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">                resolve(<span class="string">"ç¬¬ "</span> + (cur + <span class="number">1</span>) + <span class="string">" ä¸ª Promise æ‰§è¡Œç»“æŸ"</span>);</span><br><span class="line">            &#125;, cur * <span class="number">200</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;, <span class="built_in">Promise</span>.resolve(<span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// å€¼ç©¿é€</span></span><br><span class="line"><span class="comment">// å½“ä½ ç»™ then() ä¼ é€’ä¸€ä¸ªéå‡½æ•°ï¼ˆæ¯”å¦‚ä¸€ä¸ª promise ï¼‰å€¼çš„æ—¶å€™ï¼Œ</span></span><br><span class="line"><span class="comment">// å®ƒå®é™…ä¸Šä¼šè§£é‡Šä¸º then(null) ï¼Œè¿™ä¼šå¯¼è‡´ä¹‹å‰çš„ promise çš„ç»“æœä¸¢å¤±</span></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">"hello world"</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">promise.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    promise</span><br><span class="line">        .then()</span><br><span class="line">        .then(<span class="literal">null</span>)</span><br><span class="line">        .then(<span class="string">"some code"</span>)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res);</span><br><span class="line">        &#125;);</span><br><span class="line">    promise</span><br><span class="line">        .catch()</span><br><span class="line">        .catch(<span class="literal">null</span>)</span><br><span class="line">        .then(<span class="string">"some code"</span>)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ°¸è¿œä¸è¦åœ¨å›è°ƒé˜Ÿåˆ—ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºå›è°ƒé˜Ÿåˆ—è„±ç¦»äº†è¿è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå¼‚å¸¸æ— æ³•è¢«å½“å‰ä½œç”¨åŸŸæ•è·ã€‚</span></span><br><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"This is an error"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">    .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(result);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"handle error: "</span>, error); <span class="comment">// Error: This is an error</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * https://mp.weixin.qq.com/s/hdvPdTUR7lfnoWl2aO2Cig </span></span><br><span class="line"><span class="comment"> * JSå¼•æ“æ˜¯æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼ˆå•çº¿ç¨‹ï¼‰,æ‰€è°“çš„JSå¼‚æ­¥å¹¶ä¸æ˜¯äº¤ç”±JSå¼•æ“å»å®Œæˆçš„ï¼Œè€Œæ˜¯äº¤ç»™æµè§ˆå™¨çš„å…¶ä»–çº¿ç¨‹å»å®Œæˆã€‚</span></span><br><span class="line"><span class="comment"> * JSå¼‚æ­¥æ“ä½œè¿˜ä¼šæ¶‰åŠåˆ°JSäº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚</span></span><br><span class="line"><span class="comment"> * JS äº‹ä»¶å¾ªç¯ : </span></span><br><span class="line"><span class="comment"> * å¦‚æœæ˜¯setTimeout/setIntervalå®šæ—¶å¼‚æ­¥ä»»åŠ¡ï¼Œæµè§ˆå™¨çš„æ¸²æŸ“è¿›ç¨‹å°±ä¼šå¼€ä¸€ä¸ªå®šæ—¶å™¨è§¦å‘çº¿ç¨‹å»æ‰§è¡Œï¼Œå½“å®šæ—¶æ—¶é—´ä¸€åˆ°ï¼Œ</span></span><br><span class="line"><span class="comment"> * å°±ä¼šé€šçŸ¥äº‹ä»¶è§¦å‘çº¿ç¨‹å°†å®šæ—¶å™¨çš„å›è°ƒæ–¹æ³•æ¨é€è‡³äº‹ä»¶ä»»åŠ¡é˜Ÿåˆ—çš„ä¸€ä¸ªå®ä»»åŠ¡é˜Ÿåˆ—çš„åˆ—å°¾ï¼Œ</span></span><br><span class="line"><span class="comment"> * ç­‰å¾…JSå¼•æ“æ‰§è¡Œå®ŒåŒæ­¥ä»»åŠ¡åï¼Œå†ä»äº‹ä»¶ä»»åŠ¡é˜Ÿåˆ—ä¸­ä»å¤´å–å‡ºè¦æ‰§è¡Œçš„å›è°ƒæ–¹æ³•ã€‚å…¶ä»–å¼‚æ­¥ä»»åŠ¡ä¹Ÿæ˜¯è¿™ä¹ˆä¸€ä¸ªæµç¨‹ã€‚</span></span><br><span class="line"><span class="comment"> * è¿™å°±æ˜¯æ‰€è°“çš„JSäº‹ä»¶å¾ªç¯ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * promiseæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒé‡Œé¢è£…çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼ˆæŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼‰çš„ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPromise</span>(<span class="params">p, arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (arg === <span class="number">0</span>) &#123;</span><br><span class="line">                reject(p + <span class="string">' fail'</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                resolve(p + <span class="string">' ok'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">200</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createPromise(<span class="string">"p1"</span>, <span class="number">1</span>).then(<span class="function">(<span class="params">success1</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(success1)</span><br><span class="line">    <span class="keyword">return</span> createPromise(<span class="string">"p2"</span>, <span class="number">0</span>)</span><br><span class="line">&#125;, (reject) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(reject)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœæ²¡æœ‰returnçš„è¯æ˜¯ä¸ä¼šè¢«catchä½çš„ *** </span></span><br><span class="line">createPromise(<span class="string">"p1"</span>, <span class="number">1</span>).then(<span class="function">(<span class="params">success1</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(success1)</span><br><span class="line">    <span class="keyword">return</span> createPromise(<span class="string">"p2"</span>, <span class="number">0</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">createPromise(<span class="string">"p1"</span>, <span class="number">0</span>).then(<span class="function">(<span class="params">success1</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(success1)</span><br><span class="line">    <span class="keyword">return</span> createPromise(<span class="string">"p2"</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">createPromise(<span class="string">"p1"</span>, <span class="number">1</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">success1</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"æ­£åœ¨æ‰§è¡Œ "</span> + success1)</span><br><span class="line">    <span class="keyword">return</span> createPromise(<span class="string">"p2"</span>, <span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¼–ç¨‹é¢è¯•é¢˜ä¹‹æœ€å¤§å¹¶è¡Œä»»åŠ¡æ± ï¼š</span></span><br><span class="line"><span class="comment"> * 1ï¼‰ç»™å®šä¸€ä¸ª taskList å’Œ poolSizeï¼›</span></span><br><span class="line"><span class="comment"> * 2ï¼‰task æ˜¯å¼‚æ­¥çš„ï¼Œè¿”å› promiseï¼›</span></span><br><span class="line"><span class="comment"> * 3ï¼‰task ä¸ä¼šå¤±è´¥ã€‚</span></span><br><span class="line"><span class="comment"> * è¦æ±‚ï¼š</span></span><br><span class="line"><span class="comment"> * 1ï¼‰åŒæ—¶ä¸èƒ½æœ‰è¶…è¿‡ poolSize çš„ task åœ¨æ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment"> * 2ï¼‰æ‰€æœ‰ taskList é‡Œçš„ task æœ€ç»ˆéƒ½æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> sequence = <span class="keyword">async</span> getNextTask =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> task = getNextTask()</span><br><span class="line">    <span class="keyword">if</span> (!task) <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">await</span> task()</span><br><span class="line">    <span class="keyword">await</span> sequence(getNextTask)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> parallel = <span class="keyword">async</span> (getNextTask, size) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> taskList = <span class="built_in">Array</span>.from(&#123;</span><br><span class="line">        length: size</span><br><span class="line">    &#125;, getNextTask)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.all(taskList.filter(<span class="built_in">Boolean</span>).map(<span class="function"><span class="params">task</span> =&gt;</span> task()))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> buffer = <span class="keyword">async</span> (taskList, size = <span class="number">1</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> getNextTask = <span class="function"><span class="params">()</span> =&gt;</span> taskList[count++]</span><br><span class="line">    <span class="keyword">return</span> parallel(<span class="function"><span class="params">()</span> =&gt;</span> <span class="function"><span class="params">()</span> =&gt;</span> sequence(getNextTask), size)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buffer = <span class="function">(<span class="params">data, size</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> runtasks = [...data]</span><br><span class="line">    <span class="keyword">let</span> run = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (runtasks.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> task = runtasks.shift()</span><br><span class="line">            <span class="keyword">await</span> task()</span><br><span class="line">            run()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        run()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> delay = <span class="function"><span class="params">time</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, time))</span><br><span class="line"><span class="keyword">const</span> data = <span class="built_in">Array</span>.from(&#123;</span><br><span class="line">    length: <span class="number">100</span></span><br><span class="line">&#125;, (_, i) =&gt; <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'enter'</span>, i)</span><br><span class="line">    <span class="keyword">await</span> delay(<span class="built_in">Math</span>.random() * <span class="number">10</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'leave'</span>, i)</span><br><span class="line">&#125;)</span><br><span class="line">buffer(data, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">    name: <span class="string">'person1'</span>,</span><br><span class="line">    show1: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line">    show2: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.name</span><br><span class="line">    &#125;,</span><br><span class="line">    show3: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    show4: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person2 = &#123;</span><br><span class="line">    name: <span class="string">'person2'</span></span><br><span class="line">&#125;</span><br><span class="line">person1.show1()</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>JSè®­ç»ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>å¿«æ·é”®æ±‡æ€»</title>
    <url>/2019/12/28/%E5%BF%AB%E6%8D%B7%E9%94%AE%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<p><a href="http://fe.surge.sh/guide/" target="_blank" rel="noopener">ç†Ÿç»ƒä½¿ç”¨å¿«æ·é”®</a></p>
<a id="more"></a>

<p><code>option + delete</code> åˆ é™¤åä¸€ä¸ªå­—ç¬¦<br><code>cmd + M</code> æœ€å°åŒ–å½“å‰çª—å£<br><code>cmd + w</code> å…³é—­å½“å‰çª—å£<br><code>ctrl+tab</code> åˆ‡æ¢ <code>Chrome tab</code><br><code>command + tab</code> åˆ‡æ¢ ç¨‹åº <code>tab</code><br><code>ctrl + a</code> å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–<br><code>ctrl + e</code> å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾<br><code>ctrl + r</code> æ‰“å¼€æŸæ–‡ä»¶å¤¹<br><code>cmd + n</code> æ‰“å¼€æ–°çª—å£<br><code>cmd + m</code> ç¨‹åºçª—å£æœ€å°åŒ–<br><code>option + shift + f</code> vscodeæ ¼å¼åŒ–ä»£ç <br><code>shift</code> + é¼ æ ‡ç‚¹å‡»ä¸¤æ¬¡ é€‰ä¸­ ä»£ç å—<br><code>cmd + p</code> å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶<br><code>ctrl + a/e</code> å¿«é€Ÿåˆ‡æ¢åˆ°å½“å‰æ­£åœ¨è¾“å…¥çš„æ–‡æœ¬çš„å¤´éƒ¨ï¼å°¾éƒ¨<br><code>ctrl + u</code> æ¸…ç©ºå½“å‰è¾“å…¥<br><code>cmd + T</code> æ‰“å¼€ä¸€ä¸ªæ–°çš„iterm2 Tab<br><code>cmd + æ–¹å‘é”®</code> å·¦å³åˆ‡æ¢Tab<br><code>cmd + D</code> åˆ†å±<br><code>cmd + K</code> æ¸…å±<br><code>cmd + N</code> æ‰“å¼€ä¸€ä¸ªæ–°çš„iterm2 çª—å£<br><code>cmd + k + s</code> æ‰“å¼€ keybinds.json</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123; &quot;key&quot;: &quot;cmd+1&quot;,           &quot;command&quot;: &quot;workbench.view.explorer&quot; &#125;,</span><br><span class="line">&#123; &quot;key&quot;: &quot;cmd+2&quot;,           &quot;command&quot;: &quot;workbench.view.search&quot; &#125;,</span><br><span class="line">&#123; &quot;key&quot;: &quot;cmd+3&quot;,           &quot;command&quot;: &quot;workbench.view.scm&quot; &#125;,</span><br><span class="line">&#123; &quot;key&quot;: &quot;cmd+4&quot;,           &quot;command&quot;: &quot;workbench.view.debug&quot; &#125;,</span><br><span class="line">&#123; &quot;key&quot;: &quot;cmd+5&quot;,           &quot;command&quot;: &quot;workbench.view.extensions&quot; &#125;</span><br></pre></td></tr></table></figure>

<p><code>cmd + p</code> æ ¹æ®å…³é”®å­—å¿«é€Ÿæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶<br><code>cmd + ,</code> æ‰“å¼€VS Codeé…ç½®é¡¹<br><code>cmd + d</code> å¿«é€Ÿé€‰å–å¤šä¸ªç›¸åŒçš„å†…å®¹å—<br><code>option + shift + é¼ æ ‡å·¦é”®</code> è®©å…‰æ ‡å¤šè¡Œé€‰å–<br><code>cmd + shift + h</code> å…¨å±€æ›¿æ¢å†…å®¹<br><code>cmd + shift + g</code> å¿«é€Ÿè¿›å…¥æŒ‡å®šæ–‡ä»¶å¤¹<br><code>cmd + shift + h</code> è¿›å…¥homeç›®å½•<br><code>cmd + shift + a</code> è¿›å…¥Applicationç›®å½•<br><code>cmd + shift + F</code> ä¸€æ¬¡æœç´¢æ‰€æœ‰æ–‡ä»¶çš„æ–‡æœ¬   (ctrl + shift + F)<br><code>cmd + shift + P</code> æ‰“å¼€å‘½ä»¤é¢æ¿    (ctrl + shift + P)<br><code>cmd + shift + T</code> é‡æ–°æ‰“å¼€ å…³é—­çš„ç¼–è¾‘é¡µé¢  (ctrl + shift + T )<br><code>cmd + T</code> é€šè¿‡åŒ¹é…æ–‡æœ¬æ‰“å¼€æ–‡ä»¶  (ctrl + T)<br><code>control +</code> æ‰“å¼€æˆ–è€…å…³é—­ç»ˆç«¯<br><code>ctrl + option + R</code> å…è®¸ä½ åœ¨é‡æ–°åŠ è½½ç¼–è¾‘å™¨æ—¶å°†çª—å£æ”¾åœ¨å‰é¢ï¼ŒåŒæ—¶å…·æœ‰ä¸å…³é—­å’Œé‡æ–°æ‰“å¼€çª—å£ç›¸åŒçš„æ•ˆæœã€‚ (ctrl + alt + R)<br><code>ctrl + Option + å³ç®­å¤´</code> å°†æ ‡ç­¾ç§»åŠ¨åˆ°å³ä¾§çš„ç»„  (ctrl+ alt + å³ç®­å¤´)<br><code>command + shift + Home/End</code> é€‰æ‹©å³ä¾§æˆ–å·¦ä¾§çš„æ‰€æœ‰å†…å®¹  ï¼ˆctrl+ shift + Home/End)<br><code>fn + å·¦æ–¹å‘é”® Home</code><br><code>fn + å³æ–¹å‘é”® End</code><br><code>fn + ä¸Šæ–¹å‘é”® page up</code><br><code>fn + ä¸‹æ–¹å‘é”® page down</code><br><code>option + delete</code> åˆ é™¤ä¸Šä¸€ä¸ªå•è¯  (ctrl + backspace)<br><code>option + shift + å³ç®­å¤´</code> é€ä¸ªé€‰æ‹©æ–‡æœ¬ (ctrl + shift + å³ç®­å¤´)<br><code>command + shift + å‘ä¸‹ç®­å¤´</code> å¤åˆ¶è¡Œ ï¼ˆshift + alt + å‘ä¸‹ç®­å¤´)<br><code>command + End</code> å°†å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶æœ€åä¸€è¡Œ  (ctrl + End)<br><code>command + F2</code> æ‰¹é‡æ›¿æ¢å½“å‰æ–‡ä»¶ä¸­æ‰€æœ‰åŒ¹é…åˆ°æ–‡æœ¬ (ctrl + F2)<br><code>command + å‘ä¸Šç®­å¤´</code> å½“å‰è¡Œå‘ä¸Šç§»åŠ¨ (alt + å‘ä¸Šç®­å¤´)<br><code>command + shift + pgUp/pgDown</code> å‘å·¦/å‘å³ç§»åŠ¨ç¼–è¾‘å™¨<br><code>ctrl + option + å‘ä¸‹ç®­å¤´</code> å¤åˆ¶å…‰æ ‡å‘ä¸‹æ‰¹é‡æ·»åŠ å†…å®¹ã€‚ ï¼ˆctrl + alt + å‘ä¸‹ç®­å¤´ï¼‰<br><code>ctrl + command + Q</code> é”å±</p>
<p><code>ctrl + tab</code> åˆ‡æ¢æµè§ˆå™¨æ ‡ç­¾é¡µ</p>
<p><code>ctrl + &quot;</code>â€œ<code>æ‰“å¼€vscodeç»ˆç«¯</code>ctrl + shift + â€œ<code>&quot;</code> æ–°å»ºvscodeç»ˆç«¯</p>
]]></content>
  </entry>
  <entry>
    <title>ç¼–å†™æœ‰å¼¹æ€§çš„ç»„ä»¶</title>
    <url>/2020/01/10/%E7%BC%96%E5%86%99%E6%9C%89%E5%BC%B9%E6%80%A7%E7%9A%84%E7%BB%84%E4%BB%B6/</url>
    <content><![CDATA[<p><a href="https://overreacted.io/zh-hans/writing-resilient-components/" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>
<a id="more"></a>

<h3 id="ä¸è¦é˜»æ­¢æ•°æ®æµ"><a href="#ä¸è¦é˜»æ­¢æ•°æ®æµ" class="headerlink" title="ä¸è¦é˜»æ­¢æ•°æ®æµ"></a>ä¸è¦é˜»æ­¢æ•°æ®æµ</h3><p>å½“åˆ«äººä½¿ç”¨ä½ çš„ç»„ä»¶çš„æ—¶å€™ï¼Œä»–ä»¬æœŸæœ›çš„æ˜¯ï¼Œä¸è®ºä»–ä»¬ä¼ é€’ä»€ä¹ˆpropsï¼Œç»„ä»¶å°†ååº”è¿™äº›å˜åŒ–</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Button</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    color,</span></span></span><br><span class="line"><span class="function"><span class="params">    children</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        button className = &#123;</span></span><br><span class="line"><span class="xml">            'Button-' + color</span></span><br><span class="line"><span class="xml">        &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">            children</span></span><br><span class="line"><span class="xml">        &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /button&gt;</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œï¼Œä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯ï¼ŒæŠŠpropså¤åˆ¶ç»™state</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        color: <span class="keyword">this</span>.props.color</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            color</span><br><span class="line">        &#125; = <span class="keyword">this</span>.state</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button className = &#123;</span></span><br><span class="line"><span class="xml">                'Button-' + color</span></span><br><span class="line"><span class="xml">            &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                this.props.children</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œé€šè¿‡å°†propå¤åˆ¶åˆ°stateï¼Œä½ å¿½ç•¥äº†å¯¹ä»–æ‰€æœ‰çš„æ›´æ–°ã€‚</p>
<p>è®¡ç®—å€¼æ˜¯å¦ä¸€ä¸ªå¤§å®¶å¯èƒ½ä¼šå°† props å¤åˆ¶åˆ° state çš„åœºæ™¯ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæƒ³è±¡ä¸€ä¸‹ æŒ‰é’®æ–‡å­— çš„é¢œè‰²æ˜¯æ ¹æ® color å±æ€§é€šè¿‡æ˜‚è´µè®¡ç®—å¾—æ¥ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        color: slowlyCalculateTextColor(<span class="keyword">this</span>.props.color)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button className = &#123;</span></span><br><span class="line"><span class="xml">                'Button-' + this.props.color +</span></span><br><span class="line"><span class="xml">                'Button-text-' + this.state.textColor</span></span><br><span class="line"><span class="xml">            &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                this.props.children</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç®€å•çš„ä¿®å¤æ˜¯æŠŠ textColor çš„è®¡ç®—æ”¾åˆ° render æ–¹æ³•ä¸­ï¼Œç„¶åæŠŠç»„ä»¶æ”¹ä¸º PureComponentï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> textColor = slowlyCaculateTextColor(<span class="keyword">this</span>.props.color)</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button className = &#123;</span></span><br><span class="line"><span class="xml">                'Button-' + this.props.color +</span></span><br><span class="line"><span class="xml">                'Button-text-' + textColor</span></span><br><span class="line"><span class="xml">            &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                this.props.children</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é—®é¢˜è§£å†³äº†ï¼ç°åœ¨å½“ props æ”¹å˜æ—¶é‡æ–°è®¡ç®— textColorï¼Œä½†æ˜¯åœ¨å±æ€§ä¸å˜æ—¶ï¼Œèƒ½é¿å…é‡å¤è¿›è¡Œæ˜‚è´µè®¡ç®—ã€‚</p>
<p>ç„¶è€Œï¼Œä¹Ÿè®¸æˆ‘ä»¬è¿˜èƒ½å†ä¼˜åŒ–ä¸€ä¸‹ã€‚å¦‚æœ children æ”¹å˜äº†å‘¢ï¼Ÿå¾ˆé—æ†¾ textColor åœ¨è¿™ç§æƒ…å†µä¸‹ä¼šé‡å¤è®¡ç®—ã€‚æˆ‘ä»¬ç¬¬äºŒæ¬¡å°è¯•å¯èƒ½æ˜¯é€šè¿‡åœ¨ componentDidUpdate ä¸­è°ƒç”¨è®¡ç®—ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        textColor: slowlyCaculateTextColor(<span class="keyword">this</span>.props.color)</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidUpdate(prevProps) &#123;</span><br><span class="line">        <span class="keyword">if</span> (prevProps.color !== <span class="keyword">this</span>.props.color) &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                textColor: slowlyCaculateTextColor(<span class="keyword">this</span>.props.color)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button className = &#123;</span></span><br><span class="line"><span class="xml">                'Button-' + this.props.color +</span></span><br><span class="line"><span class="xml">                ' Button-text- ' + this.state.textColor</span></span><br><span class="line"><span class="xml">            &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                this.props.children</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Button</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    color,</span></span></span><br><span class="line"><span class="function"><span class="params">    value</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> textColor = useMemo(<span class="function"><span class="params">()</span> =&gt;</span> slowlyCaculateTextColor(color), [color])</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        button className = &#123;</span></span><br><span class="line"><span class="xml">            'Button-' + color + 'Button-text-' + textColor</span></span><br><span class="line"><span class="xml">        &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">            children</span></span><br><span class="line"><span class="xml">        &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /button&gt;</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸è¦åœ¨-Side-Effects-é‡Œé˜»æ–­æ•°æ®æµ"><a href="#ä¸è¦åœ¨-Side-Effects-é‡Œé˜»æ–­æ•°æ®æµ" class="headerlink" title="ä¸è¦åœ¨ Side Effects é‡Œé˜»æ–­æ•°æ®æµ"></a>ä¸è¦åœ¨ Side Effects é‡Œé˜»æ–­æ•°æ®æµ</h4><p>è§£å†³æ–¹æ³•ï¼Œä½¿ç”¨useEffect</p>
<h3 id="æ—¶åˆ»å‡†å¤‡æ¸²æŸ“"><a href="#æ—¶åˆ»å‡†å¤‡æ¸²æŸ“" class="headerlink" title="æ—¶åˆ»å‡†å¤‡æ¸²æŸ“"></a>æ—¶åˆ»å‡†å¤‡æ¸²æŸ“</h3><p>React ç»„ä»¶ä½¿ä½ å†™æ¸²æŸ“ä»£ç çš„æ—¶å€™ä¸ç”¨è€ƒè™‘å¤ªå¤šå…³äºæ—¶é—´ã€‚ä½ è€ƒè™‘åœ¨ä»»æ„æ—¶é—´UIåº”è¯¥æ€ä¹ˆå±•ç¤ºï¼ŒReactæ¥å®ç°ä»–ã€‚åˆ©ç”¨å¥½è¿™ç§æ¨¡å¼ã€‚</p>
<p>ä¸è¦å°è¯•åœ¨ç»„ä»¶è¡Œä¸ºä¸­ï¼Œå‡è®¾ä¸å¿…è¦çš„çš„æ—¶åºä¿¡æ¯ã€‚<strong>ä½ çš„ç»„ä»¶åº”è¯¥åœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½é‡æ–°æ¸²æŸ“</strong></p>
<p>å¦‚ä½•è¿èƒŒè¿™ä¸ªåŸåˆ™å‘¢ï¼Ÿâ€”â€”ä½ å¯ä»¥ä½¿ç”¨ <code>componentWillReceiveProps</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        value: <span class="string">""</span></span><br><span class="line">    &#125;</span><br><span class="line">    componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value: nextProps.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    handleChange = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            input value = &#123;</span></span><br><span class="line"><span class="xml">                this.state.value</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            onChange = &#123;</span></span><br><span class="line"><span class="xml">                this.handleChange</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;</span></span><br><span class="line"><span class="xml">        )</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠvalueå€¼ç§æœ‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶ä»propsæ¥æ”¶valueå€¼ï¼Œå½“æ¥æ”¶åˆ°æ–°propsï¼Œæˆ‘ä»¬é‡ç½®çŠ¶æ€ä¸­çš„value<br><strong>è¿™ç§æ¨¡å¼çš„é—®é¢˜æ˜¯ï¼Œä»–å®Œå…¨ä¾èµ–äºå¶ç„¶çš„æ—¶é—´</strong><br>ä¹Ÿè®¸ä»Šå¤©çˆ¶ç»„ä»¶æå°‘åœ°æ›´æ–°ï¼Œæˆ‘ä»¬çš„TextInputç»„ä»¶åªæœ‰åœ¨é‡è¦äº‹ä»¶å‘ç”Ÿæ—¶æ‰ä¼šæ¥æ”¶propsï¼Œä¾‹å¦‚ä¿å­˜è¡¨å•<br>ä½†æ˜¯æ˜å¤©ï¼Œä½ å¯èƒ½ä¼šç»™çˆ¶ç»„ä»¶åŠ ä¸€äº›åŠ¨ç”»ï¼Œå¦‚æœçˆ¶ç»„ä»¶ç»å¸¸re-renderï¼Œå®ƒå°†æ±¡æŸ“å­ç»„ä»¶çš„çŠ¶æ€ã€‚<a href="https://reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html" target="_blank" rel="noopener">ä½ å¯èƒ½ä¸éœ€è¦æ´¾ç”Ÿstate</a></p>
<p><strong>æˆ‘ä»¬è¯¥æ€ä¹ˆä¿®å¤å‘¢ï¼Ÿ</strong><br>æˆ‘ä»¬éœ€è¦åœæ­¢å°† â€œæ¥æ”¶propsâ€ å’Œ â€œrenderingâ€çœ‹æˆä¸åŒçš„ä¸œè¥¿ã€‚ç”±çˆ¶ç»„ä»¶å¼•èµ·çš„re-render ä¸åº”ä¸ æœ¬èº«çŠ¶æ€ æ”¹å˜å¼•èµ·çš„ re-renderã€‚<strong>ç»„ä»¶åº”è¯¥æ˜¯æœ‰å¼¹æ€§çš„ï¼Œèƒ½é€‚åº”æ›´å°‘æˆ–è€…æ›´é¢‘ç¹çš„æ¸²æŸ“ï¼Œå¦åˆ™ä»–ä»¬ä¼šä¸ç‰¹å®šçˆ¶ç»„ä»¶å­˜åœ¨è¿‡å¤šè€¦åˆ</strong></p>
<p>ä»propsæ´¾ç”Ÿstateçš„å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œ</p>
<ul>
<li>1ã€é€šå¸¸ä½ è¯¥ä½¿ç”¨ä¸€ä¸ªå®Œå…¨å—æ§åˆ¶çš„ç»„ä»¶</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TextInput</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    value,</span></span></span><br><span class="line"><span class="function"><span class="params">    onChange</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        input value = &#123;</span></span><br><span class="line"><span class="xml">            value</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        onChange = &#123;</span></span><br><span class="line"><span class="xml">            onChange</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        /&gt;</span></span><br><span class="line"><span class="xml">    )</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>2ã€æˆ–è€…ä½¿ç”¨ä¸€ä¸ªä¸å—æ§åˆ¶çš„ç»„ä»¶ï¼ŒåŠ ä¸Škeyæ¥é‡ç½®ä»–</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TextInput</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [value, setValue] = useState(<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        input value = &#123;</span></span><br><span class="line"><span class="xml">            value</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        onChange = &#123;</span></span><br><span class="line"><span class="xml">            e =&gt; setValue(e.target.value)</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        /&gt;</span></span><br><span class="line"><span class="xml">    )</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">// é€šè¿‡æ”¹å˜keyé‡ç½®ç»„ä»¶</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">TextInput key = &#123;</span></span><br><span class="line"><span class="xml">    formId</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ¬èŠ‚çš„å†…å®¹æ˜¯ï¼Œç»„ä»¶ä¸åº”è¯¥å› ä¸ºä»–æœ¬èº«æˆ–è€…ä»–çˆ¶ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè€Œåæ‰ã€‚</p>
<p>è¦å¯¹ä½ çš„ç»„ä»¶è¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œå¯ä»¥å°†ä¸‹é¢ä»£ç åŠ å…¥åˆ°çˆ¶ç»„ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">componentDidMount() &#123;</span><br><span class="line">    setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.forceUpdate(), <span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½ çœ‹ä½ ä¼šæƒ³ï¼šæˆ‘åœ¨propsæ”¹å˜æ—¶é‡ç½®stateï¼Œå†ç”¨pureComponenté¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“<br>è¿™æ®µä»£ç åº”è¯¥èƒ½å·¥ä½œï¼Œå¯¹å§ï¼Ÿ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        value: <span class="string">""</span></span><br><span class="line">    &#125;</span><br><span class="line">    componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value: nextProps.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            value: e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            input value = &#123;</span></span><br><span class="line"><span class="xml">                this.state.value</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            onChange = &#123;</span></span><br><span class="line"><span class="xml">                this.handleChange</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            /&gt;</span></span><br><span class="line"><span class="xml">        )</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä¹ä¸€çœ‹ï¼Œä»–çœ‹èµ·æ¥è§£å†³äº† å½“ çˆ¶ç»„ä»¶ é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œå­ç»„ä»¶çŠ¶æ€å—æ±¡æŸ“çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå½“propsä¸€è‡´ï¼Œæˆ‘ä»¬å°±è·³è¿‡äº†æ›´æ–°ã€‚componentWillReceivePropsä¹Ÿä¸ä¼šè¢«æ‰§è¡Œã€‚<br>ç„¶è€Œï¼Œ<strong>å½“å®é™…propsæ”¹å˜çš„æ—¶å€™ï¼Œç»„ä»¶ä»ç„¶æ²¡æœ‰å¼¹æ€§</strong>ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åŠ å¦ä¸€ç»å¸¸æ”¹å˜çš„propsï¼šstyleï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šä¸¢å¤±å†…éƒ¨çŠ¶æ€ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt; TextInput</span><br><span class="line">style = &#123;</span><br><span class="line">    &#123;</span><br><span class="line">        opacity: someValueFromState</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">value = &#123;</span><br><span class="line">    value</span><br><span class="line">&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>coding</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡½æ•°å¼ç¼–ç¨‹</title>
    <url>/2019/12/28/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
    <content><![CDATA[<p><a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/" target="_blank" rel="noopener">å‚è€ƒæ–‡çŒ®ï¼šJSå‡½æ•°å¼ç¼–ç¨‹æŒ‡å—</a></p>
<a id="more"></a>

<h2 id="chapter-4-æŸ¯é‡ŒåŒ–"><a href="#chapter-4-æŸ¯é‡ŒåŒ–" class="headerlink" title="chapter 4 æŸ¯é‡ŒåŒ–"></a>chapter 4 æŸ¯é‡ŒåŒ–</h2><h3 id="é«˜é˜¶å‡½æ•°ï¼šå°†å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ã€‚"><a href="#é«˜é˜¶å‡½æ•°ï¼šå°†å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ã€‚" class="headerlink" title="é«˜é˜¶å‡½æ•°ï¼šå°†å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ã€‚"></a>é«˜é˜¶å‡½æ•°ï¼šå°†å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°ã€‚</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x + y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> add = <span class="function"><span class="params">a</span> =&gt;</span> <span class="function"><span class="params">b</span> =&gt;</span> a + b</span><br></pre></td></tr></table></figure>

<h2 id="chapter-5"><a href="#chapter-5" class="headerlink" title="chapter 5"></a>chapter 5</h2><h3 id="ä»£ç ç»„åˆ"><a href="#ä»£ç ç»„åˆ" class="headerlink" title="ä»£ç ç»„åˆ"></a>ä»£ç ç»„åˆ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f(g(x))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»„åˆ"><a href="#ç»„åˆ" class="headerlink" title="ç»„åˆ"></a>ç»„åˆ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> toUpperCase = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.toUpperCase()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> exclaim = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + <span class="string">'!'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å·¦å€¾-å‡½æ•°ï¼Œå‡½æ•°ä»å³å‘å·¦æ‰§è¡Œã€‚"><a href="#å·¦å€¾-å‡½æ•°ï¼Œå‡½æ•°ä»å³å‘å·¦æ‰§è¡Œã€‚" class="headerlink" title="å·¦å€¾ å‡½æ•°ï¼Œå‡½æ•°ä»å³å‘å·¦æ‰§è¡Œã€‚"></a>å·¦å€¾ å‡½æ•°ï¼Œå‡½æ•°ä»å³å‘å·¦æ‰§è¡Œã€‚</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f(g(x))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> head = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> reverse = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x.reduce(<span class="function">(<span class="params">arr, item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> [item].concat(arr)</span><br><span class="line">  &#125;, [])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> last = compose(head, reverse)</span><br><span class="line"></span><br><span class="line">last([<span class="string">'jumpkick'</span>, <span class="string">'roundhouse'</span>, <span class="string">'uppercut'</span>])</span><br></pre></td></tr></table></figure>

<h3 id="ç»“åˆå¾‹"><a href="#ç»“åˆå¾‹" class="headerlink" title="ç»“åˆå¾‹"></a>ç»“åˆå¾‹</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> associative = compose(f, compose(g, h)) == compose(compose(f, g), h);</span><br></pre></td></tr></table></figure>

<h3 id="pointfree-æ°¸è¿œä¸å¿…è¯´å‡ºä½ çš„æ•°æ®"><a href="#pointfree-æ°¸è¿œä¸å¿…è¯´å‡ºä½ çš„æ•°æ®" class="headerlink" title="pointfree(æ°¸è¿œä¸å¿…è¯´å‡ºä½ çš„æ•°æ®)"></a>pointfree(æ°¸è¿œä¸å¿…è¯´å‡ºä½ çš„æ•°æ®)</h3><h3 id="épointfree"><a href="#épointfree" class="headerlink" title="épointfree"></a>épointfree</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f(g(x))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> toUpperCase = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x.toUpperCase()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> head = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> initials = <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> name.split(<span class="string">' '</span>).join(<span class="string">'. '</span>)</span><br><span class="line">&#125;</span><br><span class="line">initials(<span class="string">"hunter stockton thompson"</span>);</span><br></pre></td></tr></table></figure>

<h3 id="pointfree"><a href="#pointfree" class="headerlink" title="pointfree"></a>pointfree</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="function"><span class="keyword">function</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f(g(x))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> split = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x.split(<span class="string">' '</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> join = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x.join(<span class="string">'. '</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> initials = compose(join, split)</span><br><span class="line">initials(<span class="string">"hunter stockton thompson"</span>);</span><br></pre></td></tr></table></figure>

<h2 id="chapter-6"><a href="#chapter-6" class="headerlink" title="chapter 6"></a>chapter 6</h2><h3 id="å£°æ˜å¼ä»£ç "><a href="#å£°æ˜å¼ä»£ç " class="headerlink" title="å£°æ˜å¼ä»£ç "></a>å£°æ˜å¼ä»£ç </h3><h3 id="å‘½ä»¤å¼ï¼šå‘½ä»¤å¼çš„å¾ªç¯è¦æ±‚ä½ å¿…é¡»å…ˆå®ä¾‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸”æ‰§è¡Œå®Œè¿™ä¸ªå®ä¾‹åŒ–è¯­å¥ä¹‹åï¼Œè§£é‡Šå™¨æ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç "><a href="#å‘½ä»¤å¼ï¼šå‘½ä»¤å¼çš„å¾ªç¯è¦æ±‚ä½ å¿…é¡»å…ˆå®ä¾‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸”æ‰§è¡Œå®Œè¿™ä¸ªå®ä¾‹åŒ–è¯­å¥ä¹‹åï¼Œè§£é‡Šå™¨æ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç " class="headerlink" title="å‘½ä»¤å¼ï¼šå‘½ä»¤å¼çš„å¾ªç¯è¦æ±‚ä½ å¿…é¡»å…ˆå®ä¾‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸”æ‰§è¡Œå®Œè¿™ä¸ªå®ä¾‹åŒ–è¯­å¥ä¹‹åï¼Œè§£é‡Šå™¨æ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç "></a>å‘½ä»¤å¼ï¼šå‘½ä»¤å¼çš„å¾ªç¯è¦æ±‚ä½ å¿…é¡»å…ˆå®ä¾‹åŒ–ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸”æ‰§è¡Œå®Œè¿™ä¸ªå®ä¾‹åŒ–è¯­å¥ä¹‹åï¼Œè§£é‡Šå™¨æ‰ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‘½ä»¤å¼</span></span><br><span class="line"><span class="keyword">var</span> authenticate = <span class="function"><span class="keyword">function</span>(<span class="params">form</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> user = toUser(form)</span><br><span class="line">    <span class="keyword">return</span> logIn(user)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å£°æ˜å¼</span></span><br><span class="line"><span class="keyword">var</span> authenticate = compose(logIn, toUser)</span><br></pre></td></tr></table></figure>

<h2 id="chapter-7-Hindley-Milner-ç±»å‹ç­¾å"><a href="#chapter-7-Hindley-Milner-ç±»å‹ç­¾å" class="headerlink" title="chapter 7 Hindley-Milner ç±»å‹ç­¾å"></a>chapter 7 Hindley-Milner ç±»å‹ç­¾å</h2><h2 id="chapter-8-ç‰¹ç™¾æƒ "><a href="#chapter-8-ç‰¹ç™¾æƒ " class="headerlink" title="chapter 8 ç‰¹ç™¾æƒ "></a>chapter 8 ç‰¹ç™¾æƒ </h2><h3 id="ç»™å®¹å™¨ä¸€ä¸ªå±æ€§"><a href="#ç»™å®¹å™¨ä¸€ä¸ªå±æ€§" class="headerlink" title="ç»™å®¹å™¨ä¸€ä¸ªå±æ€§"></a>ç»™å®¹å™¨ä¸€ä¸ªå±æ€§</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Container = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.__value = x</span><br><span class="line">&#125;</span><br><span class="line">Container.of = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Container(x)</span><br><span class="line">&#125;</span><br><span class="line">Container.of(<span class="number">3</span>)</span><br><span class="line">Container.of(<span class="string">"hotdogs"</span>)</span><br><span class="line">Container.of(Container.of(&#123;</span><br><span class="line">    name: <span class="string">"yoda"</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>

<h3 id="functor-æä¾›ä¸€ä¸ªæ–¹æ³•è®©åˆ«çš„å‡½æ•°æ“ä½œå®¹å™¨ä¸­çš„å€¼"><a href="#functor-æä¾›ä¸€ä¸ªæ–¹æ³•è®©åˆ«çš„å‡½æ•°æ“ä½œå®¹å™¨ä¸­çš„å€¼" class="headerlink" title="functor : æä¾›ä¸€ä¸ªæ–¹æ³•è®©åˆ«çš„å‡½æ•°æ“ä½œå®¹å™¨ä¸­çš„å€¼"></a>functor : æä¾›ä¸€ä¸ªæ–¹æ³•è®©åˆ«çš„å‡½æ•°æ“ä½œå®¹å™¨ä¸­çš„å€¼</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Container.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Container.of(f(<span class="keyword">this</span>.__value))</span><br><span class="line">&#125;</span><br><span class="line">Container.of(<span class="number">2</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">two</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> two + <span class="number">2</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Maybe = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.__value = x</span><br><span class="line">&#125;</span><br><span class="line">Maybe.of = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Maybe(x)</span><br><span class="line">&#125;</span><br><span class="line">Maybe.prototype.isNothing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.__value === <span class="literal">null</span> || <span class="keyword">this</span>.__value === <span class="literal">undefined</span>)</span><br><span class="line">&#125;</span><br><span class="line">Maybe.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.isNothing() ? Maybe.of(<span class="literal">null</span>) : Maybe.of(f(<span class="keyword">this</span>.__value))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="match-æ–¹æ³•å®ç°"><a href="#match-æ–¹æ³•å®ç°" class="headerlink" title="match æ–¹æ³•å®ç°"></a>match æ–¹æ³•å®ç°</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Maybe = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.__value = x</span><br><span class="line">&#125;</span><br><span class="line">Maybe.of = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Maybe(x)</span><br><span class="line">&#125;</span><br><span class="line">Maybe.prototype.isNothing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>.__value === <span class="literal">null</span> || <span class="keyword">this</span>.__value === <span class="literal">undefined</span>)</span><br><span class="line">&#125;</span><br><span class="line">Maybe.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.isNothing() ? Maybe.of(<span class="literal">null</span>) : Maybe.of(f(<span class="keyword">this</span>.__value))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> matchReg = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.__value.match(x)</span><br><span class="line">&#125;</span><br><span class="line">Maybe.of(<span class="string">"Malkovich Malkovich"</span>).map(matchReg(<span class="regexp">/a/ig</span>))</span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Left = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.__value = x</span><br><span class="line">&#125;</span><br><span class="line">Left.of = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Left()</span><br><span class="line">&#125;</span><br><span class="line">Left.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> Right = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.__value = x</span><br><span class="line">&#125;</span><br><span class="line">Right.of = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Right(x)</span><br><span class="line">&#125;</span><br><span class="line">Right.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Right.of(f(<span class="keyword">this</span>.__value))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Right.of(<span class="string">"rain"</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"b"</span> + str;</span><br><span class="line">&#125;);</span><br><span class="line">Right.of(&#123;</span><br><span class="line">    host: <span class="string">'localhost'</span>,</span><br><span class="line">    port: <span class="number">80</span></span><br><span class="line">&#125;).map(<span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.host</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶æœ‰ä½•ä¸åŒï¼Ÿ</title>
    <url>/2020/02/10/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%84%E4%BB%B6%E5%92%8C%E7%B1%BB%E7%BB%84%E4%BB%B6%E6%9C%89%E4%BD%95%E4%B8%8D%E5%90%8C%EF%BC%9F/</url>
    <content><![CDATA[<h3 id="æ ¹æœ¬çš„åŒºåˆ«"><a href="#æ ¹æœ¬çš„åŒºåˆ«" class="headerlink" title="æ ¹æœ¬çš„åŒºåˆ«"></a>æ ¹æœ¬çš„åŒºåˆ«</h3><p>å‡½æ•°å¼ç»„ä»¶æ•è·äº†æ¸²æŸ“æ‰€ç”¨çš„å€¼ã€‚ï¼ˆFunction components capture the rendered values.ï¼‰</p>
<a id="more"></a>
<p><a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="noopener">ä»£ç è§codesandbox</a><br>å‡½æ•°å¼ç»„ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ProfilePage</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="string">'Followed '</span> + props.user);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;button onClick=&#123;handleClick&#125;&gt;Follow&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ç±»ç»„ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="string">'Followed '</span> + <span class="keyword">this</span>.props.user);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="keyword">this</span>.showMessage, <span class="number">3000</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Follow<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ React ä¸­ Props æ˜¯ä¸å¯å˜(immutable)çš„ï¼Œæ‰€ä»¥ä»–ä»¬æ°¸è¿œä¸ä¼šæ”¹å˜ã€‚ç„¶è€Œï¼Œthisæ˜¯ï¼Œè€Œä¸”æ°¸è¿œæ˜¯ï¼Œå¯å˜(mutable)çš„ã€‚äº‹å®ä¸Šï¼Œè¿™å°±æ˜¯ç±»ç»„ä»¶ this å­˜åœ¨çš„æ„ä¹‰ã€‚Reactæœ¬èº«ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ï¼Œä»¥ä¾¿ä½ å¯ä»¥åœ¨æ¸²æŸ“æ–¹æ³•ä»¥åŠç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å¾—åˆ°æœ€æ–°çš„å®ä¾‹ã€‚</p>
<p>ä¿®å¤ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  showMessage = <span class="function">(<span class="params">user</span>) =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="string">'Followed '</span> + user);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;user&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.showMessage(user), <span class="number">3000</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>Follow<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨é—­åŒ…ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfilePage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// Capture the props!</span></span><br><span class="line">    <span class="keyword">const</span> props = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Note: we are *inside render*.</span></span><br><span class="line">    <span class="comment">// These aren't class methods.</span></span><br><span class="line">    <span class="keyword">const</span> showMessage = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      alert(<span class="string">'Followed '</span> + props.user);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      setTimeout(showMessage, <span class="number">3000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>Follow<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
  </entry>
  <entry>
    <title>ä»é›¶å®ç°reactå…¨å®¶æ¡¶</title>
    <url>/2020/01/17/%E4%BB%8E%E9%9B%B6%E5%AE%9E%E7%8E%B0react%E5%85%A8%E5%AE%B6%E6%A1%B6/</url>
    <content><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><blockquote>
<p><a href="https://github.com/brickspert/blog/issues/1" target="_blank" rel="noopener">å‚è€ƒæ•™ç¨‹</a>ï¼Œæœ¬æ–‡åœ¨ä¼ ç»Ÿreactå…¨å®¶æ¡¶æ¶æ„åŸºç¡€ä¸Šï¼Œå¯¹react-imvcè§£æ</p>
</blockquote>
<h3 id="å¸¦ç€é—®é¢˜å»å­¦ä¹ "><a href="#å¸¦ç€é—®é¢˜å»å­¦ä¹ " class="headerlink" title="å¸¦ç€é—®é¢˜å»å­¦ä¹ "></a>å¸¦ç€é—®é¢˜å»å­¦ä¹ </h3><ul>
<li>react-imvcä¸­æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬vendor.jsã€index.js æ˜¯æœ‰å“ªäº›å†…å®¹æ‰“åŒ…ç”Ÿæˆçš„</li>
<li>é¡¹ç›®ä¸­ç”Ÿæˆçš„æ‰“åŒ…å†…å®¹ <code>js/number.[hash].js</code> ï¼Œå¯ä»¥ä¿®æ”¹å‘½åå—ï¼Ÿ</li>
</ul>
<a id="more"></a>

<h3 id="init-é¡¹ç›®"><a href="#init-é¡¹ç›®" class="headerlink" title="init é¡¹ç›®"></a>init é¡¹ç›®</h3><ol>
<li><code>mkdir react-init &amp; cd react-init</code> </li>
<li><code>npm init</code> </li>
<li><code>touch webpack.dev.config.js</code> ç¼–å†™åŸºç¡€é…ç½®æ–‡ä»¶</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'src/index.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'app'</span>).innerHTML = <span class="string">"This is index.html"</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰“åŒ…ç”Ÿæˆçš„ <code>bundle.js</code> æ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ–°å»ºindex.htmlï¼Œå°†bundle.js æ’å…¥HTMLä¸­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt; !doctype html &gt;</span><br><span class="line">    &lt;</span><br><span class="line">    html lang = <span class="string">"en"</span> &gt;</span><br><span class="line">    &lt;</span><br><span class="line">    head &gt;</span><br><span class="line">    &lt;</span><br><span class="line">    meta charset = <span class="string">"UTF-8"</span> &gt;</span><br><span class="line">    &lt;</span><br><span class="line">    title &gt; Document &lt; <span class="regexp">/title&gt; &lt;</span></span><br><span class="line"><span class="regexp">    /</span>head&gt; <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    body &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    div id = "app" &gt; <span class="tag">&lt; /<span class="attr">div</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    script type = "text/javascript"</span></span><br><span class="line"><span class="xml">src = "./bundle.js"</span></span><br><span class="line"><span class="xml">charset = "utf-8" &gt; <span class="tag">&lt; /<span class="attr">script</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /body&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /html&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œ webpack â€“config webpack.dev.config.js ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶ï¼Œæ‰“å¼€index.html æŸ¥çœ‹é¡µé¢</p>
<h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><blockquote>
<p>ä½¿ç”¨babelå¯¹JSXï¼ŒES6ï¼ŒES7è¿›è¡Œç¼–è¯‘ï¼Œè½¬æ¢æˆES5</p>
</blockquote>
<ul>
<li>babel-core è°ƒç”¨Babelçš„APIè¿›è¡Œè½¬ç </li>
<li>babel-loader</li>
<li>babel-preset-es2015 ç”¨äºè§£æ ES6</li>
<li>babel-preset-react ç”¨äºè§£æ JSX</li>
<li>babel-preset-stage-0 ç”¨äºè§£æ ES7 ææ¡ˆ</li>
</ul>
<p><code>npm install --save-dev babel-core babel-loader babel-preset-es2015 babel-preset-react babel-preset-stage-0</code> </p>
<p>é…ç½®.babelrcæ–‡ä»¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        <span class="string">"es2015"</span>,</span><br><span class="line">        <span class="string">"react"</span>,</span><br><span class="line">        <span class="string">"stage-0"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"plugins"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹webpack.dev.config.jsï¼Œå¢åŠ babel-loaderï¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*cacheDirectoryæ˜¯ç”¨æ¥ç¼“å­˜ç¼–è¯‘ç»“æœï¼Œä¸‹æ¬¡ç¼–è¯‘åŠ é€Ÿ*/</span></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'babel-loader?cacheDirectory=true'</span>],</span><br><span class="line">        include: path.join(__dirname, <span class="string">'src'</span>)</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="react"><a href="#react" class="headerlink" title="react"></a>react</h3><p><code>cnpm install react react-dom</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  src/index.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'./Hello/Hello.js'</span></span><br><span class="line"></span><br><span class="line">ReactDom.render( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        div &gt; <span class="tag">&lt; <span class="attr">Hello</span> / &gt;</span> <span class="tag">&lt; /<span class="attr">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br></pre></td></tr></table></figure>

<h3 id="react-router"><a href="#react-router" class="headerlink" title="react-router"></a>react-router</h3><p><code>cnpm install --save react-router-dom</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    BrowserRouter <span class="keyword">as</span> Router,</span><br><span class="line">    Route,</span><br><span class="line">    Switch,</span><br><span class="line">    Link</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'../pages/Home/Home'</span>;</span><br><span class="line"><span class="keyword">import</span> Page1 <span class="keyword">from</span> <span class="string">'../pages/Page1/Page1'</span>;</span><br><span class="line"><span class="keyword">const</span> getRouter = <span class="function"><span class="params">()</span> =&gt;</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Router &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    div &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    ul &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    li &gt; <span class="tag">&lt; <span class="attr">Link</span> <span class="attr">to</span> = <span class="string">"/"</span> &gt;</span> é¦–é¡µ <span class="tag">&lt; /<span class="attr">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span> &gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    li &gt; <span class="tag">&lt; <span class="attr">Link</span> <span class="attr">to</span> = <span class="string">"/page1"</span> &gt;</span> Page1 <span class="tag">&lt; /<span class="attr">Link</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">li</span> &gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /ul&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Switch &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Route exact path = "/"</span></span><br><span class="line"><span class="xml">    component = &#123;</span></span><br><span class="line"><span class="xml">        Home</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    /&gt; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Route path = "/page1"</span></span><br><span class="line"><span class="xml">    component = &#123;</span></span><br><span class="line"><span class="xml">        Page1</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    /&gt; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /Switch&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /div&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /Router&gt;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> getRouter;</span><br></pre></td></tr></table></figure>

<h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h3><blockquote>
<p>é…ç½®æœåŠ¡å™¨</p>
</blockquote>
<p><code>npm install webpack-dev-server@2 --save-dev</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.config.js</span></span><br><span class="line">devServer: &#123;</span><br><span class="line">    contentBase: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">    historyApiFallback: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>contentBase : URLçš„æ ¹ç›®å½•ã€‚å¦‚æœä¸è®¾å®šçš„è¯ï¼Œé»˜è®¤æŒ‡å‘é¡¹ç›®æ ¹ç›®å½•ã€‚<br>historyApiFallback : è®©æ‰€æœ‰çš„404å®šä½åˆ°index.html<br>progress : å°†ç¼–è¯‘è¿›åº¦è¾“å‡ºåˆ°æ§åˆ¶å°</p>
</blockquote>
<p>æ‰§è¡Œ <code>webpack-dev-server --config webpack.dev.config.js</code><br>ç›®å‰ï¼šå½“æˆ‘ä»¬ä¿®æ”¹ä»£ç çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°</p>
<h3 id="çƒ­æ¨¡å—æ›¿æ¢"><a href="#çƒ­æ¨¡å—æ›¿æ¢" class="headerlink" title="çƒ­æ¨¡å—æ›¿æ¢"></a>çƒ­æ¨¡å—æ›¿æ¢</h3><blockquote>
<p>hot : å¯ç”¨Webpackçš„æ¨¡å—çƒ­æ›¿æ¢ç‰¹æ€§ã€‚</p>
</blockquote>
<p><code>webpack-dev-server --config webpack.dev.config.js --color --progress --hot</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js å¢åŠ </span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">    <span class="built_in">module</span>.hot.accept();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> æ•ˆæœï¼šä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹ï¼Œå†…å®¹æ›´æ–°</p>
<p> â€“hot æ•ˆæœå¯ä»¥ç”¨ä»¥ä¸‹é…ç½®æ¥æ›¿ä»£ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line">devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="redux"><a href="#redux" class="headerlink" title="redux"></a>redux</h3><p><a href="http://www.ruanyifeng.com/blog/2016/09/redux_tutorial_part_one_basic_usages.html" target="_blank" rel="noopener">å…¥é—¨æ•™ç¨‹</a><br><a href="http://cn.redux.js.org/index.html" target="_blank" rel="noopener">è¯¦ç»†æ•™ç¨‹</a><br>action / reducer /</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">increment</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        type: INCREMENT</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶actionå’Œæ—§çš„state, ç”Ÿæˆæ–°çš„state</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">reducer</span>(<span class="params">state = initState, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> INCREMENT:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                count: state.count + <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªé¡¹ç›®æœ‰å¾ˆå¤šçš„reducers, æˆ‘ä»¬è¦æŠŠä»–ä»¬æ•´åˆåˆ°ä¸€èµ·</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">combineReducers</span>(<span class="params">state = &#123;&#125;, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        counter: counter(state.counter, action)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºstore"><a href="#åˆ›å»ºstore" class="headerlink" title="åˆ›å»ºstore"></a>åˆ›å»ºstore</h4><p>store æœ‰ä»¥ä¸‹èŒè´£ï¼š</p>
<ul>
<li>ç»´æŒåº”ç”¨çš„ stateï¼›</li>
<li>æä¾› getState() æ–¹æ³•è·å– stateï¼›</li>
<li>æä¾› dispatch(action) è§¦å‘reducersæ–¹æ³•æ›´æ–° stateï¼›</li>
<li>é€šè¿‡ subscribe(listener) æ³¨å†Œç›‘å¬å™¨; </li>
<li>é€šè¿‡ subscribe(listener) è¿”å›çš„å‡½æ•°æ³¨é”€ç›‘å¬å™¨ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    createStore</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> combineReducers <span class="keyword">from</span> <span class="string">'./reducers.js'</span>;</span><br><span class="line"><span class="keyword">let</span> store = createStore(combineReducers);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p>ç”¨æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    increment</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'./actions/counter'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(store.getState());</span><br><span class="line"><span class="keyword">let</span> unsubscribe = store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(store.getState())</span><br><span class="line">);</span><br><span class="line">store.dispatch(increment());</span><br><span class="line">unsubscribe();</span><br></pre></td></tr></table></figure>

<p><a href="http://cn.redux.js.org/docs/basics/DataFlow.html" target="_blank" rel="noopener">reduxæ•°æ®æµ</a><br>react-reduxæä¾›äº†ä¸€ä¸ªæ–¹æ³•connect<br>connectæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªmapStateToProps, å°±æ˜¯æŠŠreduxçš„stateï¼Œè½¬ä¸ºç»„ä»¶çš„Propsï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°æ˜¯mapDispatchToprops, å°±æ˜¯æŠŠå‘å°„actionsçš„æ–¹æ³•ï¼Œè½¬ä¸ºPropså±æ€§å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    Component</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    increment,</span><br><span class="line">    decrement,</span><br><span class="line">    reset</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'actions/counter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    connect</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            div &gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            div &gt; å½“å‰è®¡æ•°ä¸º &#123;</span></span><br><span class="line"><span class="xml">                this.props.counter.count</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt; /<span class="attr">div</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button onClick = &#123;</span></span><br><span class="line"><span class="xml">                () =&gt; this.props.increment()</span></span><br><span class="line"><span class="xml">            &#125; &gt; è‡ªå¢ <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button onClick = &#123;</span></span><br><span class="line"><span class="xml">                () =&gt; this.props.decrement()</span></span><br><span class="line"><span class="xml">            &#125; &gt; è‡ªå‡ <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            button onClick = &#123;</span></span><br><span class="line"><span class="xml">                () =&gt; this.props.reset()</span></span><br><span class="line"><span class="xml">            &#125; &gt; é‡ç½® <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /button&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /div&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        counter: state.counter</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        increment: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            dispatch(increment())</span><br><span class="line">        &#125;,</span><br><span class="line">        decrement: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            dispatch(decrement())</span><br><span class="line">        &#125;,</span><br><span class="line">        reset: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            dispatch(reset())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(Counter);</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥store</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    Provider</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line">ReactDom.render( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    AppContainer &gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Provider store = &#123;</span></span><br><span class="line"><span class="xml">        store</span></span><br><span class="line"><span class="xml">    &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">        RootElement</span></span><br><span class="line"><span class="xml">    &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /Provider&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    /AppContainer&gt;</span>,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>Providerç»„ä»¶æ˜¯è®©æ‰€æœ‰çš„ç»„ä»¶å¯ä»¥è®¿é—®åˆ°storeã€‚ä¸ç”¨æ‰‹åŠ¨å»ä¼ ã€‚ä¹Ÿä¸ç”¨æ‰‹åŠ¨å»ç›‘å¬ã€‚</li>
<li>connectå‡½æ•°ä½œç”¨æ˜¯ä» Redux state æ ‘ä¸­è¯»å–éƒ¨åˆ†æ•°æ®ï¼Œå¹¶é€šè¿‡ props æ¥æŠŠè¿™äº›æ•°æ®æä¾›ç»™è¦æ¸²æŸ“çš„ç»„ä»¶ã€‚ä¹Ÿä¼ é€’dispatch(action)å‡½æ•°åˆ°propsã€‚</li>
</ul>
<p>â€¦â€¦ </p>
<h3 id="ç¼–è¯‘css"><a href="#ç¼–è¯‘css" class="headerlink" title="ç¼–è¯‘css"></a>ç¼–è¯‘css</h3><p>npm install css-loader style-loader â€“save-dev</p>
<ul>
<li>css-loaderä½¿ä½ èƒ½å¤Ÿä½¿ç”¨ç±»ä¼¼@import å’Œ url(â€¦ )çš„æ–¹æ³•å®ç° require()çš„åŠŸèƒ½ï¼›</li>
<li>style-loaderå°†æ‰€æœ‰çš„è®¡ç®—åçš„æ ·å¼åŠ å…¥é¡µé¢ä¸­</li>
<li>äºŒè€…ç»„åˆåœ¨ä¸€èµ·ä½¿ä½ èƒ½å¤ŸæŠŠæ ·å¼è¡¨åµŒå…¥webpackæ‰“åŒ…åçš„JSæ–‡ä»¶ä¸­ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–è¯‘å›¾ç‰‡"><a href="#ç¼–è¯‘å›¾ç‰‡" class="headerlink" title="ç¼–è¯‘å›¾ç‰‡"></a>ç¼–è¯‘å›¾ç‰‡</h3><p>npm install â€“save-dev url-loader file-loader</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// options limit 8192æ„æ€æ˜¯ï¼Œå°äºç­‰äº8Kçš„å›¾ç‰‡ä¼šè¢«è½¬æˆbase64ç¼–ç ï¼Œç›´æ¥æ’å…¥HTMLä¸­ï¼Œå‡å°‘HTTPè¯·æ±‚ã€‚</span></span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(png|jpg|gif)$/</span>,</span><br><span class="line">    use: [&#123;</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">            limit: <span class="number">8192</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‰éœ€åŠ è½½"><a href="#æŒ‰éœ€åŠ è½½" class="headerlink" title="æŒ‰éœ€åŠ è½½"></a>æŒ‰éœ€åŠ è½½</h3><p><code>npm install bundle-loader --save-dev</code> </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    Component</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bundle</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        mod: <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">        <span class="keyword">this</span>.load(<span class="keyword">this</span>.props)</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nextProps.load !== <span class="keyword">this</span>.props.load) &#123;</span><br><span class="line">            <span class="keyword">this</span>.load(nextProps)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    load(props) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            mod: <span class="literal">null</span></span><br><span class="line">        &#125;);</span><br><span class="line">        props.load(<span class="function">(<span class="params">mod</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                mod: mod.default ? mod.default : mod</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.props.children(<span class="keyword">this</span>.state.mod)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Bundle;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'bundle-loader?lazy&amp;name=home!pages/Home/Home'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Loading = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> &gt;</span> Loading... <span class="tag">&lt; /<span class="attr">div</span>&gt;</span></span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createComponent = <span class="function">(<span class="params">component</span>) =&gt;</span> <span class="function">(<span class="params">props</span>) =&gt;</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">    Bundle load = &#123;</span></span><br><span class="line"><span class="xml">        component</span></span><br><span class="line"><span class="xml">    &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">        (Component) =&gt; Component ? <span class="tag">&lt; <span class="attr">Component</span> &#123;</span></span></span><br><span class="line"><span class="xml">            ...props</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line">        /&gt; : &lt;Loading / &gt;</span><br><span class="line">    &#125; &lt;</span><br><span class="line"><span class="xml">    /Bundle&gt;</span></span><br><span class="line"><span class="xml">);</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">Route exact path = "/"</span></span><br><span class="line"><span class="xml">component = &#123;</span></span><br><span class="line"><span class="xml">    createComponent(Home)</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">/&gt;</span></span><br></pre></td></tr></table></figure>

<p>åŠ ä¸ªchunkFilenameã€‚chunkFilenameæ˜¯é™¤äº†entryå®šä¹‰çš„å…¥å£jsä¹‹å¤–çš„js</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">    filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">    chunkFilename: <span class="string">'[name].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].[chunkhash].js'</span>,</span><br><span class="line">    chunkFilename: <span class="string">'[name].[chunkhash].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æå–å…¬å…±ä»£ç "><a href="#æå–å…¬å…±ä»£ç " class="headerlink" title="æå–å…¬å…±ä»£ç "></a>æå–å…¬å…±ä»£ç </h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    app: [</span><br><span class="line">        <span class="string">'react-hot-loader/patch'</span>,</span><br><span class="line">        path.join(__dirname, <span class="string">'src/index.js'</span>)</span><br><span class="line">    ],</span><br><span class="line">    vendor: [<span class="string">'react'</span>, <span class="string">'react-router-dom'</span>, <span class="string">'redux'</span>, <span class="string">'react-dom'</span>, <span class="string">'react-redux'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*plugins*/</span></span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">    name: <span class="string">'vendor'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="æ–‡ä»¶å‹ç¼©"><a href="#æ–‡ä»¶å‹ç¼©" class="headerlink" title="æ–‡ä»¶å‹ç¼©"></a>æ–‡ä»¶å‹ç¼©</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyJSPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> UglifyJSPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‡å®šåå¢ƒ"><a href="#æŒ‡å®šåå¢ƒ" class="headerlink" title="æŒ‡å®šåå¢ƒ"></a>æŒ‡å®šåå¢ƒ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">            <span class="string">'process.env'</span>: &#123;</span><br><span class="line">                <span class="string">'NODE_ENV'</span>: <span class="built_in">JSON</span>.stringify(<span class="string">'production'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰“åŒ…ä¼˜åŒ–"><a href="#æ‰“åŒ…ä¼˜åŒ–" class="headerlink" title="æ‰“åŒ…ä¼˜åŒ–"></a>æ‰“åŒ…ä¼˜åŒ–</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin([<span class="string">'dist'</span>])</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="æŠ½å–css"><a href="#æŠ½å–css" class="headerlink" title="æŠ½å–css"></a>æŠ½å–css</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">            use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">                use: <span class="string">"css-loader"</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'[name].[contenthash:5].css'</span>,</span><br><span class="line">            allChunks: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-CSS-Modules"><a href="#ä½¿ç”¨-CSS-Modules" class="headerlink" title="ä½¿ç”¨ CSS Modules"></a>ä½¿ç”¨ CSS Modules</h3><p><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html" target="_blank" rel="noopener">æ•™ç¨‹</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.config.js</span></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [<span class="string">"style-loader"</span>, <span class="string">"css-loader?modules&amp;localIdentName=[local]-[hash:base64:5]"</span>, <span class="string">"postcss-loader"</span>]</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">            fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">            use: [<span class="string">"css-loader?modules&amp;localIdentName=[local]-[hash:base64:5]"</span>, <span class="string">"postcss-loader"</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„JS</title>
    <url>/2019/12/28/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS/</url>
    <content><![CDATA[<p>ä½ ä¸çŸ¥é“çš„JavaScriptåˆ†ä¸º ä¸Šã€ä¸­ã€ä¸‹ å·ï¼Œè€å¿ƒé˜…è¯»å“¦~</p>
<p><a href="https://kingyinliang.github.io/PDF/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89.pdf" target="_blank" rel="noopener">ä½ ä¸çŸ¥é“çš„JavaScript</a></p>
<a id="more"></a>

<h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><blockquote>
<p>æ‰€è°“ç¼–è¯‘ï¼šåˆ†è¯/è¯æ³•åˆ†æï¼Œ è§£æ/è¯­æ³•åˆ†æï¼Œ ä»£ç ç”Ÿæˆ</p>
</blockquote>
<p><strong>åˆ†è¯/è¯æ³•åˆ†æ</strong><br>å­—ç¬¦ä¸²åˆ†è§£ä¸ºæœ‰æ„ä¹‰çš„ä»£ç å—ï¼Œè¿™äº›ä»£ç å—è¢«åˆ†ä¸ºè¯æ³•å•å…ƒ<br><strong>è§£æ/è¯­æ³•åˆ†æ</strong><br>å°†è¯æ³•å•å…ƒæµè½¬æ¢æˆä¸€ä¸ªç”±å…ƒç´ é€çº§åµŒå¥—æ‰€ç»„æˆçš„ä»£è¡¨äº†ç¨‹åºè¯­æ³•ç»“æ„çš„æ ‘ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ASTï¼‰<br><strong>ä»£ç ç”Ÿæˆ</strong><br>å°†ASTè½¬æ¢æˆå¯æ‰§è¡Œçš„ä»£ç </p>
<h4 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°ä½œç”¨åŸŸ"></a>å‡½æ•°ä½œç”¨åŸŸ</h4><h4 id="å—ä½œç”¨åŸŸ"><a href="#å—ä½œç”¨åŸŸ" class="headerlink" title="å—ä½œç”¨åŸŸ"></a>å—ä½œç”¨åŸŸ</h4><h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bar</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> baz = foo()</span><br><span class="line">baz()</span><br></pre></td></tr></table></figure>

<p>  &nbsp; &nbsp; æ‹œbar()æ‰€å£°æ˜çš„ä½ç½®æ‰€èµï¼Œå®ƒåˆæœ‰æ¶µç›–foo()å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ï¼Œä½¿å¾—è¯¥ä½œç”¨åŸŸèƒ½å¤Ÿä¸€ç›´å­˜æ´»ï¼Œä»¥ä¾›bar()åœ¨ä¹‹åä»»ä½•æ—¶é—´è¿›è¡Œå¼•ç”¨<br>  &nbsp; &nbsp; bar()ä¾ç„¶æŒæœ‰å¯¹è¯¥ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨å°±å«é—­åŒ…<br>  &nbsp; &nbsp; è¿™ä¸ªå‡½æ•°åœ¨å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–çš„åœ°æ–¹è¢«è°ƒç”¨ã€‚é—­åŒ…ä½¿å¾—å‡½æ•°å¯ä»¥ç»§ç»­è®¿é—®å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wait</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(message)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">wait(<span class="string">"hello,closure!"</span>)</span><br></pre></td></tr></table></figure>

<p>&nbsp; &nbsp; wait æ‰§è¡Œ1000msåï¼Œå®ƒçš„å†…éƒ¨ä½œç”¨åŸŸä¸ä¼šæ¶ˆå¤±ï¼Œtimerå‡½æ•°ä¾ç„¶ä¿æœ‰waitä½œç”¨åŸŸçš„é—­åŒ…ã€‚setTimeoutæŒæœ‰å¯¹ä¸€ä¸ªå‚æ•°çš„å¼•ç”¨ã€‚è¿™ä¸ªå‚æ•°å«fnæˆ–è€…funcï¼Œæˆ–å…¶ä»–ã€‚å¼•æ“ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">btn.onClick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'btn clicked'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¦‚æœå°†å‡½æ•°ï¼ˆè®¿é—®å®ƒä»¬å„è‡ªçš„è¯æ³•ä½œç”¨åŸŸï¼‰å½“ä½œç¬¬ä¸€</span></span><br><span class="line"><span class="comment"> * çº§çš„å€¼ç±»å‹å¹¶åˆ°å¤„ä¼ é€’ï¼Œä½ å°±ä¼šçœ‹åˆ°é—­åŒ…åœ¨è¿™äº›å‡½æ•°ä¸­çš„åº”ç”¨ã€‚åœ¨å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ã€</span></span><br><span class="line"><span class="comment"> * Ajax è¯·æ±‚ã€è·¨çª—å£é€šä¿¡ã€Web Workers æˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥ï¼ˆæˆ–è€…åŒæ­¥ï¼‰ä»»åŠ¡ä¸­ï¼Œåªè¦ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…ï¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    id: <span class="string">"awesome"</span>,</span><br><span class="line">    cool: <span class="function"><span class="keyword">function</span> <span class="title">coolFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> id = <span class="string">"not awesome"</span>;</span><br><span class="line">obj.cool();</span><br><span class="line">setTimeout(obj.cool, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"foo: "</span> + num);</span><br><span class="line">    <span class="keyword">this</span>.count++;</span><br><span class="line">&#125;</span><br><span class="line">foo.count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">5</span>) &#123;</span><br><span class="line">        foo(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>éšå¼ç»‘å®š;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">something</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a, something);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.a + something;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">fn, obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fn.apply(obj, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> bar = bind(foo, obj);</span><br><span class="line"><span class="keyword">var</span> b = bar(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure>

<h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><h4 id="ç»‘å®šè§„åˆ™"><a href="#ç»‘å®šè§„åˆ™" class="headerlink" title="ç»‘å®šè§„åˆ™"></a>ç»‘å®šè§„åˆ™</h4><h5 id="é»˜è®¤ç»‘å®š"><a href="#é»˜è®¤ç»‘å®š" class="headerlink" title="é»˜è®¤ç»‘å®š"></a>é»˜è®¤ç»‘å®š</h5><blockquote>
<p>ç‹¬ç«‹å‡½æ•°è°ƒç”¨</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">2</span></span><br><span class="line">foo() <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<h5 id="éšå¼ç»‘å®š"><a href="#éšå¼ç»‘å®š" class="headerlink" title="éšå¼ç»‘å®š"></a>éšå¼ç»‘å®š</h5><blockquote>
<p>è°ƒç”¨ä½ç½®æ˜¯å¦åŒ…å«ä¸Šä¸‹æ–‡</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">    a: <span class="number">42</span>,</span><br><span class="line">    foo: foo</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    a: <span class="number">2</span>,</span><br><span class="line">    obj2: obj2</span><br><span class="line">&#125;</span><br><span class="line">obj1.obj2.foo() <span class="comment">// 42</span></span><br></pre></td></tr></table></figure>

<p><strong>éšå¼ä¸¢å¤±</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">2</span>,</span><br><span class="line">    foo: foo</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = obj.foo</span><br><span class="line"><span class="keyword">var</span> a = <span class="string">"oops, global"</span></span><br><span class="line">bar()</span><br></pre></td></tr></table></figure>

<h5 id="æ˜¾å¼ç»‘å®š"><a href="#æ˜¾å¼ç»‘å®š" class="headerlink" title="æ˜¾å¼ç»‘å®š"></a>æ˜¾å¼ç»‘å®š</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo.call(obj) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p><strong>ç¡¬ç»‘å®š</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">something</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a, something)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.a + something</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">fn, obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fn.apply(obj, <span class="built_in">arguments</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = bind(foo, obj)</span><br><span class="line"><span class="keyword">var</span> b = bar(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">console</span>.log(b) <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<p><strong>APIè°ƒç”¨çš„â€œä¸Šä¸‹æ–‡â€</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(el, <span class="keyword">this</span>.id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    id: <span class="string">"awesome"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].forEach(foo, obj);</span><br></pre></td></tr></table></figure>

<h5 id="newç»‘å®š"><a href="#newç»‘å®š" class="headerlink" title="newç»‘å®š"></a>newç»‘å®š</h5><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.a = a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="keyword">new</span> foo(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">console</span>.log(bar.a)</span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜å…ˆçº§</strong></p>
<blockquote>
<p>æ˜¾ç¤ºç»‘å®š &gt; new ç»‘å®š &gt; éšå¼ç»‘å®š &gt; é»˜è®¤ç»‘å®š</p>
</blockquote>
<h5 id="è¢«å¿½ç•¥çš„this"><a href="#è¢«å¿½ç•¥çš„this" class="headerlink" title="è¢«å¿½ç•¥çš„this"></a>è¢«å¿½ç•¥çš„this</h5><p>&nbsp; &nbsp; å¦‚æœæŠŠnullæˆ–è€…undefinedä½œä¸ºthisçš„ç»‘å®šå¯¹è±¡ä¼ å…¥callï¼Œapplyæˆ–è€…bindï¼Œè¿™äº›å€¼åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®é™…åº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ã€‚ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'a:'</span> + a + <span class="string">'b: '</span> + b)</span><br><span class="line">&#125;</span><br><span class="line">foo.apply(<span class="literal">null</span>, [<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="keyword">var</span> bar = foo.bind(<span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">bar(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h5 id="è½¯ç»‘å®š"><a href="#è½¯ç»‘å®š" class="headerlink" title="è½¯ç»‘å®š"></a>è½¯ç»‘å®š</h5><h5 id="thisè¯æ³•"><a href="#thisè¯æ³•" class="headerlink" title="thisè¯æ³•"></a>thisè¯æ³•</h5><p>ç®­å¤´å‡½æ•°æ ¹æ®å¤–å±‚ä½œç”¨åŸŸæ¥å†³å®šthis</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">    a: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = foo.call(obj1)</span><br><span class="line">bar.call(obj2) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>


<h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p>ğŸ‘‡ æŠ¥é”™</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> deck = &#123;</span><br><span class="line">  suits: [<span class="string">"hearts"</span>, <span class="string">"spades"</span>, <span class="string">"clubs"</span>, <span class="string">"diamonds"</span>],</span><br><span class="line">  cards: <span class="built_in">Array</span>(<span class="number">52</span>),</span><br><span class="line">  createCardPicker: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> pickedCard = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">52</span>);</span><br><span class="line">      <span class="keyword">let</span> pickedSuit = <span class="built_in">Math</span>.floor(pickedCard / <span class="number">13</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">suit</span>: <span class="keyword">this</span>.suits[pickedSuit], <span class="attr">card</span>: pickedCard % <span class="number">13</span> &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cardPicker = deck.createCardPicker();</span><br><span class="line"><span class="keyword">let</span> pickedCard = cardPicker();</span><br></pre></td></tr></table></figure>



<p>ğŸ‘‡ èƒ½æ­£å¸¸è®¿é—®suits</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> deck = &#123;</span><br><span class="line">  suits: [<span class="string">"hearts"</span>, <span class="string">"spades"</span>, <span class="string">"clubs"</span>, <span class="string">"diamonds"</span>],</span><br><span class="line">  cards: <span class="built_in">Array</span>(<span class="number">52</span>),</span><br><span class="line">  createCardPicker: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> pickedCard = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">52</span>);</span><br><span class="line">      <span class="keyword">let</span> pickedSuit = <span class="built_in">Math</span>.floor(pickedCard / <span class="number">13</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">suit</span>: <span class="keyword">this</span>.suits[pickedSuit], <span class="attr">card</span>: pickedCard % <span class="number">13</span> &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cardPicker = deck.createCardPicker();</span><br><span class="line"><span class="keyword">let</span> pickedCard = cardPicker();</span><br></pre></td></tr></table></figure>

<p>setIntervalä¸­çš„thisæŒ‡å‘å…¨å±€</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Person() æ„é€ å‡½æ•°å®šä¹‰ `this`ä½œä¸ºå®ƒè‡ªå·±çš„å®ä¾‹.</span></span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  setInterval(<span class="function"><span class="keyword">function</span> <span class="title">growUp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨éä¸¥æ ¼æ¨¡å¼, growUp()å‡½æ•°å®šä¹‰ `this`ä½œä¸ºå…¨å±€å¯¹è±¡, </span></span><br><span class="line">    <span class="comment">// ä¸åœ¨ Person()æ„é€ å‡½æ•°ä¸­å®šä¹‰çš„ `this`å¹¶ä¸ç›¸åŒ.</span></span><br><span class="line">    <span class="keyword">this</span>.age++;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">  that.age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  setInterval(<span class="function"><span class="keyword">function</span> <span class="title">growUp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  å›è°ƒå¼•ç”¨çš„æ˜¯`that`å˜é‡, å…¶å€¼æ˜¯é¢„æœŸçš„å¯¹è±¡. </span></span><br><span class="line">    that.age++;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.age++; <span class="comment">// |this| æ­£ç¡®åœ°æŒ‡å‘ p å®ä¾‹</span></span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br></pre></td></tr></table></figure>

<p>ç®­å¤´å‡½æ•°æ˜¯å¦‚ä½•ä¿å­˜å¼•ç”¨çš„ï¼Ÿ ğŸ¤”</p>
]]></content>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>reactæ¸²æŸ“æœºåˆ¶ï¼šçˆ¶ç»„ä»¶æ¸²æŸ“å¿…ç„¶å¯¼è‡´å­ç»„ä»¶æ¸²æŸ“ï¼Ÿ</title>
    <url>/2020/02/10/react%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6%EF%BC%9A%E7%88%B6%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%E5%BF%85%E7%84%B6%E5%AF%BC%E8%87%B4%E5%AD%90%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%EF%BC%9F/</url>
    <content><![CDATA[<p>åœ¨é¡¹ç›®ä¸­ï¼Œç”±äºçˆ¶ç»„ä»¶çš„æ–¹æ³•ä¼šç›‘å¬çˆ¶ç»„ä»¶ç¦»é¡µé¢é¡¶éƒ¨çš„é«˜åº¦ï¼Œæ‰€ä»¥æ»šåŠ¨è¿‡ç¨‹ä¸­ï¼Œçˆ¶ç»„ä»¶ä¸€ç›´ä¼šé‡æ–°æ¸²æŸ“<br>å¦‚é¢˜ï¼šçˆ¶ç»„ä»¶ re-render ä¸€å®šä¼šå¯¼è‡´å­ç»„ä»¶ re-render å—ï¼Ÿ</p>
<a id="more"></a>

<p>ä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å­ç»„ä»¶å—åˆ°çˆ¶ç»„ä»¶ re-render çš„å½±å“</p>
<ul>
<li>å­ç»„ä»¶æ— çŠ¶æ€æ¸²æŸ“</li>
<li>çˆ¶ç»„ä»¶ä¼ ç»™å­ç»„ä»¶çš„ props æ²¡æœ‰å˜åŒ–</li>
</ul>
<h3 id="çˆ¶ç»„ä»¶æ¸²æŸ“ï¼Œå¦‚ä½•ä¿æŒå­ç»„ä»¶çŠ¶æ€ä¸å—å½±å“"><a href="#çˆ¶ç»„ä»¶æ¸²æŸ“ï¼Œå¦‚ä½•ä¿æŒå­ç»„ä»¶çŠ¶æ€ä¸å—å½±å“" class="headerlink" title="çˆ¶ç»„ä»¶æ¸²æŸ“ï¼Œå¦‚ä½•ä¿æŒå­ç»„ä»¶çŠ¶æ€ä¸å—å½±å“"></a>çˆ¶ç»„ä»¶æ¸²æŸ“ï¼Œå¦‚ä½•ä¿æŒå­ç»„ä»¶çŠ¶æ€ä¸å—å½±å“</h3><ul>
<li>shoudComponentUpdate<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nowWrod = <span class="keyword">this</span>.state.count;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: nowWrod &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button type=<span class="string">"button"</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">          &#123;<span class="keyword">this</span>.state.count&#125;</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;NumberTemp count=&#123;this.state.count&#125; /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class NumberTemp extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  shouldComponentUpdate(nextProps, nextState) &#123;</span></span><br><span class="line"><span class="regexp">    if (this.props.count === nextProps.count) &#123;</span></span><br><span class="line"><span class="regexp">      return false;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    return true;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    console.log("render");</span></span><br><span class="line"><span class="regexp">    return &lt;div&gt;&#123;this.props.count&#125;&lt;/</span>div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
å¦‚æœæ˜¯å¼•ç”¨ç±»å‹çš„æ•°æ®ï¼Œåªä¼šæ¯”è¾ƒæ˜¯ä¸æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œè€Œä¸ä¼šæ¯”è¾ƒæ•°æ®å€¼æ˜¯å¦æ˜¯ä¸€æ ·çš„ğŸ¤”<br>ğŸ‘‡ä¾‹å­ä¸­ï¼Œç»„ä»¶å§‹ç»ˆä¸ä¼š re-renderï¼Œå› ä¸º this.state.count å€¼ä¸ nextState.count å€¼å§‹ç»ˆä¿æŒä¸€è‡´ã€‚<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: [<span class="string">"rapper"</span>] &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> words = <span class="keyword">this</span>.state.count;</span><br><span class="line">    words.push(<span class="string">"hello "</span>);</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: words &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button type=<span class="string">"button"</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">          &#123;<span class="keyword">this</span>.state.count&#125;</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;NumberTemp count=&#123;this.state.count&#125; /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class NumberTemp extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  shouldComponentUpdate(nextProps, nextState) &#123;</span></span><br><span class="line"><span class="regexp">    if (this.props.count === nextProps.count) &#123;</span></span><br><span class="line"><span class="regexp">      return false;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    return true;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return &lt;div&gt;&#123;this.props.count&#125;&lt;/</span>div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
å¦‚æœæƒ³è®©æ•°æ®å˜åŒ–ï¼Œ<code>const words = this.state.count;</code> æ”¹ä¸º const words = this.state.count.slice(0)ï¼Œå°±è¡Œäº†ï¼Œå› ä¸ºæ”¹å˜äº†å¼•ç”¨åœ°å€ã€‚</li>
</ul>
<ul>
<li>React.memo</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> words = <span class="keyword">this</span>.state.count;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: words &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button type=<span class="string">"button"</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">          &#123;<span class="keyword">this</span>.state.count&#125;</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;MemoNumb count=&#123;this.state.count&#125; /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const NumberTemp = props =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  console.log("render");</span></span><br><span class="line"><span class="regexp">  return &lt;div&gt;&#123;props.count&#125;&lt;/</span>div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MemoNumb = React.memo(NumberTemp);</span><br></pre></td></tr></table></figure>

<p>å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå­ç»„ä»¶ä¸­çš„countå€¼ä¸æ”¹å˜</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: [<span class="string">"wrapper"</span>] &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> words = <span class="keyword">this</span>.state.count;</span><br><span class="line">    words.push(<span class="string">"hello "</span>);</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: words &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button type=<span class="string">"button"</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">          &#123;<span class="keyword">this</span>.state.count&#125;</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;MemoNumb count=&#123;this.state.count&#125; /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">const NumberTemp = props =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  return &lt;div&gt;&#123;props.count&#125;&lt;/</span>div&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">areEqual</span>(<span class="params">prevProps, nextProps</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> MemoNumb = React.memo(NumberTemp, areEqual);</span><br></pre></td></tr></table></figure>

<h3 id="ä¸ºä»€ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ¸²æŸ“-ä¼š-å¯¼è‡´å­ç»„ä»¶æ¸²æŸ“-ï¼Ÿ-ğŸ¤”"><a href="#ä¸ºä»€ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ¸²æŸ“-ä¼š-å¯¼è‡´å­ç»„ä»¶æ¸²æŸ“-ï¼Ÿ-ğŸ¤”" class="headerlink" title="ä¸ºä»€ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ¸²æŸ“ ä¼š å¯¼è‡´å­ç»„ä»¶æ¸²æŸ“ ï¼Ÿ ğŸ¤”"></a>ä¸ºä»€ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ¸²æŸ“ ä¼š å¯¼è‡´å­ç»„ä»¶æ¸²æŸ“ ï¼Ÿ ğŸ¤”</h3>]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/02/18/hello-world/</url>
    <content><![CDATA[<h2 id="æ–°äººæŠ¥é“ï¼Œå¤šå¤šæŒ‡æ•™å“¦"><a href="#æ–°äººæŠ¥é“ï¼Œå¤šå¤šæŒ‡æ•™å“¦" class="headerlink" title="æ–°äººæŠ¥é“ï¼Œå¤šå¤šæŒ‡æ•™å“¦~"></a>æ–°äººæŠ¥é“ï¼Œå¤šå¤šæŒ‡æ•™å“¦~</h2>]]></content>
  </entry>
  <entry>
    <title>express</title>
    <url>/2019/12/28/express/</url>
    <content><![CDATA[<h3 id="å®‰è£…nodemon"><a href="#å®‰è£…nodemon" class="headerlink" title="å®‰è£…nodemon"></a>å®‰è£…nodemon</h3><a id="more"></a>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line">app.use(express.static(__dirname + <span class="string">'/public'</span>)) <span class="comment">//__dirnameæ˜¯å¿…é¡»çš„ï¼Œä¸ç„¶è®¿é—®ä¸åˆ°publicç›®å½•</span></span><br><span class="line">app.use(<span class="string">'/static'</span>, express.static(__dirname + <span class="string">'/public'</span>)) <span class="comment">//æ·»åŠ è·¯å¾„åç§°</span></span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'port 3000 is listened'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="expresså®ç°è·¯ç”±"><a href="#expresså®ç°è·¯ç”±" class="headerlink" title="expresså®ç°è·¯ç”±"></a>expresså®ç°è·¯ç”±</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">var</span> app = express()</span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'root'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">'/about'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'about'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'port 3000 is listened'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="expressè·¯ç”±çš„æ­£åˆ™åŒ¹é…"><a href="#expressè·¯ç”±çš„æ­£åˆ™åŒ¹é…" class="headerlink" title="expressè·¯ç”±çš„æ­£åˆ™åŒ¹é…"></a>expressè·¯ç”±çš„æ­£åˆ™åŒ¹é…</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œçš„æ­£åˆ™åŒ¹é…ä¸é€šå¸¸çš„æ­£åˆ™åŒ¹é…ä¸ä¸€è‡´ï¼Œé€šå¸¸çš„* åŒ¹é…&#123;0,n&#125; å› ä¸ºè¿™é‡Œä¸æ˜¯æ­£åˆ™åŒ¹é…</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯è¿™é‡Œçš„*åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œè€Œ* å‰é¢çš„abå’Œåé¢çš„cdæ˜¯å¿…é¡»è¦æœ‰çš„</span></span><br><span class="line">app.get(<span class="string">'/ab*cd'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'ab'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®Œå…¨çš„æ­£åˆ™åŒ¹é…ï¼Œæ³¨æ„å’Œä¸Šé¢çš„åŒºåˆ«</span></span><br><span class="line">app.get(<span class="regexp">/a/</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'anything string has a'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿”å›jsonå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">// åŒæ ·è¿˜æœ‰-å’Œ.åŒ¹é…</span></span><br><span class="line">app.get(<span class="string">'/users/:userId/books/:bookId'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(req.params)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.get(<span class="string">'/example/b'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'the response will be sent by the next function ...'</span>)</span><br><span class="line">    next()</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'hello from B'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// åŒ¹é…ä¸¤ä¸ªfunctionæ˜¯æœ‰ä»€ä¹ˆç”¨</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨ /user/:id è·¯å¾„ä¸­ä¸ºä»»ä½•ç±»å‹çš„ HTTP è¯·æ±‚æ‰§è¡Œæ­¤å‡½æ•°ã€‚</span></span><br><span class="line">app.use(<span class="string">'/user/:id'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æ­¤å‡½æ•°å¤„ç†é’ˆå¯¹ /user/:id è·¯å¾„çš„ GET è¯·æ±‚</span></span><br><span class="line">app.get(<span class="string">'/user/:id'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>React-IMVC</title>
    <url>/2019/12/28/React-IMVC/</url>
    <content><![CDATA[<h3 id="å¸¦ç€é—®é¢˜å»å­¦ä¹ "><a href="#å¸¦ç€é—®é¢˜å»å­¦ä¹ " class="headerlink" title="å¸¦ç€é—®é¢˜å»å­¦ä¹ "></a>å¸¦ç€é—®é¢˜å»å­¦ä¹ </h3><ol>
<li>nodejsç¯å¢ƒå¦‚ä½•åŠ è½½å‰ç«¯ç»„ä»¶</li>
<li>ç»„ä»¶çš„æ•°æ®å¦‚ä½•è·å–</li>
<li>HMRæ€ä¹ˆåš</li>
<li>CSSå¦‚ä½•å¤„ç†</li>
<li>å¦‚ä½•æ‹¼æ¥æˆå®Œæ•´çš„HTMLç»“æ„è¿”å›</li>
<li>åŒç«¯æ¸²æŸ“ç»“æœä¸ä¸€è‡´æ€ä¹ˆåŠ</li>
<li>å¦‚ä½•è¿›è¡Œè·¯ç”±åˆ†å‰²</li>
<li>å¦‚ä½•é™çº§ä¸ºå®¢æˆ·ç«¯æ¸²æŸ“</li>
<li>ç”Ÿäº§ç¯å¢ƒå¦‚ä½•å‘å¸ƒåº”ç”¨</li>
</ol>
<a id="more"></a>

<p><a href="https://juejin.im/post/5af443856fb9a07abc29f1eb" target="_blank" rel="noopener">React å®ç°æœåŠ¡ç«¯æ¸²æŸ“</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/63744358?utm_source=wechat_session&utm_medium=social&utm_oi=940270556197728256" target="_blank" rel="noopener">å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³æ¨èé˜…è¯»</a></p>
<p><a href="https://imweb.io/topic/5b189d04d4c96b9b1b4c4ed6" target="_blank" rel="noopener">React setState å®ç°åŸç†</a></p>
<p><a href="https://dev.to/" target="_blank" rel="noopener">å¼€å‘ç½‘ç«™</a></p>
<p><a href="https://mp.weixin.qq.com/s/23f64lu-qAEAK76lFYyzow" target="_blank" rel="noopener">åˆ©ç”¨webpackæ­å»ºè„šæ‰‹æ¶ä¸€å¥—å®Œæ•´æµç¨‹</a></p>
<p><a href="https://mp.weixin.qq.com/s/-Il3V0dtDA3JR1okK2yJyw" target="_blank" rel="noopener">åŒæ„</a></p>
<p><a href="https://mp.weixin.qq.com/s/W8-Cu8Mjh00Rze5o4bFKag" target="_blank" rel="noopener">css æ•´ç†</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// react-imvc é«˜é˜¶ç»„ä»¶æºç </span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * connect æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ¥å— selector å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å› withData å‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment"> * withData å‡½æ•°æ¥å—ä¸€ä¸ª React ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°çš„ React ç»„ä»¶ã€‚withData ä¼šå°† selector å‡½æ•°è¿”å›çš„æ•°æ®ï¼Œä½œä¸º props ä¼ å…¥æ–°çš„ React ç»„ä»¶</span></span><br><span class="line"><span class="comment"> * selector(&#123; state, handlers, actions &#125;) å‡½æ•°å°†å¾—åˆ°ä¸€ä¸ª data å‚æ•°ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå­—æ®µ state, handlers, acitonsï¼Œåˆ†åˆ«å¯¹åº” controller é‡Œçš„ global state, global handlers å’Œ actions å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> GlobalContext <span class="keyword">from</span> <span class="string">'../context'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> returnNull = <span class="function"><span class="params">()</span> =&gt;</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (selector = returnNull) =&gt; <span class="function"><span class="params">InputComponent</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">Connector</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            GlobalContext.Consumer &gt; &#123;</span></span><br><span class="line"><span class="xml">                (&#123;</span></span><br><span class="line"><span class="xml">                    state,</span></span><br><span class="line"><span class="xml">                    handlers,</span></span><br><span class="line"><span class="xml">                    actions</span></span><br><span class="line"><span class="xml">                &#125;) =&gt; &#123;</span></span><br><span class="line"><span class="xml">                    return ( <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                        InputComponent &#123;</span></span><br><span class="line"><span class="xml">                            ...props</span></span><br><span class="line"><span class="xml">                        &#125; &#123;</span></span><br><span class="line"><span class="xml">                            ...selector(&#123;</span></span><br><span class="line"><span class="xml">                                state,</span></span><br><span class="line"><span class="xml">                                handlers,</span></span><br><span class="line"><span class="xml">                                actions,</span></span><br><span class="line"><span class="xml">                                props</span></span><br><span class="line"><span class="xml">                            &#125;)</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                        /&gt;</span></span><br><span class="line"><span class="xml">                    )</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            /GlobalContext.Consumer&gt;</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> withData = connect((&#123;</span><br><span class="line">    state</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        content: state.loadingText</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withData(Loading);</span><br><span class="line"></span><br><span class="line">connect(selector)(ReactComponent);</span><br><span class="line"><span class="comment">// connect æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ¥å— selector å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å› withData å‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment">// withData å‡½æ•°æ¥å—ä¸€ä¸ª React ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°çš„ React ç»„ä»¶</span></span><br><span class="line"><span class="comment">// withData ä¼šå°† selector å‡½æ•°è¿”å›çš„æ•°æ®ï¼Œä½œä¸º props ä¼ å…¥æ–°çš„ React ç»„ä»¶ã€‚</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperties(exports, &#123;</span><br><span class="line">    For: &#123;</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        value: For</span><br><span class="line">    &#125;,</span><br><span class="line">    __esModule: &#123;</span><br><span class="line">        value: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Object</span>.defineProperties(obj, props);</span><br><span class="line"><span class="comment">// __esModuleè¡¨ç¤ºå¼•å…¥çš„æ˜¯es6æ¨¡å—</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, prop, descriptor);</span><br></pre></td></tr></table></figure>

<p>å–æ¶ˆæµè§ˆå™¨è®°å½•æ»šåŠ¨æ¡ä½ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">"scrollRestoration"</span> <span class="keyword">in</span> history) &#123;</span><br><span class="line">    history.scrollRestoration = <span class="string">"manual"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.onunload = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>history.scrollRestoration æ˜¯æ–°å¢çš„ä¸€ä¸ªå±æ€§ï¼Œå€¼ä¸º auto|manual, é»˜è®¤ä¸º auto è®°å½•æ»šåŠ¨æ¡ä½ç½®, è®¾ä¸º manual æ—¶å°±ç¦ç”¨è®°å½•ä½ç½®çš„åŠŸèƒ½</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">componentDidMount() &#123;</span><br><span class="line">    history.scrollRestoration = <span class="string">'manual'</span>;</span><br><span class="line">&#125;</span><br><span class="line">componentWillUnMount() &#123;</span><br><span class="line">    history.scrollRestoration = <span class="string">'auto'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: [path.resolve(__dirname, <span class="string">"../src/single/index.js"</span>)]</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">"../dist"</span>),</span><br><span class="line">        filename: <span class="string">"[name].[chunkhash:8].js"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>webpack ä¸­å¯¹ä»£ç è¿›è¡Œäº†å“ªäº›æ“ä½œï¼Ÿ<br>1ã€ å¤šæ–‡ä»¶æ—¶å¯ä»¥è¿›è¡Œä»£ç åˆ‡å‰²</p>
<ul>
<li>è‹¥å…¥å£ï¼ˆpageA, pageBï¼‰éƒ½ç”¨åˆ°äº† utilBï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠå®ƒæŠ½ç¦»æˆå•ç‹¬æ–‡ä»¶ï¼Œå¹¶ä¸”å½“ç”¨æˆ·è®¿é—® pageA å’Œ pageB çš„æ—¶å€™éƒ½èƒ½å»åŠ è½½ utilB è¿™ä¸ªå…¬å…±æ¨¡å—ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºå„è‡ªçš„å…¥å£æ–‡ä»¶ä¸­ã€‚</li>
<li>pageB ä¸­ utilC ä¸æ˜¯é¡µé¢ä¸€å¼€å§‹åŠ è½½æ—¶å€™å°±éœ€è¦çš„å†…å®¹ï¼Œå‡å¦‚ utilC å¾ˆå¤§ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›é¡µé¢åŠ è½½æ—¶å°±ç›´æ¥åŠ è½½ utilCï¼Œè€Œæ˜¯å½“ç”¨æˆ·è¾¾åˆ°æŸç§æ¡ä»¶(å¦‚ï¼šç‚¹å‡»æŒ‰é’®)æ‰å»å¼‚æ­¥åŠ è½½ utilCï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å°† utilC æŠ½ç¦»æˆå•ç‹¬æ–‡ä»¶ï¼Œå½“ç”¨æˆ·éœ€è¦çš„æ—¶å€™å†å»åŠ è½½è¯¥æ–‡ä»¶ã€‚</li>
</ul>
<p>å¤šæ–‡ä»¶æ‰“åŒ…ç¤ºä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        pageA: [path.resolve(__dirname, <span class="string">"./src/multiple/pageA.js"</span>)],</span><br><span class="line">        pageB: path.resolve(__dirname, <span class="string">"./src/multiple/pageB.js"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">"./dist"</span>),</span><br><span class="line">        filename: <span class="string">"[name].[chunkhash:8].js"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                commons: &#123;</span><br><span class="line">                    chunks: <span class="string">"initial"</span>,</span><br><span class="line">                    minChunks: <span class="number">2</span>,</span><br><span class="line">                    maxInitialRequests: <span class="number">5</span>,</span><br><span class="line">                    minSize: <span class="number">0</span></span><br><span class="line">                &#125;,</span><br><span class="line">                vendor: &#123;</span><br><span class="line">                    test: <span class="regexp">/node_modules/</span>,</span><br><span class="line">                    chunks: <span class="string">"initial"</span>,</span><br><span class="line">                    name: <span class="string">"vendor"</span>,</span><br><span class="line">                    priority: <span class="number">10</span>,</span><br><span class="line">                    enforce: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…å‡ºæ¥åˆ†ä¸ºï¼š<br>1ã€ ä¸šåŠ¡ä»£ç æ–‡ä»¶ï¼Œ<br>2ã€ å…±åŒæ¨¡å—æ–‡ä»¶<br>3ã€ å¼‚æ­¥åŠ è½½çš„æ–‡ä»¶ä¼šç›´æ¥æŠ½ç¦»</p>
<p>react-imvc preloadæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ </p>
<p>preloadæå‰åŠ è½½çš„æ–¹å¼</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨ link æ ‡ç­¾é™æ€æ ‡è®°éœ€è¦é¢„åŠ è½½çš„èµ„æº --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"preload"</span> <span class="attr">href</span>=<span class="string">"/path/to/style.css"</span> <span class="attr">as</span>=<span class="string">"style"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æˆ–ä½¿ç”¨è„šæœ¬åŠ¨æ€åˆ›å»ºä¸€ä¸ª link æ ‡ç­¾åæ’å…¥åˆ° head å¤´éƒ¨</span></span><br><span class="line"><span class="comment">// å½“æµè§ˆå™¨è§£æåˆ°è¿™è¡Œä»£ç å°±ä¼šå»åŠ è½½ href ä¸­å¯¹åº”çš„èµ„æºä½†ä¸æ‰§è¡Œï¼Œå¾…åˆ°çœŸæ­£ä½¿ç”¨åˆ°çš„æ—¶å€™å†æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">const</span> link = <span class="built_in">document</span>.createElement(<span class="string">'link'</span>);</span><br><span class="line">link.rel = <span class="string">'preload'</span>;</span><br><span class="line">link.as = <span class="string">'style'</span>;</span><br><span class="line">link.href = <span class="string">'/path/to/style.css'</span>;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(link);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨ HTTP å“åº”å¤´ä¸­åŠ ä¸Š preload å­—æ®µ</span></span><br></pre></td></tr></table></figure>

<p>Reactç»„ä»¶è¿˜æœ‰å¾ˆå¤šä¸ªåœ°æ–¹å¯ä»¥ç›´æ¥è®¿é—®çˆ¶ç»„ä»¶æä¾›çš„Contextï¼š</p>
<ul>
<li>æ„é€ æ–¹æ³•</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props, context)</span><br></pre></td></tr></table></figure>

<ul>
<li>ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">-componentWillReceiveProps(nextProps, nextContext) -</span><br><span class="line">    shouldComponentUpdate(nextProps, nextState, nextContext) -</span><br><span class="line">    componetWillUpdate(nextProps, nextState, nextContext)</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯¹äºé¢å‘å‡½æ•°çš„æ— çŠ¶æ€ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°çš„å‚æ•°ç›´æ¥è®¿é—®ç»„ä»¶çš„context</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> StatelessComponent = <span class="function">(<span class="params">props, context</span>) =&gt;</span> (</span><br><span class="line">    ....</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>React.createContext ç”¨æ³•æ¬ ç¼ºç‚¹ã€‚å¯¹äºåµŒå¥—å¾ˆæ·±çš„contextä½¿ç”¨èµ·æ¥å¾ˆè‡ƒè‚¿</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CurrentRoute = React.createContext(&#123;</span><br><span class="line">    path: <span class="string">'/welcome'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> CurrentUser = React.createContext(&#123;</span><br><span class="line">    name: <span class="string">'33'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> IsStatic = React.createContext(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        CurrentRoute.Consumer &gt; &#123;</span></span><br><span class="line"><span class="xml">            currentRoute =&gt;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            CurrentUser.Consumer &gt; &#123;</span></span><br><span class="line"><span class="xml">                currentUser =&gt;</span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                IsStatic.Consumer &gt; &#123;</span></span><br><span class="line"><span class="xml">                    isStatic =&gt;</span></span><br><span class="line"><span class="xml">                    !isStatic &amp;&amp;</span></span><br><span class="line"><span class="xml">                    currentRoute.path === '/welcome' &amp;&amp;</span></span><br><span class="line"><span class="xml">                    (currentUser ?</span></span><br><span class="line"><span class="xml">`Welcome back, $&#123;currentUser.name&#125;!` :</span></span><br><span class="line"><span class="xml">                        'Welcome!'</span></span><br><span class="line"><span class="xml">                    )</span></span><br><span class="line"><span class="xml">                &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                /IsStatic.Consumer&gt;</span></span><br><span class="line">            &#125; &lt;</span><br><span class="line">            /CurrentUser.Consumer&gt;</span><br><span class="line">        &#125; &lt;</span><br><span class="line">        /CurrentRoute.Consumer&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    useContext</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CurrentRoute = React.createContext(&#123;</span><br><span class="line">    path: <span class="string">'/welcome'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> CurrentUser = React.createContext(<span class="literal">undefined</span>)</span><br><span class="line"><span class="keyword">const</span> IsStatic = React.createContext(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> currentRoute = useContext(CurrentRoute)</span><br><span class="line">    <span class="keyword">let</span> currentUser = useContext(CurrentUser)</span><br><span class="line">    <span class="keyword">let</span> isStatic = useContext(IsStatic)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        !isStatic &amp;&amp;</span><br><span class="line">        currentRoute.path === <span class="string">'/welcome'</span> &amp;&amp;</span><br><span class="line">        (currentUser ?</span><br><span class="line"><span class="string">`Welcome back, <span class="subst">$&#123;currentUser.name&#125;</span>!`</span> :</span><br><span class="line">            <span class="string">'Welcome!'</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    useContext</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> GlobalContext <span class="keyword">from</span> <span class="string">'../context'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;</span><br><span class="line">        ctrl</span><br><span class="line">    &#125; = useContext(GlobalContext)</span><br><span class="line">    <span class="keyword">return</span> ctrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>connectæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ¥å—selectorå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›withDataå‡½æ•°<br>withDataå‡½æ•°æ¥å—ä¸€ä¸ªReactç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ–°çš„reactç»„ä»¶ï¼ŒwithDataä¼šå°†selectorå‡½æ•°è¿”å›çš„æ•°æ®ï¼Œä½œä¸ºpropsä¼ å…¥æ–°çš„reactç»„ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> connect <span class="keyword">from</span> <span class="string">'react-imvc/hoc/connect'</span></span><br><span class="line"><span class="keyword">const</span> withData = connect((&#123;</span><br><span class="line">    state</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        content: state.loadingText</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withData(Loading)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Loading</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!props.content) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        div id = "wxloading"</span></span><br><span class="line"><span class="xml">        className = "wx_loading" &gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        div className = "wx_loading_inner" &gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        i className = "wx_loading_icon" / &gt; &#123;</span></span><br><span class="line"><span class="xml">            props.content</span></span><br><span class="line"><span class="xml">        &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /div&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /div&gt;</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>React ç”Ÿå‘½å‘¨æœŸ</title>
    <url>/2020/02/14/React-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
    <content><![CDATA[<p>æœ¬æ–‡å¯¹ React ç”Ÿå‘½å‘¨æœŸä»¥åŠ setState åœ¨å„ä¸ªç”Ÿå‘½å‘¨æœŸä¸­çš„ä½¿ç”¨ä½œæ•´ç†ã€‚</p>
<a id="more"></a>

<h3 id="UNSAFE-componentWillMount"><a href="#UNSAFE-componentWillMount" class="headerlink" title="UNSAFE_componentWillMount"></a>UNSAFE_componentWillMount</h3><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>render å‡½æ•°å¿…é¡»æ˜¯çº¯çš„ï¼Œæ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨<br>åœ¨ render ä¸­è°ƒç”¨ setState ä¼šäº§ç”Ÿæ— é™å¾ªç¯</p>
<h3 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h3><p>compentDidMount æ–¹æ³•ä¼šåœ¨å…ƒç´  mount ä¹‹å ç«‹å³æ‰§è¡Œã€‚è°ƒç”¨ setState ï¼Œä¼šå¼•èµ·å¦ä¸€æ¬¡æ¸²æŸ“</p>
<h3 id="UNSAFE-componentWillReceiveProps-nextProps"><a href="#UNSAFE-componentWillReceiveProps-nextProps" class="headerlink" title="UNSAFE_componentWillReceiveProps(nextProps)"></a>UNSAFE_componentWillReceiveProps(nextProps)</h3><h3 id="static-getDerivedStateFromProps"><a href="#static-getDerivedStateFromProps" class="headerlink" title="static getDerivedStateFromProps"></a>static getDerivedStateFromProps</h3><p>å®ƒåœ¨ render ä¹‹å‰æ‰§è¡Œï¼ŒgetDerivedStateFromProps è¿”å›ä¸€ä¸ªå¯¹è±¡ å»æ›´æ–° stateã€‚</p>
<h3 id="shouldComponentUpdate-nextProps-nextState"><a href="#shouldComponentUpdate-nextProps-nextState" class="headerlink" title="shouldComponentUpdate(nextProps, nextState)"></a>shouldComponentUpdate(nextProps, nextState)</h3><p><strong>Should I re-render my component ï¼Ÿ</strong><br>å½“ç»„ä»¶çš„ state æˆ–è€… props æ”¹å˜ï¼Œä½†æ˜¯ä¸æƒ³ç»„ä»¶ é‡æ–°æ¸²æŸ“çš„æ—¶å€™ ä½¿ç”¨ã€‚shouldComponentUpdate æ˜¯ä¸ºäº†è®© react çŸ¥é“ï¼Œç»„ä»¶ä¸ä¼šè¢« state æˆ–è€… props çš„æ”¹å˜å½±å“ã€‚æ”¹å˜ state æˆ–è€… props çš„æ—¶å€™ä¸æƒ³è®©ç»„ä»¶æ›´æ–°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸã€‚<br>åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¸èƒ½ setState ã€‚</p>
<h3 id="UNSAFE-componentWillUpdate-nextProps-nextState"><a href="#UNSAFE-componentWillUpdate-nextProps-nextState" class="headerlink" title="UNSAFE_componentWillUpdate(nextProps, nextState)"></a>UNSAFE_componentWillUpdate(nextProps, nextState)</h3><p>getSnapshotBeforeUpdate(prevProps, prevState)</p>
<h3 id="getSnapshotBeforeUpdate"><a href="#getSnapshotBeforeUpdate" class="headerlink" title="getSnapshotBeforeUpdate"></a>getSnapshotBeforeUpdate</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  getSnapshotBeforeUpdate(prevProps, prevState) &#123;</span><br><span class="line">    <span class="keyword">return</span> prevProps;</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate(prevProps, prevState, snapshot) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(snapshot);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button type=<span class="string">"button"</span> onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.state.count&#125;</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="componentDidUpdate-prevProps-prevState"><a href="#componentDidUpdate-prevProps-prevState" class="headerlink" title="componentDidUpdate(prevProps, prevState)"></a>componentDidUpdate(prevProps, prevState)</h3><p>å¯ä»¥åœ¨ componentDidUpdate ä¸­ setStateï¼Œ ä½†æ˜¯ å¿…é¡»è¢«ç»ˆæ­¢æ¡ä»¶åŒ…è£¹ï¼Œå¦åˆ™ä¼šå¼•èµ·æ— é™å¾ªç¯</p>
<h3 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h3><h3 id="forceUpdate"><a href="#forceUpdate" class="headerlink" title="forceUpdate"></a>forceUpdate</h3><p>ğŸ‘‡ä¾‹å­ä¸­ å¿…é¡»è¦å¯¹æ–¹æ³• bind this <a href="https://www.freecodecamp.org/news/this-is-why-we-need-to-bind-event-handlers-in-class-components-in-react-f7ea1a6f93eb/" target="_blank" rel="noopener">why</a><br>forceUpdate ç›´æ¥å¯¹ç»„ä»¶è¿›è¡Œ re-render<br>forceUpdate å°†è·³è¿‡ shouldComponentUpdate ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯å¯¹å­ç»„ä»¶ï¼Œè¿˜æ˜¯ä¼šæ­£å¸¸è§¦å‘ç”Ÿå‘½å‘¨æœŸçš„ï¼ŒåŒ…æ‹¬ shouldComponentUpdate</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="comment">// è¿™é‡Œå¿…é¡»è¦bind thisï¼Œå¦åˆ™ä¼šæŠ¥é”™ ğŸ¤”</span></span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.forceUpdate();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div ref=&#123;<span class="keyword">this</span>.refCallback&#125; style=&#123;&#123; <span class="attr">border</span>: <span class="string">"1px solid red"</span> &#125;&#125;&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125; /&gt;</span><br><span class="line">        &#123;<span class="built_in">Math</span>.random()&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¸ºä»€ä¹ˆ-react-class-component-ä¸­çš„æ–¹æ³•ï¼Œéœ€è¦-bind-this"><a href="#ä¸ºä»€ä¹ˆ-react-class-component-ä¸­çš„æ–¹æ³•ï¼Œéœ€è¦-bind-this" class="headerlink" title="ä¸ºä»€ä¹ˆ react class component ä¸­çš„æ–¹æ³•ï¼Œéœ€è¦ bind this"></a>ä¸ºä»€ä¹ˆ react class component ä¸­çš„æ–¹æ³•ï¼Œéœ€è¦ bind this</h3><ul>
<li>å¦‚æœä¸ç»‘å®š thisï¼Œä»£ç å¦‚ä¸‹ğŸ‘‡</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FancyButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å°å†…å®¹</p>
<ul>
<li>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼šundefined</li>
<li>éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼šå…¨å±€å¯¹è±¡<br><img src="http://ww1.sinaimg.cn/large/92babc53gy1gbvysmvugpj20t605o74u.jpg" alt="image.png"><br>handleClick ä¸¢å¤±äº†ä¸Šä¸‹æ–‡ å’Œ this çš„å€¼</li>
</ul>
<p>åŸç†åŒğŸ‘‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name)&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  display()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="keyword">new</span> Foo(<span class="string">'Saurabh'</span>);</span><br><span class="line">foo.display(); <span class="comment">// Saurabh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> display = foo.display; </span><br><span class="line">display(); <span class="comment">// TypeError: this is undefined</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>JavaScriptå†…å­˜æ³„æ¼</title>
    <url>/2020/01/21/JavaScript%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/</url>
    <content><![CDATA[<p>å¹³æ—¶å·¥ä½œä¸­åŸºæœ¬æ²¡æœ‰è€ƒè™‘è¿‡å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œä¹Ÿæ˜¯å› ä¸ºæ²¡æœ‰é‡åˆ°è¿‡å†…å­˜æ³„æ¼çš„æƒ…å†µã€‚<br>æœ‰è¯´JavaScriptæœ‰è‡ªå·±çš„åƒåœ¾å›æ”¶æœºåˆ¶</p>
<h3 id="å¸¦ç€é—®é¢˜å»å­¦ä¹ "><a href="#å¸¦ç€é—®é¢˜å»å­¦ä¹ " class="headerlink" title="å¸¦ç€é—®é¢˜å»å­¦ä¹ "></a>å¸¦ç€é—®é¢˜å»å­¦ä¹ </h3><ol>
<li>ä»€ä¹ˆæƒ…å†µä¼šå¼•èµ·å†…å­˜æ³„æ¼</li>
<li>JavaScriptå†…å­˜æ³„æ¼æœºåˆ¶</li>
<li><strong>é—­åŒ…åœ¨å†…å­˜ä¸­æ˜¯ä»€ä¹ˆå¯¼è‡´çš„ï¼Ÿ</strong></li>
<li>ä»å†…å­˜æ¥çœ‹ null å’Œ undefined æœ¬è´¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿnull è¡¨ç¤ºä¸€ä¸ªç©ºå¯¹è±¡æŒ‡é’ˆ ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´å¯ä»¥ç”¨ a=null</li>
<li>ä¸ºä»€ä¹ˆtypeof(null) //object typeof(undefined) //undefinedï¼Ÿ<a id="more"></a>

</li>
</ol>
<h3 id="åŸºç¡€å›é¡¾"><a href="#åŸºç¡€å›é¡¾" class="headerlink" title="åŸºç¡€å›é¡¾"></a>åŸºç¡€å›é¡¾</h3><p>JSä¸­çš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œè¿™äº›å€¼éƒ½æœ‰å›ºå®šçš„å¤§å°ï¼Œå¾€å¾€éƒ½ä¿å­˜åœ¨æ ˆå†…å­˜ä¸­ï¼ˆé—­åŒ…é™¤å¤–ï¼‰ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å­˜å‚¨ç©ºé—´ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æ“ä½œä¿å­˜åœ¨æ ˆå†…å­˜ç©ºé—´çš„å€¼ï¼Œå› æ­¤åŸºç¡€æ•°æ®ç±»å‹éƒ½æ˜¯æŒ‰å€¼è®¿é—® æ•°æ®åœ¨æ ˆå†…å­˜ä¸­çš„å­˜å‚¨ä¸ä½¿ç”¨æ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“æ„ä¸­çš„å †æ ˆæ•°æ®ç»“æ„ï¼Œéµå¾ªåè¿›å…ˆå‡ºçš„åŸåˆ™</p>
<p><a href="https://auth0.com/blog/four-types-of-leaks-in-your-javascript-code-and-how-to-get-rid-of-them/" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a><br><a href="https://medium.com/@ethannam/javascripts-memory-model-7c972cd2c239" target="_blank" rel="noopener">javascriptå†…å­˜æ¨¡å‹</a></p>
<h3 id="ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼"><a href="#ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼"></a>ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼</h3><p>å½“ä¸€ä¸ªåº”ç”¨çš„å†…å­˜ä¸å†è¢«éœ€è¦çš„æ—¶å€™ï¼Œä½†æ˜¯ç”±äºæŸäº›åŸå› ï¼Œå†…å­˜æ²¡æœ‰è¢«é‡Šæ”¾ç»™æ“ä½œç³»ç»Ÿæˆ–è€…å†…å­˜åŒºã€‚ç¼–ç¨‹è¯­è¨€å€¾å‘äºé€šè¿‡ä¸åŒçš„æ–¹å¼ç®¡ç†å†…å­˜ã€‚è¿™ä¼šå‡å°‘å†…å­˜æ³„æ¼çš„å‘ç”Ÿã€‚ç„¶è€Œï¼Œä¸€ç‰‡å†…å­˜æ˜¯å¦è¢«ä½¿ç”¨æ˜¯ä¸ç¡®å®šäº‹ä»¶ã€‚åªæœ‰å¼€å‘è€…å¯ä»¥åˆ¤æ–­æ¸…æ¥šå†…å­˜æ˜¯å¦å› ä¸ºè¿˜ç»™æ“ä½œç³»ç»Ÿã€‚ä¸€éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€æä¾›æ–¹æ³•ç»™å¼€å‘è€…å»åšè¿™ä»¶äº‹æƒ…ã€‚å¦ä¸€éƒ¨åˆ†å¸Œæœ›å¼€å‘è€…æ˜ç¡®å“ªä¸€éƒ¨åˆ†å†…å­˜æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨çš„ã€‚</p>
<h3 id="JavaScriptä¸­çš„å†…å­˜ç®¡ç†"><a href="#JavaScriptä¸­çš„å†…å­˜ç®¡ç†" class="headerlink" title="JavaScriptä¸­çš„å†…å­˜ç®¡ç†"></a>JavaScriptä¸­çš„å†…å­˜ç®¡ç†</h3><p>JavaScriptæ˜¯ä¸€ç§GCè¯­è¨€ã€‚ä»–é€šè¿‡å‘¨æœŸæ€§çš„æ£€æŸ¥ï¼Œä¹‹å‰åˆ†é…çš„å†…å­˜æ˜¯å¦è¿˜ åœ¨è¢«ä½¿ç”¨ï¼Œå¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ã€‚</p>
<h3 id="åƒåœ¾æ”¶é›†æ˜¯å¦‚ä½•å†³å®šå†…å­˜å›æ”¶"><a href="#åƒåœ¾æ”¶é›†æ˜¯å¦‚ä½•å†³å®šå†…å­˜å›æ”¶" class="headerlink" title="åƒåœ¾æ”¶é›†æ˜¯å¦‚ä½•å†³å®šå†…å­˜å›æ”¶"></a>åƒåœ¾æ”¶é›†æ˜¯å¦‚ä½•å†³å®šå†…å­˜å›æ”¶</h3><h4 id="å†…å­˜æ³„æ¼çš„ä¸»è¦èµ·å› æ˜¯å¼•ç”¨"><a href="#å†…å­˜æ³„æ¼çš„ä¸»è¦èµ·å› æ˜¯å¼•ç”¨" class="headerlink" title="å†…å­˜æ³„æ¼çš„ä¸»è¦èµ·å› æ˜¯å¼•ç”¨"></a>å†…å­˜æ³„æ¼çš„ä¸»è¦èµ·å› æ˜¯å¼•ç”¨</h4><blockquote>
<p>ä¸åˆç†çš„å¼•ç”¨æ˜¯å¯¼è‡´å†…å­˜æ³„æ¼çš„ä¸»è¦åŸå› ã€‚</p>
</blockquote>
<p><strong>æ ‡è®°æ¸…é™¤</strong></p>
<ol>
<li>åƒåœ¾æ”¶é›†å™¨å»ºç«‹ä¸€ä¸ªrootsåˆ—è¡¨ã€‚rootsä¸€èˆ¬æ˜¯å…¨å±€å˜é‡ï¼Œå¹¶ä¸”åœ¨ä»£ç ä¸­ä¿å­˜äº†å¼•ç”¨ã€‚åœ¨JavaScriptä¸­ï¼Œwindowå°±æ˜¯å…¶ä¸­ä¸€ä¸ªrootã€‚windowå§‹ç»ˆå­˜åœ¨ã€‚åƒåœ¾æ”¶é›†å™¨ä¼šè®¤ä¸ºwindowå’Œwindowçš„å­ç±»ä¼šå§‹ç»ˆå­˜åœ¨ã€‚</li>
<li>æ‰€æœ‰çš„rootsè¢«æ£€æŸ¥å¹¶ä¸”è¢«æ ‡è®°ä¸ºactiveï¼Œå­ç±»ä¹Ÿå„è‡ªè¢«æ£€æŸ¥ã€‚å¯ä»¥ä»rootè¿½è¸ªåˆ°çš„éƒ½ä¸è¢«è®¤ä¸ºæ˜¯åƒåœ¾ã€‚</li>
<li>æ²¡æœ‰æ ‡è®°çš„å†…å­˜ä¼šè¢«è®¤ä¸ºæ˜¯åƒåœ¾ã€‚æ”¶é›†å™¨ä¼šé‡Šæ”¾å†…å­˜ã€‚</li>
</ol>
<p>ç°ä»£æ”¶é›†å™¨æ”¹è¿›äº†ç®—æ³•ï¼Œä½†æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼šreachable å†…å­˜è¢«æ ‡è®°ï¼Œå…¶ä»–çš„å†…å­˜å½“åšåƒåœ¾ã€‚<br>ä¸éœ€è¦çš„å¼•ç”¨æ˜¯æŒ‡ï¼šå¼€å‘è€…ä¸éœ€è¦è¿™äº›å¼•ç”¨ï¼Œä½†æ˜¯ç”±äºæŸäº›åŸå› ï¼Œä¾ç„¶ä¿å­˜åœ¨rootçš„å­ç±»ä¸­ã€‚</p>
<h3 id="å¸¸è§JavaScriptå†…å­˜æ³„æ¼"><a href="#å¸¸è§JavaScriptå†…å­˜æ³„æ¼" class="headerlink" title="å¸¸è§JavaScriptå†…å­˜æ³„æ¼"></a>å¸¸è§JavaScriptå†…å­˜æ³„æ¼</h3><ol>
<li>æ„å¤–çš„å…¨å±€å˜é‡</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    bar = <span class="string">"this is an explicit global variable"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.bar = <span class="string">"this is an explicit global variable"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ä¸ªå¯ä»¥æ„å¤–åˆ›å»ºå…¨å±€å˜é‡çš„æ–¹å¼æ˜¯é€šè¿‡this</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.bar = <span class="string">"this is an explicit global variable"</span></span><br><span class="line">&#125;</span><br><span class="line">foo()</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°fooå†…éƒ¨å¿˜è®°ä½¿ç”¨varï¼Œæ„å¤–åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ã€‚<br><strong>å…¨å±€å˜é‡æ³¨æ„äº‹é¡¹</strong></p>
<blockquote>
<p>å½“å…¨å±€å˜é‡ç”¨äºä¸´æ—¶å­˜å‚¨å’Œå¤„ç†å¤§é‡ä¿¡æ¯æ—¶ï¼Œéœ€è¦å°å¿ƒã€‚å¦‚æœå¿…é¡»ä½¿ç”¨å…¨å±€å˜é‡å­˜å‚¨å¤§é‡æ•°æ®æ—¶ï¼Œç¡®ä¿ç”¨å®Œä»¥åæŠŠå®ƒè®¾ç½®ä¸ºnullæˆ–è€…é‡æ–°å®šä¹‰</p>
</blockquote>
<ol start="2">
<li>è¢«é—å¿˜çš„è®¡æ—¶å™¨æˆ–å›è°ƒå‡½æ•°</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someResource = getData()</span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">"Node"</span>)</span><br><span class="line">    <span class="keyword">if</span> (node) &#123;</span><br><span class="line">        node.innerHTML = <span class="built_in">JSON</span>.stringify(someResource)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä¸èŠ‚ç‚¹æˆ–æ•°æ®å…³è”çš„è®¡æ—¶å™¨ä¸å†éœ€è¦ï¼Œnodeå¯¹è±¡å¯ä»¥åˆ é™¤ï¼Œæ•´ä¸ªå›è°ƒå‡½æ•°ä¹Ÿä¸éœ€è¦äº†ã€‚å¯æ˜¯ï¼Œè®¡æ•°å™¨å›è°ƒå‡½æ•°è¦ç­‰è®¡æ—¶å™¨åœæ­¢æ‰ä¼šè¢«å›æ”¶ã€‚åŒæ—¶ï¼ŒsomeResourceå¦‚æœå­˜å‚¨äº†å¤§é‡çš„æ•°æ®ï¼Œä¹Ÿæ˜¯æ— æ³•è¢«å›æ”¶çš„ã€‚</p>
<p>å¯¹äºè§‚å¯Ÿè€…çš„ä¾‹å­ï¼Œä¸€æ—¦ä¸å†éœ€è¦ä»–ä»¬ï¼Œæ˜ç¡®ç§»é™¤ä»–ä»¬éå¸¸é‡è¦ã€‚è€çš„IE6æ˜¯æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨çš„ã€‚å¦‚ä»Šï¼Œå³ä½¿æ²¡æœ‰æ˜ç¡®ç§»é™¤ä»–ä»¬ï¼Œä¸€æ—¦è§‚å¯Ÿè€…å¯¹è±¡å˜å¾—ä¸å¯è¾¾ï¼Œå¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯å¯ä»¥å›æ”¶è§‚å¯Ÿè€…å¤„ç†å‡½æ•°çš„ã€‚</p>
<p><strong>è§‚å¯Ÿè€…ä»£ç ç¤ºä¾‹</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'button'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onClick</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    element.innerHTML = <span class="string">'text'</span></span><br><span class="line">&#125;</span><br><span class="line">element.addEventListener(<span class="string">'click'</span>, onClick)</span><br></pre></td></tr></table></figure>

<p>å½“å¯¹nodeæ·»åŠ äº†è§‚å¯Ÿè€…ä¹‹åï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ä½†æ˜¯ï¼Œå½“å‰æµè§ˆå™¨ä¼šç›‘æµ‹å¾ªç¯å¼•ç”¨å¹¶ä¸”æ­£ç¡®çš„è¿›è¡Œå¤„ç†ï¼Œè°ƒç”¨removeEventListenerä¸æ˜¯å¿…é¡»çš„äº†ã€‚</p>
<ol start="3">
<li>è„±ç¦»DOMçš„å¼•ç”¨</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> element = &#123;</span><br><span class="line">    button: <span class="built_in">document</span>.getElementById(<span class="string">'button'</span>),</span><br><span class="line">    image: <span class="built_in">document</span>.getElementById(<span class="string">'image'</span>),</span><br><span class="line">    text: <span class="built_in">document</span>.getElementById(<span class="string">'text'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doStuff</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    image.src = <span class="string">'http://some.url/image'</span></span><br><span class="line">    button.click()</span><br><span class="line">    <span class="built_in">console</span>.log(text.innerHTML)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeButton</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">'button'</span>))</span><br><span class="line">    <span class="comment">// å½“å‰ï¼Œåœ¨å…¨å±€ä¾ç„¶æœ‰buttonçš„å¼•ç”¨ã€‚buttonè¿˜ä¼šä¿å­˜åœ¨å†…å­˜ä¸­å¹¶ä¸”å¹¶ä¸èƒ½è¢«GCå›æ”¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> refA = <span class="built_in">document</span>.getElementById(<span class="string">'refA'</span>)</span><br><span class="line"><span class="built_in">document</span>.body.removeChild(refA)</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•ï¼šrefA = null</p>
<ol start="4">
<li>é—­åŒ…</li>
</ol>
<p><strong>åŒ¿åå‡½æ•°å¯ä»¥è®¿é—®çˆ¶çº§ä½œç”¨åŸŸçš„å˜é‡</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindEvent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="built_in">document</span>.createElement(<span class="string">"XXX"</span>)</span><br><span class="line">    <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(obj, <span class="string">"é—­åŒ…å¼•ç”¨"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> theThing = <span class="literal">null</span></span><br><span class="line"><span class="keyword">var</span> replaceThing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> originalThing = theThing</span><br><span class="line">    <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (originalThing) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"hi"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        theThing = &#123;</span><br><span class="line">            longStr: <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10000000</span>).join(<span class="string">'*'</span>),</span><br><span class="line">            someMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(someMessage)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">setInterval(replaceThing, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•ï¼šæ‰‹åŠ¨è§£é™¤å¼•ç”¨obj = null</p>
]]></content>
      <categories>
        <category>åŸºç¡€</category>
      </categories>
  </entry>
  <entry>
    <title>Iterm 2 settings</title>
    <url>/2019/12/28/Iterm-2-settings/</url>
    <content><![CDATA[<p>æœ¬æ–‡è®°å½• oh my zsh åŠå…¶æ’ä»¶çš„å®‰è£…æ–¹æ³•ã€‚åœ¨itemä½¿ç”¨è¿‡ç¨‹ä¸­å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤</p>
<a id="more"></a>

<p><code>cat /etc/shells</code><br>æŸ¥çœ‹ç³»ç»Ÿæœ‰å‡ ä¸ªshell bashæ˜¯macä¸­terminalè‡ªå¸¦çš„shellï¼ŒæŠŠå®ƒæ¢æˆzshï¼Œè¿™ä¸ªçš„åŠŸèƒ½è¦å¤šå¾—å¤šã€‚æ‹¥æœ‰è¯­æ³•é«˜äº®ï¼Œå‘½ä»¤è¡Œtabè¡¥å…¨ï¼Œè‡ªåŠ¨æç¤ºç¬¦ï¼Œæ˜¾ç¤ºGitä»“åº“çŠ¶æ€ç­‰åŠŸèƒ½<br><code>chsh -s /bin/zsh</code> è®¾ç½®é»˜è®¤shell<br><code>cd ~/.ssh</code> è¿›å…¥sshæ–‡ä»¶å¤¹<br><code>open ~/.ssh</code> æ‰“å¼€sshæ–‡ä»¶å¤¹<br><code>cmd + w</code> å…³é—­å½“å‰é¡µ<br><code>history</code> æŸ¥çœ‹å‘½ä»¤<br><code>cd ~</code> è®¿é—®ç”¨æˆ·ç›®å½•<br><code>cd /</code> è®¿é—®æ ¹ç›®å½•<br><code>clear</code> æ¸…ç©º<br><code>pwd</code> æ˜¾ç¤ºå½“å‰ç›®å½•</p>
<h3 id="å®‰è£…-oh-my-zsh"><a href="#å®‰è£…-oh-my-zsh" class="headerlink" title="å®‰è£… oh my zsh"></a>å®‰è£… oh my zsh</h3><p><code>sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;</code> </p>
<h3 id="oh-my-zshè¯­æ³•é«˜äº®æ’ä»¶"><a href="#oh-my-zshè¯­æ³•é«˜äº®æ’ä»¶" class="headerlink" title="oh-my-zshè¯­æ³•é«˜äº®æ’ä»¶"></a>oh-my-zshè¯­æ³•é«˜äº®æ’ä»¶</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd ~&#x2F;.oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git</span><br><span class="line">vi ~&#x2F;.zshrc</span><br><span class="line">plugins&#x3D;(</span><br><span class="line">  zsh-syntax-highlighting</span><br><span class="line">  git </span><br><span class="line">  z</span><br><span class="line">  )</span><br><span class="line">source ~&#x2F;.zshrc</span><br><span class="line">è¿è¡Œ source ~&#x2F;.zshrc æ›´æ–°é…ç½®åé‡å¯item2</span><br></pre></td></tr></table></figure>

<h3 id="å¿«æ·å‘½ä»¤"><a href="#å¿«æ·å‘½ä»¤" class="headerlink" title="å¿«æ·å‘½ä»¤"></a>å¿«æ·å‘½ä»¤</h3><p><code>z</code> å¿«é€Ÿè¿›å…¥å¸¸ç”¨æ–‡ä»¶<br><code>trash</code> ç›¸å½“äº <code>rm -rf</code> åˆ é™¤æŸä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä¼šæ”¾åˆ°åƒåœ¾ç®±é‡Œé¢</p>
<h3 id="oh-my-zshå‘½ä»¤è‡ªåŠ¨è¡¥å…¨æ’ä»¶"><a href="#oh-my-zshå‘½ä»¤è‡ªåŠ¨è¡¥å…¨æ’ä»¶" class="headerlink" title="oh-my-zshå‘½ä»¤è‡ªåŠ¨è¡¥å…¨æ’ä»¶"></a>oh-my-zshå‘½ä»¤è‡ªåŠ¨è¡¥å…¨æ’ä»¶</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd ~&#x2F;.oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions</span><br><span class="line">vi ~&#x2F;.zshrc</span><br><span class="line">plugins&#x3D;(</span><br><span class="line">  git </span><br><span class="line">  z</span><br><span class="line">  zsh-autosuggestions</span><br><span class="line">  )</span><br><span class="line">source ~&#x2F;.zshrc</span><br></pre></td></tr></table></figure>

<h3 id="code-è‡ªåŠ¨åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡¹ç›®"><a href="#code-è‡ªåŠ¨åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡¹ç›®" class="headerlink" title="code . è‡ªåŠ¨åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡¹ç›®"></a>code . è‡ªåŠ¨åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡¹ç›®</h3><p><code>shift + command + p</code> -&gt; shell command  -&gt; install â€˜codeâ€™ command in PATH</p>
]]></content>
  </entry>
  <entry>
    <title>HTTP</title>
    <url>/2020/01/13/HTTP/</url>
    <content><![CDATA[<p>æœ¬ç¯‡æ•´ç† ã€Šå›¾è§£HTTPã€‹ ä»¥åŠ ã€ŠHTTPæƒå¨æŒ‡å—ã€‹ç›¸å…³çŸ¥è¯†ç‚¹</p>
<h3 id="HTTP-é¦–éƒ¨"><a href="#HTTP-é¦–éƒ¨" class="headerlink" title="HTTP é¦–éƒ¨"></a>HTTP é¦–éƒ¨</h3><h3 id="Access-Control-Expose-Headers"><a href="#Access-Control-Expose-Headers" class="headerlink" title="Access-Control-Expose-Headers"></a>Access-Control-Expose-Headers</h3><blockquote>
<p>åˆ—å‡ºäº†å“ªäº›é¦–éƒ¨å¯ä»¥ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†æš´éœ²ç»™å¤–éƒ¨</p>
</blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰6ç§ç®€å•å“åº”é¦–éƒ¨å¯ä»¥æš´éœ²ç»™å¤–éƒ¨</p>
<ul>
<li>Cache-Control</li>
<li>Content-Language</li>
<li>Content-Type</li>
<li>Expires</li>
<li>Last-Modified</li>
<li>Pragma</li>
</ul>
<h3 id="access-control-allow-credentials"><a href="#access-control-allow-credentials" class="headerlink" title="access-control-allow-credentials"></a>access-control-allow-credentials</h3><blockquote>
<p>è¡¨ç¤ºæ˜¯å¦å¯ä»¥å°†å¯¹è¯·æ±‚çš„å“åº”æš´éœ²ç»™é¡µé¢</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>åº•éƒ¨å¯¼èˆª</title>
    <url>/2019/12/28/ButtonNav/</url>
    <content><![CDATA[<p>åº•éƒ¨å¯¼èˆªé¡¹ç›®ç»å†</p>
<a id="more"></a>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> checkIsCurrentBottom = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> isBottom =</span><br><span class="line">        <span class="built_in">window</span>.pageYOffset + <span class="built_in">document</span>.body.clientHeight ===</span><br><span class="line">        <span class="built_in">document</span>.documentElement.scrollHeight;</span><br><span class="line">    <span class="keyword">return</span> isBottom;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> handleScrollCallBack = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æ»šåŠ¨æ¡æ˜¯å¦åˆ°è¾¾é¡µé¢æœ€åº•éƒ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> isCurrentBottom = checkIsCurrentBottom();</span><br><span class="line">    handleAddGap(isCurrentBottom);</span><br><span class="line">&#125;;</span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    handleScrollCallBack();</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">"scroll"</span>, handleScrollCallBack);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">window</span>.removeEventListener(<span class="string">"scroll"</span>, handleScrollCallBack);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * bottomNavæ˜¯ä¸€ä¸ªfunction å‡½æ•°</span></span><br><span class="line"><span class="comment"> * åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢æ›´æ–°ä¸€ä¸ªå…¨å±€çš„çŠ¶æ€ï¼Œä¼šå¯¼è‡´è°ƒç”¨çˆ†æ ˆ</span></span><br><span class="line"><span class="comment"> * 1ã€Render methods should be a pure function of props and state; </span></span><br><span class="line"><span class="comment"> * triggering nested component updates from render is not allowed. </span></span><br><span class="line"><span class="comment"> * If necessary, trigger nested updates in componentDidUpdate.</span></span><br><span class="line"><span class="comment"> * Check the render method of BottomNavigation.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 2ã€Maximum update depth exceeded. </span></span><br><span class="line"><span class="comment"> * This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. </span></span><br><span class="line"><span class="comment"> * React limits the number of nested updates to prevent infinite loops.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  tangram è¿™ä¸ªé¡¹ç›®å¯¹cssçš„æ•æ„Ÿåº¦è¦æ±‚æ¯”è¾ƒé«˜ã€‚åº•éƒ¨å¯¼èˆªçš„é—®é¢˜ï¼Œæœ¬æ¥ä»¥ä¸ºåªæœ‰offlineéœ€è¦ä¿®æ”¹ï¼Œå‰ç«¯jsè¿™è¾¹å¹¶æ²¡æœ‰é™åˆ¶ï¼Œ</span></span><br><span class="line"><span class="comment"> *  åæ¥offlineå‘å¸ƒåï¼Œå‰ç«¯çš„æ˜¾ç¤ºå°ºå¯¸è¿˜æ˜¯ä¸€æ ·çš„ã€‚åŸå› å°±æ˜¯cssé™åˆ¶äº†å›¾ç‰‡çš„å±•ç¤ºå¤§å°ã€‚åº”è¯¥è¦å…ˆçœ‹ä¸‹cssçš„ã€‚</span></span><br><span class="line"><span class="comment"> *  ä»è¿™ä¹Ÿå¯ä»¥çœ‹å‡ºå‡½æ•°å¼ç¼–ç¨‹çš„é‡è¦æ€§äº†ï¼Œä»£ç ä¸­ä¸åº”è¯¥æˆ–è€…å°½é‡å°‘çš„å¸¸é‡å€¼ï¼Œå°½å¯èƒ½å¤šçš„é…ç½®é¡¹ï¼Œä¸ç„¶offlineä¸€ä¿®æ”¹ï¼Œä½ è¿™è¾¹ä¹Ÿå¾—è·Ÿç€ä¿®æ”¹</span></span><br><span class="line"><span class="comment"> *  å°±ç®—æ˜¯cssçš„æ°´å¹³å‚ç›´å±…ä¸­ï¼Œä¹Ÿä¸åº”è¯¥ä½¿ç”¨å›ºå®šå…ƒç´ å®½é«˜çš„é‚£ç§æ–¹å¼ã€‚å“ï¼æƒ¨é­æ‰“è„¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡offlineä¸‹å‘çš„å›¾ç‰‡å°ºå¯¸è‡ªåŠ¨æ›´æ–°imgå¤§å°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.src = finalShowImage</span><br><span class="line"><span class="built_in">console</span>.log(img.width, img.height)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿™ä¸ªæ—¶å€™æ‰“å°å‡ºæ¥çš„img.width å’Œ img.height æœ‰å¯èƒ½æ˜¯ 0ã€‚</span></span><br><span class="line"><span class="comment"> * å®½é«˜éƒ½æ˜¯0çš„è¿™ä¸ªç»“æœå¾ˆæ­£å¸¸ï¼Œå› ä¸ºå›¾ç‰‡çš„ç›¸å…³æ•°æ®éƒ½æ²¡æœ‰è¢«åŠ è½½å‰å®ƒçš„å®½é«˜é»˜è®¤å°±æ˜¯0ï¼Œæˆ‘ä»¬éœ€è¦å®ƒåŠ è½½å®Œæ‰€æœ‰çš„ç›¸å…³æ•°æ®å†è·å–å®½å’Œé«˜</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * å› æ­¤ï¼š éœ€è¦ onload åŠ è½½æ‰€æœ‰çš„ç›¸å…³æ•°æ®åï¼Œå–å®½é«˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.src = finalShowImage</span><br><span class="line">img.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    setImgSize(&#123;</span><br><span class="line">        imgWidth: img.width,</span><br><span class="line">        imgHeight: img.height</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡onloadå°±èƒ½è·å–åˆ°å›¾ç‰‡çš„å®½é«˜äº†ã€‚ä½†onloadå¤§ä¸€ç‚¹çš„å›¾é€šå¸¸éƒ½æ¯”è¾ƒæ…¢ï¼Œ</span></span><br><span class="line"><span class="comment"> * ä¸å®ç”¨ï¼Œä½†åªè¦å›¾ç‰‡è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œé‚£ä¹ˆå›¾ç‰‡åŠ è½½å‡ ä¹å°±ä¸ç”¨ç­‰å¾…å³å¯è§¦å‘onloadï¼Œæˆ‘ä»¬è¦çš„æ˜¯å ä½ç¬¦ã€‚</span></span><br><span class="line"><span class="comment"> * æ‰€ä»¥æœ‰äº›äººé€šè¿‡ç¼“å­˜è·å–ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.src = finalShowImage</span><br><span class="line"><span class="keyword">if</span> (img.complete) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img.width, img.height)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(img.width, img.height)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡å®šæ—¶å¾ªç¯æ£€æµ‹è·å–</span></span><br><span class="line"><span class="comment"> * å„æµè§ˆå™¨æ‰§è¡Œç»“æœéƒ½èƒ½çœ‹åˆ°é€šè¿‡å¿«é€Ÿè·å–å›¾ç‰‡å¤§å°çš„æ–¹æ³•å‡ ä¹éƒ½åœ¨200æ¯«ç§’ä»¥å†…ï¼Œ</span></span><br><span class="line"><span class="comment"> * è€Œonloadè‡³å°‘äº”ç§’ä»¥ä¸Šï¼Œè¿™å·®åˆ«ä¹‹å¤§è¯´æ˜å¿«é€Ÿè·å–å›¾ç‰‡å®½é«˜éå¸¸å®ç”¨ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> start_time = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime()</span><br><span class="line"><span class="keyword">let</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">img.src = finalShowImage</span><br><span class="line"><span class="keyword">let</span> check = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (img.width &gt; <span class="number">0</span> || img.height &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        clearInterval(<span class="keyword">set</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">let <span class="keyword">set</span> = setInterval(check, 40)</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * è¿™äº›æ“ä½œè¿‡ç¨‹è¦ç­‰åˆ°componentDidMountä¹‹åæ‰èƒ½å¼€å§‹è¿›è¡Œã€‚æ‰€ä»¥ä¼šæ¯”è¾ƒæ…¢ã€‚</span><br><span class="line"> * æœ‰äº†ç¼“å­˜ä¹‹åonloadå°±æ¯”è¾ƒå¿«äº†</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * åº•éƒ¨å¯¼èˆªå›¾ç‰‡å·²ç»åŠ è£…å®Œæˆï¼Œä½†æ˜¯å´æ²¡æœ‰ç«‹åˆ»æ¸²æŸ“ã€‚åŸå› </span><br><span class="line"> *   ä¼šäºŒæ¬¡è°ƒç”¨ useImageåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼ŒuseImageä¹Ÿæ²¡æœ‰å ç”¨å¤ªå¤šæ—¶é—´ï¼Œä¸»è¦æ˜¯è¦ç­‰åˆ°componentDidFirstMountä¹‹åæ‰ä¼šè§¦å‘äº‹ä»¶</span><br><span class="line"> *</span><br><span class="line"> * æ‰€ä»¥å›¾ç‰‡ä¼šå…ˆåŠ è½½ï¼Œç„¶åè°ƒç”¨useImageåˆ¤æ–­å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸€å®šè¦ç­‰åˆ° componentDidFirstMount ï¼Œå› æ­¤é€ æˆ å›¾ç‰‡åŠ è½½å®Œæˆå´æ²¡æœ‰ç«‹åˆ»æ¸²æŸ“çš„ç°è±¡</span><br><span class="line"> *</span><br><span class="line"> * useImage ä¸­çš„ useEffect åªä¼šæ‰§è¡Œå››æ¬¡</span><br><span class="line"> * </span><br><span class="line"> *  ä½†æ˜¯åœ¨networké‡Œé¢æ˜¯èƒ½çœ‹åˆ°å›¾ç‰‡çš„è¯·æ±‚çš„</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>

<p>online è¸©å‘</p>
<ul>
<li><p><code>React.createRef()</code> </p>
<ul>
<li><code>function component</code> åœ¨æ¯æ¬¡çŠ¶æ€æ›´æ–° <code>updateState</code> çš„æ—¶å€™éƒ½ä¼šé‡åˆ·é¡µé¢ï¼Œå¦‚æœ <code>const video = React.createRef()</code> æ”¾åœ¨ <code>function component</code> ä¸­ï¼Œé‚£ä¹ˆ <code>setState</code> ä¹‹å ä¼šé‡æ–° <code>React.createRef()</code> , æ‹¿åˆ°çš„ <code>video.current === null</code> ï¼Œå°† <code>const video = React.createRef()</code> å½“æˆå…¨å±€å˜é‡æ”¾åœ¨ç»„ä»¶å¤–éƒ¨ï¼Œåˆ™å¯ä»¥ä¿è¯æ¯æ¬¡æ‹¿åˆ°çš„ <code>video</code> éƒ½æ˜¯åŸå§‹çš„ï¼Œä½†æ˜¯å¤šä¸ªè§†é¢‘ç»„ä»¶è¢«è°ƒç”¨å°±ä¼šæœ‰é—®é¢˜ï¼Œå¤šä¸ªè§†é¢‘ç»„ä»¶è§¦å‘çš„è¡Œä¸ºéƒ½æ˜¯åŒä¸€ä¸ªè§†é¢‘ç»„ä»¶çš„ã€‚</li>
</ul>
</li>
<li><p><code>useRef</code> è§£å†³äº†è¿™ç§é—®é¢˜ï¼Œæ›´æ–°çŠ¶æ€å å§‹ç»ˆæ‹¿åˆ°çš„æ˜¯è¯¥è§†é¢‘ç»„ä»¶çš„ <code>video</code> </p>
</li>
<li><p><code>functional component</code> è¿˜æ˜¯å¤šä½¿ç”¨hookå§ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿéƒ½æ˜¯ç”¨çš„ <code>useRef</code> </p>
</li>
</ul>
<p>åº•éƒ¨å¯¼èˆª</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå¦‚æœä¸éœ€è¦ä¿åº•é€»è¾‘ï¼ˆæœªåŠ è½½å®Œæˆçš„æ—¶å€™æ˜¾ç¤ºæ–‡å­—ï¼‰ï¼Œå¯ä»¥ç›´æ¥æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ•ˆæœç±»ä¼¼iconå®«æ ¼<br>å¦‚æœéœ€è¦ä¿åº•é€»è¾‘ã€‚å¯¹æ¯”å·®åˆ«ï¼š<br>å…ˆæ¸…é™¤ç¼“å­˜ï¼Œå›¾ç‰‡ä¸‹è½½ç»“æŸä¼šç«‹å³æ›´æ–°ï¼Œ<br>å¦‚æœæ˜¯å·²æœ‰ç¼“å­˜ï¼Œå› ä¸ºåˆ¤æ–­å›¾ç‰‡åŠ è½½å®Œæˆéœ€è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œï¼Œæ‰€ä»¥åº•éƒ¨å¯¼èˆªä¹Ÿæœ‰å˜åŒ–çš„è¿‡ç¨‹ï¼Œæ¯”iconå®«æ ¼è¿˜æ˜¯æ…¢ä¸€ç‚¹ï¼Œå’Œå¸‚åœºéƒ¨å¹¿å‘Šå‡ºç°çš„æ—¶é—´æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>Tips: </p>
<ul>
<li>å°è¯•ï¼š æ›´æ”¹æ ·å¼ï¼Œæ–‡å­—å§‹ç»ˆå±•ç¤ºï¼Œå›¾ç‰‡åŠ è½½æˆåŠŸè‡ªåŠ¨è¦†ç›–æ–‡å­—ã€‚è§£å†³image onloadåˆ¤æ–­æ—¶é—´é•¿çš„é—®é¢˜ã€‚</li>
<li>æ“ä½œï¼š </li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> emitFailed = statusDefault === <span class="string">'failed'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> imgFailed = emitFailed &amp;&amp; showImg</span><br><span class="line"><span class="keyword">let</span> imgStyle = &#123;</span><br><span class="line">        width: imgReady ? <span class="string">`<span class="subst">$&#123;imgWidth <span class="regexp">/ 100&#125;rem` : (imgFailed ? '0' : '1.48rem'),</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">        height: imgReady ? `$&#123;imgHeight /</span> <span class="number">100</span>&#125;</span>rem`</span> : (imgFailed ? <span class="string">'0'</span> : <span class="string">'0.98rem'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &lt;</span><br><span class="line">    p &gt; &#123;</span><br><span class="line">        text</span><br><span class="line">    &#125; &lt; <span class="regexp">/p&gt;</span></span><br></pre></td></tr></table></figure>

<p>  é—®é¢˜ï¼šå¦‚æœå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä¼šå±•ç¤ºä¸€æ®µæ—¶é—´çš„å¤±è´¥å›¾ç‰‡ï¼Œå†è¢«æ›¿æ¢</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt; ImageHelper imgUniqueId = &#123;</span><br><span class="line">    imgUniqueId</span><br><span class="line">&#125;</span><br><span class="line">textUniqueId = &#123;</span><br><span class="line">    textUniqueId</span><br><span class="line">&#125;</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ImageHelper</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    imgUniqueId,</span></span></span><br><span class="line"><span class="function"><span class="params">    textUniqueId</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> script = <span class="string">`&lt;script type="text/javascript"&gt;</span></span><br><span class="line"><span class="string">  var targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span> = document.querySelector('#<span class="subst">$&#123;imgUniqueId&#125;</span>');</span></span><br><span class="line"><span class="string">  var targetText_<span class="subst">$&#123;textUniqueId&#125;</span> = document.querySelector('#<span class="subst">$&#123;textUniqueId&#125;</span>');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  function setImageStyle(textNode, imageNode) &#123;</span></span><br><span class="line"><span class="string">    if(textNode &amp;&amp; imageNode) &#123;</span></span><br><span class="line"><span class="string">      textNode.style.display = 'none';</span></span><br><span class="line"><span class="string">      imageNode.style.height = imageNode.naturalHeight / 100 + 'rem';</span></span><br><span class="line"><span class="string">      imageNode.style.width = imageNode.naturalWidth / 100 + 'rem';</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  if(targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>) &#123;</span></span><br><span class="line"><span class="string">    if(!!targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>.naturalHeight) &#123;</span></span><br><span class="line"><span class="string">      setImageStyle(targetText_<span class="subst">$&#123;textUniqueId&#125;</span>, targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>)</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>.onload = function() &#123;</span></span><br><span class="line"><span class="string">        setImageStyle(targetText_<span class="subst">$&#123;textUniqueId&#125;</span>, targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">            __html: script</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">    /&gt; </span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;</span><br><span class="line">    useRef</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> cx <span class="keyword">from</span> <span class="string">"classnames"</span>;</span><br><span class="line"><span class="keyword">import</span> useImageRefSize <span class="keyword">from</span> <span class="string">'../../../hooks/useImageRefSize'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> zIndex1000 = &#123;</span><br><span class="line">    zIndex: <span class="number">1000</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">BottomNavigation</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    templateConfig,</span></span></span><br><span class="line"><span class="function"><span class="params">    handlers,</span></span></span><br><span class="line"><span class="function"><span class="params">    state,</span></span></span><br><span class="line"><span class="function"><span class="params">    floorId,</span></span></span><br><span class="line"><span class="function"><span class="params">    traceValue = &#123;&#125;,</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">        iPhoneX,</span><br><span class="line">        isSSR</span><br><span class="line">    &#125; = state; <span class="comment">// æ˜¯å¦ iPhoneX è®¾å¤‡å·²ç»å­˜å‚¨åœ¨ state é‡Œ, å…¼å®¹æœåŠ¡ç«¯ &amp; å®¢æˆ·ç«¯, ä¸éœ€è¦å†é‡æ–°åˆ¤æ–­</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">        defaultSelected,</span><br><span class="line">        contentList,</span><br><span class="line">        selectedTextColor = <span class="string">"#0086F6"</span>,</span><br><span class="line">        defaultTextColor = <span class="string">"#333333"</span>,</span><br><span class="line">        type,</span><br><span class="line">        backgroundImage,</span><br><span class="line">        backgroundColor</span><br><span class="line">    &#125; = templateConfig;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> bottomList = [];</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        bottomList = <span class="built_in">JSON</span>.parse(contentList);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        div className = &#123;</span></span><br><span class="line"><span class="xml">            cx("nav_bottom_wrapper expose_dom", &#123;</span></span><br><span class="line"><span class="xml">                nav_bottom_wrapper_x_or: iPhoneX</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        style = &#123;</span></span><br><span class="line"><span class="xml">            zIndex1000</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">        data - expose - key = "tang_page_module_expo"</span></span><br><span class="line"><span class="xml">        data - trace - value = &#123;</span></span><br><span class="line"><span class="xml">            JSON.stringify(traceValue)</span></span><br><span class="line"><span class="xml">        &#125; &gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        div className = "nav_bottom_flex"</span></span><br><span class="line"><span class="xml">        style = &#123;</span></span><br><span class="line"><span class="xml">            &#123;</span></span><br><span class="line"><span class="xml">                backgroundColor,</span></span><br><span class="line"><span class="xml">                backgroundImage: backgroundImage &amp;&amp; `url($&#123;backgroundImage&#125;)` </span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">        &#125; &gt;</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">            bottomList.map((bottomAnchor, index) =&gt; &#123;</span></span><br><span class="line"><span class="xml">                const isCurrent = index === Number(defaultSelected);</span></span><br><span class="line"><span class="xml">                return ( <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                    BottomNav bottomAnchor = &#123;</span></span><br><span class="line"><span class="xml">                        bottomAnchor</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    floorId = &#123;</span></span><br><span class="line"><span class="xml">                        floorId</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    key = &#123;</span></span><br><span class="line"><span class="xml">                        index</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    index = &#123;</span></span><br><span class="line"><span class="xml">                        index</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    isCurrent = &#123;</span></span><br><span class="line"><span class="xml">                        isCurrent</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    traceValue = &#123;</span></span><br><span class="line"><span class="xml">                        traceValue</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    handlers = &#123;</span></span><br><span class="line"><span class="xml">                        handlers</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    selectedTextColor = &#123;</span></span><br><span class="line"><span class="xml">                        selectedTextColor</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    defaultTextColor = &#123;</span></span><br><span class="line"><span class="xml">                        defaultTextColor</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    type = &#123;</span></span><br><span class="line"><span class="xml">                        type</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    isSSR = &#123;</span></span><br><span class="line"><span class="xml">                        isSSR</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    /&gt;</span></span><br><span class="line"><span class="xml">                );</span></span><br><span class="line"><span class="xml">            &#125;)</span></span><br><span class="line"><span class="xml">        &#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /div&gt;</span> <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">        /div&gt;</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BottomNav</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    bottomAnchor,</span></span></span><br><span class="line"><span class="function"><span class="params">    index,</span></span></span><br><span class="line"><span class="function"><span class="params">    isCurrent,</span></span></span><br><span class="line"><span class="function"><span class="params">    traceValue,</span></span></span><br><span class="line"><span class="function"><span class="params">    handlers,</span></span></span><br><span class="line"><span class="function"><span class="params">    selectedTextColor,</span></span></span><br><span class="line"><span class="function"><span class="params">    defaultTextColor,</span></span></span><br><span class="line"><span class="function"><span class="params">    floorId,</span></span></span><br><span class="line"><span class="function"><span class="params">    type,</span></span></span><br><span class="line"><span class="function"><span class="params">    isSSR</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> buttonSortIndex = index + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">        handleLogClickTrace,</span><br><span class="line">        handleClick</span><br><span class="line">    &#125; = handlers;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">        selectedImage,</span><br><span class="line">        defaultImage,</span><br><span class="line">        text</span><br><span class="line">    &#125; = bottomAnchor;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleClickBottom = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        e.preventDefault()</span><br><span class="line">        <span class="keyword">if</span> (isCurrent) <span class="keyword">return</span></span><br><span class="line">        handleGotoNav(e, bottomAnchor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handleGotoNav = <span class="function">(<span class="params">e, urls</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            clickLinkHttp,</span><br><span class="line">            clickLinkNative,</span><br><span class="line">            clickLinkHybrid,</span><br><span class="line">            clickLinkMiniProgram</span><br><span class="line">        &#125; = urls;</span><br><span class="line">        handleLogClickTrace(e);</span><br><span class="line">        handleClick(&#123;</span><br><span class="line">            clickLinkHttp,</span><br><span class="line">            clickLinkNative,</span><br><span class="line">            clickLinkHybrid,</span><br><span class="line">            clickLinkMiniProgram</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> showImg = type === <span class="string">"0"</span>;</span><br><span class="line">    <span class="keyword">let</span> finalShowImage = isCurrent ? selectedImage : defaultImage</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> imageRef = useRef();</span><br><span class="line">    <span class="keyword">let</span> [imgWidth, imgHeight] = useImageRefSize(imageRef);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æœåŠ¡ç«¯å·²ç»åŠ è½½å®Œæˆå›¾ç‰‡, æ²¡æœ‰è§¦å‘onloadäº‹ä»¶æ—¶, ç›´æ¥åˆ¤æ–­åŸå§‹é«˜åº¦ or è§¦å‘onloadäº‹ä»¶æ—¶è·å¾—çš„é«˜åº¦</span></span><br><span class="line">    <span class="comment">// è‹¥å®¢æˆ·ç«¯å›¾ç‰‡åŠ è½½å¤±è´¥ imageHasLoaded è¿”å›çš„æ˜¯å®½é«˜ 0ï¼ŒhideText æ˜¯ false</span></span><br><span class="line">    <span class="comment">// å®¢æˆ·ç«¯çš„ä»£ç ä¸€ç›´ä¼šæ‰§è¡Œï¼Œ</span></span><br><span class="line">    <span class="keyword">let</span> imageHasLoaded = (imageRef.current &amp;&amp; imageRef.current.naturalHeight || imgWidth)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> hideText = showImg &amp;&amp; imageHasLoaded;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> imgStyle = &#123;</span><br><span class="line">        width: imgWidth ? <span class="string">`<span class="subst">$&#123;imgWidth <span class="regexp">/ 100&#125;rem` : 0,</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">        height: imgHeight ? `$&#123;imgHeight /</span> <span class="number">100</span>&#125;</span>rem`</span> : <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æœåŠ¡ç«¯æ¸²æŸ“å®½é«˜åˆå§‹å€¼è®¾ç½®ä¸º0ï¼Œåé¢è®¡ç®—å‡ºé«˜åº¦çš„æ—¶å€™å†è¦†ç›–</span></span><br><span class="line">    <span class="keyword">if</span> (isSSR) imgStyle = &#123;</span><br><span class="line">        width: <span class="string">'0'</span>,</span><br><span class="line">        height: <span class="string">'0'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> textColor = getTextColor(</span><br><span class="line">        isCurrent,</span><br><span class="line">        type,</span><br><span class="line">        selectedTextColor,</span><br><span class="line">        defaultTextColor</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> imgUniqueId = <span class="string">`bottom_img_<span class="subst">$&#123;floorId&#125;</span>_<span class="subst">$&#123;index&#125;</span>`</span> ;</span><br><span class="line">    <span class="keyword">let</span> textUniqueId = <span class="string">`bottom_text_<span class="subst">$&#123;floorId&#125;</span>_<span class="subst">$&#123;index&#125;</span>`</span> ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ( <span class="xml"><span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">            div data - trace - key = "tang_page_button_click"</span></span><br><span class="line"><span class="xml">            data - trace - value = &#123;</span></span><br><span class="line"><span class="xml">                JSON.stringify(&#123;</span></span><br><span class="line"><span class="xml">                    ...traceValue,</span></span><br><span class="line"><span class="xml">                    button: "bottomtab",</span></span><br><span class="line"><span class="xml">                    button_sort: buttonSortIndex,</span></span><br><span class="line"><span class="xml">                    tabname: text</span></span><br><span class="line"><span class="xml">                &#125;)</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            className = &#123;</span></span><br><span class="line"><span class="xml">                cx("nav_bottom_item", &#123;</span></span><br><span class="line"><span class="xml">                    nav_bottom_item_img: hideText</span></span><br><span class="line"><span class="xml">                &#125;)</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            onClick = &#123;</span></span><br><span class="line"><span class="xml">                handleClickBottom</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            style = &#123;</span></span><br><span class="line"><span class="xml">                &#123;</span></span><br><span class="line"><span class="xml">                    color: textColor</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"><span class="xml">            &#125; &gt;</span></span><br><span class="line"><span class="xml">            &#123;</span></span><br><span class="line"><span class="xml">                !hideText &amp;&amp; <span class="tag">&lt; <span class="attr">p</span> <span class="attr">id</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">                    textUniqueId</span></span><br><span class="line"><span class="xml">                &#125; &gt; &#123;</span></span><br><span class="line"><span class="xml">                    text</span></span><br><span class="line"><span class="xml">                &#125; <span class="tag">&lt; /<span class="attr">p</span>&gt;</span></span>&#125; &#123;</span><br><span class="line">                    showImg &amp;&amp; <span class="xml"><span class="tag">&lt; <span class="attr">img</span> <span class="attr">src</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">                        finalShowImage</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    id = &#123;</span></span><br><span class="line"><span class="xml">                        imgUniqueId</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    ref = &#123;</span></span><br><span class="line"><span class="xml">                        imageRef</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    style = &#123;</span></span><br><span class="line"><span class="xml">                        imgStyle</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    /&gt;&#125; &#123;</span></span><br><span class="line"><span class="xml">                        showImg &amp;&amp; <span class="tag">&lt; <span class="attr">ImageHelper</span> <span class="attr">imgUniqueId</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">                            imgUniqueId</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                        textUniqueId = &#123;</span></span><br><span class="line"><span class="xml">                            textUniqueId</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                        /&gt;&#125; <span class="tag">&lt;</span></span></span><br><span class="line"><span class="xml">                        /div&gt;</span></span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * æœåŠ¡ç«¯ä»£ç ï¼Œå…ˆäºä»»ä½•ç”Ÿå‘½å‘¨æœŸä¹‹å‰æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">                 * å½“domä¸Šçš„imgè·å–åˆ° naturalHeight æˆ–è€… ç›‘å¬åˆ° å›¾ç‰‡çš„ onload äº‹ä»¶ï¼Œå°†å›¾ç‰‡çš„å¤§å°æ”¹å˜ã€‚</span></span><br><span class="line"><span class="comment">                 * æœåŠ¡ç«¯æ¸²æŸ“æ—¶ï¼Œå›¾ç‰‡çš„åŸå§‹å¤§å°ä¸€å®šè¦è®¾ç½®æˆ 0ï¼Œå› ä¸º å¦‚æœå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªå¤±è´¥çš„æ ‡ç­¾ã€‚è®¾ç½®æˆ0 åï¼Œå°±ç®—åŠ è½½å¤±è´¥ï¼Œå®½é«˜ä¹Ÿæ˜¯0ï¼Œä¸ä¼šå½±å“å±•ç¤ºã€‚</span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 * å®¢æˆ·ç«¯æ¸²æŸ“æ—¶ï¼ŒImageHelper è¿™æ®µä»£ç ä¸ä¼šæ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">                 * é€šè¿‡ useImage æ–¹æ³•åˆ¤æ–­ å›¾ç‰‡æ˜¯å¦åŠ è½½å®Œæˆï¼Œå›¾ç‰‡åŠ è½½å¤±è´¥ è¿”å›çš„ å®½é«˜æ˜¯ 0ï¼Œä¹Ÿæ˜¯å¤±è´¥çŠ¶æ€</span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 * å…ˆåˆ¤æ–­ naturalHeight é«˜åº¦ï¼Œæ˜¯å› ä¸ºæœåŠ¡ç«¯åŠ è½½å›¾ç‰‡ å¯èƒ½éå¸¸å¿«ï¼Œä»£ç è¿˜æ²¡æ‰§è¡Œåˆ° onloadï¼Œå›¾ç‰‡å·²ç»ä¸‹è½½å®Œæˆï¼Œ</span></span><br><span class="line"><span class="comment">                 * é‚£å°±ä¸€ç›´éƒ½ä¸ä¼šè§¦å‘onloadäº‹ä»¶ï¼Œæ‰€ä»¥å…ˆè¦åˆ¤æ–­ naturalHeightï¼Œ å¦‚æœ naturalHeight ä¸ä¸º 0ï¼Œè¯´æ˜å›¾ç‰‡å·²ç»åŠ è½½å®Œæˆã€‚</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">ImageHelper</span>(<span class="params">&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                    imgUniqueId,</span></span></span><br><span class="line"><span class="function"><span class="params">                    textUniqueId</span></span></span><br><span class="line"><span class="function"><span class="params">                &#125;</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">let</span> script = <span class="string">`&lt;script type="text/javascript"&gt;</span></span><br><span class="line"><span class="string">  var targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span> = document.querySelector('#<span class="subst">$&#123;imgUniqueId&#125;</span>');</span></span><br><span class="line"><span class="string">  var targetText_<span class="subst">$&#123;textUniqueId&#125;</span> = document.querySelector('#<span class="subst">$&#123;textUniqueId&#125;</span>');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  function setImageStyle(textNode, imageNode) &#123;</span></span><br><span class="line"><span class="string">    if(textNode &amp;&amp; imageNode) &#123;</span></span><br><span class="line"><span class="string">      textNode.style.display = 'none';</span></span><br><span class="line"><span class="string">      imageNode.style.height = imageNode.naturalHeight / 100 + 'rem';</span></span><br><span class="line"><span class="string">      imageNode.style.width = imageNode.naturalWidth / 100 + 'rem';</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  if(targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>) &#123;</span></span><br><span class="line"><span class="string">    if(!!targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>.naturalHeight) &#123;</span></span><br><span class="line"><span class="string">      setImageStyle(targetText_<span class="subst">$&#123;textUniqueId&#125;</span>, targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>)</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>.onload = function() &#123;</span></span><br><span class="line"><span class="string">        setImageStyle(targetText_<span class="subst">$&#123;textUniqueId&#125;</span>, targetImage_<span class="subst">$&#123;imgUniqueId&#125;</span>)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  &lt;/script&gt;`</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span> = <span class="string">&#123;</span></span></span></span><br><span class="line"><span class="xml">                        &#123;</span></span><br><span class="line"><span class="xml">                            __html: script</span></span><br><span class="line"><span class="xml">                        &#125;</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    /&gt;</span></span><br><span class="line"><span class="xml">                &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                const getTextColor = (isCurrent, type, selectedTextColor, defaultTextColor) =&gt; &#123;</span></span><br><span class="line"><span class="xml">                    let textColor = "";</span></span><br><span class="line"><span class="xml">                    if (type === "1") &#123;</span></span><br><span class="line"><span class="xml">                        textColor = isCurrent ? "#0086F6" : "#333333";</span></span><br><span class="line"><span class="xml">                    &#125; else &#123;</span></span><br><span class="line"><span class="xml">                        textColor = isCurrent ? selectedTextColor : defaultTextColor;</span></span><br><span class="line"><span class="xml">                    &#125;</span></span><br><span class="line"><span class="xml">                    return textColor;</span></span><br><span class="line"><span class="xml">                &#125;;</span></span><br></pre></td></tr></table></figure>

<h3 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h3><p>  <strong>å¼¹å‡ºè’™å±‚åï¼Œç¦æ­¢æ‰è’™å±‚ä¸‹é¢çš„å†…å®¹æ»šåŠ¨</strong></p>
<ul>
<li>æ–¹æ³•ä¸€</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">disableWindowScroll() &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">    <span class="keyword">const</span> htmlEl = <span class="built_in">document</span>.querySelector(<span class="string">"html"</span>);</span><br><span class="line">    bodyEl.style.overflow = <span class="string">"hidden"</span>;</span><br><span class="line">    htmlEl.style.overflow = <span class="string">"hidden"</span>;</span><br><span class="line">&#125;</span><br><span class="line">enableWindowScroll() &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">    <span class="keyword">const</span> htmlEl = <span class="built_in">document</span>.querySelector(<span class="string">"html"</span>);</span><br><span class="line">    bodyEl.style.overflow = <span class="string">"auto"</span>;</span><br><span class="line">    htmlEl.style.overflow = <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹æ³•è™½ç„¶èƒ½ç¦ç”¨æ‰é¡µé¢çš„æ»šåŠ¨ï¼Œä½†æ˜¯å¦‚æœé¡µé¢è¶…é•¿çš„è¯ï¼Œä¼šä¸€ä¸‹æ»‘åŠ¨åˆ°é¡µé¢æœ€é¡¶éƒ¨ã€‚</p>
<p>  å¯¹ç§»åŠ¨ç«¯ï¼Œå¯ä»¥å¼•å…¥ <code>touch-action</code> ï¼Œé™åˆ¶ä¸º <code>none</code> ï¼Œä½† <code>ios</code> çš„ <code>safari</code> ä¸Šä¸æ”¯æŒè¯¥å±æ€§, è¿™æ—¶å€™ï¼Œå°±éœ€è¦ç»“åˆ <code>event.preventDefault</code> å±æ€§æ¥ç”¨äº†ã€‚æ³¨æ„åœ¨ç»‘å®š <code>addEventListener</code> çš„æ—¶å€™ï¼Œéœ€è¦å¤šä¼ ä¸€ä¸ª <code>options</code> ï¼Œå¼ºè°ƒè¿™ä¸ªäº‹ä»¶ä¸æ˜¯ <code>passive</code> çš„ï¼Œå¦åˆ™è°·æ­Œç­‰æ–°ç‰ˆæµè§ˆå™¨ä¼šæŠ¥é”™ã€‚åŒæ—¶æœ€å¥½ä¹ŸæŒ‡å®šcapture: trueï¼Œè¿™æ ·å¯ä»¥æ—©ç‚¹ç¦æ­¢è¯¥äº‹ä»¶ã€‚æŠ¥é”™æ˜¯ <code>Unable to preventDefault inside passive event listener due to target being treated as passive.</code> è°·æ­Œå»ºè®®ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°† <code>passive</code> æ ‡å¿—æ·»åŠ åˆ°æ¯ä¸ªæ²¡æœ‰è°ƒç”¨ <code>preventDefault()</code> çš„ <code>wheel</code> ã€ <code>mousewheel</code> ã€ <code>touchstart</code> å’Œ <code>touchmove</code> äº‹ä»¶ä¾¦å¬å™¨, </p>
<ul>
<li>æ–¹æ³•äºŒ</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">preventDefaultBehavior = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">&#125;;</span><br><span class="line">disableWindowScroll = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">    bodyEl.addEventListener(<span class="string">"touchmove"</span>, <span class="keyword">this</span>.preventDefaultBehavior, &#123;</span><br><span class="line">        passive: <span class="literal">false</span>,</span><br><span class="line">        capture: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">enableWindowScroll = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">"body"</span>);</span><br><span class="line">    bodyEl.removeEventListener(<span class="string">"touchmove"</span>, <span class="keyword">this</span>.preventDefaultBehavior, &#123;</span><br><span class="line">        passive: <span class="literal">false</span>,</span><br><span class="line">        capture: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  ä¸Šè¿°æ–¹æ³•ä¼šç¦ç”¨æ‰æµè§ˆå™¨çš„æ‰€æœ‰æ»šåŠ¨äº‹ä»¶</p>
<ul>
<li>æ–¹æ³•ä¸‰</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">getScrollY = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.scrollY</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">disableWindowScroll = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</span><br><span class="line">    <span class="keyword">const</span> top = <span class="keyword">this</span>.getScrollY()</span><br><span class="line">    bodyEl.style.position = <span class="string">"fixed"</span></span><br><span class="line">    bodyEl.style.width = <span class="string">"100%"</span></span><br><span class="line">    bodyEl.style.top = -top + <span class="string">'px'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">enableWindowScroll = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> bodyEl = <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>);</span><br><span class="line">    <span class="comment">//è¿™é‡Œtop é€šè¿‡getComputedStyleè·å–topï¼Œåœ¨IOSè®¾å¤‡æ˜¯ä¸æ­£ç¡®çš„ï¼Œå§‹ç»ˆä¸º0ï¼ŒAndroidè®¾å¤‡å’Œæµè§ˆå™¨ç«¯éƒ½æ˜¯æ­£å¸¸çš„</span></span><br><span class="line">    <span class="comment">//è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</span></span><br><span class="line">    <span class="keyword">const</span> top = -bodyEl.style.top.split(<span class="string">'px'</span>)[<span class="number">0</span>]</span><br><span class="line">    bodyEl.style.position = <span class="string">''</span></span><br><span class="line">    bodyEl.style.top = <span class="string">''</span></span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, top)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>é¡¹ç›®ç»å†</tag>
      </tags>
  </entry>
  <entry>
    <title>Debounce &amp; throttle</title>
    <url>/2019/12/28/Debounce-throttle/</url>
    <content><![CDATA[<a id="more"></a>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> throttle = <span class="function">(<span class="params">fn, wait</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> now = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        <span class="keyword">if</span> (now - previous &gt; wait) &#123;</span><br><span class="line">            previous = now;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// æ‰§è¡Œ throttle å‡½æ•°è¿”å›æ–°å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> betterFn = throttle(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fn å‡½æ•°æ‰§è¡Œäº†"</span>), <span class="number">1000</span>);</span><br><span class="line"><span class="comment">// æ¯ 10 æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ betterFn å‡½æ•°ï¼Œä½†æ˜¯åªæœ‰æ—¶é—´å·®å¤§äº 1000 æ—¶æ‰ä¼šæ‰§è¡Œ fn</span></span><br><span class="line">setInterval(betterFn, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, wait = <span class="number">50</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timer) clearTimeout(timer);</span><br><span class="line">        timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> betterFn = debounce(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fn é˜²æŠ–æ‰§è¡Œäº†"</span>), <span class="number">1000</span>);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"scroll"</span>, betterFn);</span><br><span class="line"></span><br><span class="line"><span class="comment">// immediateè¡¨ç¤ºç¬¬ä¸€æ¬¡æ˜¯å¦ç«‹å³æ‰§è¡Œ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, wait = <span class="number">50</span>, immediate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timer) clearTimeout(timer);</span><br><span class="line">        <span class="keyword">if</span> (immediate &amp;&amp; !timer) &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;</span><br><span class="line">        timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> betterFn = debounce(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fn é˜²æŠ–æ‰§è¡Œäº†"</span>), <span class="number">1000</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"scroll"</span>, betterFn);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ å¼ºç‰ˆthrottle</span></span><br><span class="line"><span class="comment">// wait æ—¶é—´å†…ï¼Œå¯ä»¥é‡æ–°ç”Ÿæˆå®šæ—¶å™¨ï¼Œä½†åªè¦ wait çš„æ—¶é—´åˆ°äº†ï¼Œå¿…é¡»ç»™ç”¨æˆ·ä¸€ä¸ªå“åº”</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="number">0</span>,</span><br><span class="line">        timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> now = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        <span class="keyword">if</span> (now - previous &lt; wait) &#123;</span><br><span class="line">            <span class="keyword">if</span> (timer) clearTimeout(timer);</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                previous = now;</span><br><span class="line">                fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            previous = now;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰§è¡Œ throttle å‡½æ•°è¿”å›æ–°å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> betterFn = throttle(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fn èŠ‚æµæ‰§è¡Œäº†"</span>), <span class="number">1000</span>);</span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è§¦å‘ scroll æ‰§è¡Œä¸€æ¬¡ fnï¼Œæ¯éš” 1 ç§’åæ‰§è¡Œä¸€æ¬¡å‡½æ•° fnï¼Œåœæ­¢æ»‘åŠ¨ 1 ç§’åå†æ‰§è¡Œå‡½æ•° fn</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"scroll"</span>, betterFn);</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>CSSä¸–ç•Œ</title>
    <url>/2019/12/31/CSS%E4%B8%96%E7%95%8C/</url>
    <content><![CDATA[<h3 id="ç¬¬ä¸‰ç« -æµã€å…ƒç´ ä¸åŸºæœ¬å°ºå¯¸"><a href="#ç¬¬ä¸‰ç« -æµã€å…ƒç´ ä¸åŸºæœ¬å°ºå¯¸" class="headerlink" title="ç¬¬ä¸‰ç«  æµã€å…ƒç´ ä¸åŸºæœ¬å°ºå¯¸"></a>ç¬¬ä¸‰ç«  æµã€å…ƒç´ ä¸åŸºæœ¬å°ºå¯¸</h3><blockquote>
<p>å—çº§å…ƒç´ ï¼šä¸€ä¸ªæ°´å¹³æµä¸Šåªèƒ½å•ç‹¬æ˜¾ç¤ºä¸€ä¸ªå…ƒç´  </p>
</blockquote>
<p><code>&lt;div&gt; &lt;li&gt; &lt;table&gt;</code> å‡æ˜¯å—çº§å…ƒç´ </p>
]]></content>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>Articles</title>
    <url>/2019/12/28/Articles/</url>
    <content><![CDATA[<h2 id="Articles"><a href="#Articles" class="headerlink" title="Articles"></a>Articles</h2><p><a href="https://jancat.github.io/post/2019/translation-usememo-and-usecallback/" target="_blank" rel="noopener">ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ useMemo å’Œ useCallback</a></p>
<p><a href="https://css-tricks.com/using-requestanimationframe-with-react-hooks/" target="_blank" rel="noopener">requestAnimationFrame use hooks</a></p>
<p><a href="https://medium.com/@martin_hotell/react-typescript-and-defaultprops-dilemma-ca7f81c661c7" target="_blank" rel="noopener">typescript</a></p>
<a id="more"></a>

]]></content>
  </entry>
  <entry>
    <title>é”šç‚¹å¯¼èˆª</title>
    <url>/2019/12/28/AnchorNav/</url>
    <content><![CDATA[<h2 id="åˆ†äº«å†…å®¹"><a href="#åˆ†äº«å†…å®¹" class="headerlink" title="åˆ†äº«å†…å®¹"></a>åˆ†äº«å†…å®¹</h2><p><strong>é”šç‚¹å¯¼èˆªåŠŸèƒ½ç‚¹</strong>ï¼ˆåŠŸèƒ½æ‹†åˆ†ï¼‰</p>
<ul>
<li>ç‚¹å‡»é”šç‚¹æ»šåŠ¨åˆ°æŒ‡å®šæ¥¼å±‚</li>
<li>æ»šåŠ¨æ¥¼å±‚è‡ªåŠ¨åˆ‡æ¢åˆ°å½“å‰å¯¹åº”çš„é”šç‚¹</li>
<li>å¯¼èˆªæ å¸é¡¶ï¼Œè®¡ç®—å¸é¡¶æ—¶æœº</li>
<li>å¸é¡¶é«˜åº¦åå¡Œé—®é¢˜ï¼ŒåŒ…è£¹å±‚åŠ ä¸€ä¸ªé«˜åº¦</li>
<li>å±•å¼€é”šç‚¹ï¼šå¯¼èˆªæ æ»šåŠ¨åˆ°å¸é¡¶ä½ç½®ï¼Œåˆ‡é€‰ä¸­å½“å‰çš„é”šç‚¹</li>
</ul>
<a id="more"></a>

<h3 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h3><ul>
<li><strong>å½“ç‚¹å‡»é”šç‚¹å¯¼èˆªæ çš„æ—¶å€™ï¼Œéœ€è¦é¡µé¢æ»šåŠ¨åˆ°å¯¹åº”çš„ä½ç½®ã€‚ä½†æ˜¯ï¼Œé¡µé¢æ•°æ®åˆæ˜¯åŠ¨æ€åŠ è½½çš„ï¼Œæ‰€ä»¥ä¸€æ¬¡è®¡ç®—å¹¶ä¸èƒ½å‡†ç¡®æ»šåŠ¨</strong></li>
</ul>
<p>é€šè¿‡ componentDidUpdate è¿™ä¸ªæ–¹æ³•ï¼Œå½“æ¥¼å±‚æœ‰åŠ è½½çš„æ—¶å€™ï¼Œé‡æ–°è§¦å‘ç‚¹å‡»é”šç‚¹äº‹ä»¶ </p>
<p>ä»¥ä¸Šæ–¹æ¡ˆçš„é—®é¢˜åœ¨äºï¼Œæ¥å£è¯·æ±‚åˆ°æ•°æ®ï¼Œæ›´æ–°äº† productHasLoadedï¼ŒçŠ¶æ€æ˜¯æ›´æ–°äº†ï¼Œä½†æ˜¯ render è¿‡ç¨‹è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œå¯¼è‡´é¡µé¢å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–<br>è€Œè¿™ä¸ªæ—¶å€™å»è®¡ç®—è¯¥æ»‘åŠ¨çš„é«˜åº¦ï¼Œå…¶å®æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚æ»šåŠ¨çš„é«˜åº¦ä¹Ÿæ˜¯å½“å‰çš„æ¥¼å±‚çš„é«˜åº¦ï¼Œå®é™…ä¸Šæ ¹æœ¬ä¸ä¼šæ»‘åŠ¨åˆ°å¯¹åº”çš„ä½ç½®ã€‚æ»‘åŠ¨çš„è·ç¦»è¿˜æ˜¯æ–°åŠ è½½æ¥¼å±‚å¹¶æ²¡æœ‰åŠ è½½è¿›æ¥çš„é”™è¯¯é«˜åº¦ã€‚</p>
<p>éªšæ“ä½œæ¥äº†ï¼šsetTimeout(()=&gt;{this.fixScroll()}, 0)</p>
<p>javascript çš„è¿‡ç¨‹æ˜¯å•çº¿ç¨‹ï¼ŒçŠ¶æ€æ›´æ–°äº†ä¹‹åï¼Œä½•æ—¶ render é¡µé¢æˆ‘ä»¬å¹¶ä¸çŸ¥é“ï¼Œå¤§æ¦‚æ˜¯æ”¾åœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œé¢ç­‰å¾…æ‰§è¡Œï¼Œé‚£ä¹ˆ setTimeout å°±æ˜¯ç­‰äº‹ä»¶é˜Ÿåˆ—é‡Œé¢çš„äº‹æƒ…æ‰§è¡Œç»“æŸåï¼Œå†æ‰§è¡Œæ»šåŠ¨æ“ä½œ</p>
<p>é‚£ä¹ˆé—®é¢˜æ˜¯ï¼š react æ›´æ–°çŠ¶æ€å’Œ render çš„å…ˆåé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„<br>setStateï¼ˆï¼‰ä¸ä¼šç«‹å³æ”¹å˜ this.stateï¼Œä½†ä¼šåˆ›å»ºæŒ‚èµ·çŠ¶æ€è½¬æ¢<br>æ›´ï¼š</p>
<p>çŠ¶æ€æ›´æ–°ä¸€å®šä¼š renderï¼Œä½†æ˜¯ render ä¸è¡¨ç¤ºé¡µé¢å·²ç»æ ¹æ®çŠ¶æ€å‘ç”Ÿæ”¹å˜</p>
<ul>
<li><strong>é¡µé¢ loading çš„æ—¶å€™ä¸ºä½• window.scrollTo(0, height)ä¼šä¸èµ·ä½œç”¨å‘¢</strong></li>
</ul>
<p>é¡µé¢åŠ è½½å®Œä¹‹åscrollToæ‰ä¼šèµ·ä½œç”¨ï¼Œå¦åˆ™ä¼šä¸€ç›´è‡ªåŠ¨æ»šåŠ¨åˆ°èµ·å§‹ä½ç½®ã€‚æµè§ˆå™¨ç‰¹æ€§ã€‚</p>
<ul>
<li><strong>é”šç‚¹å¯¼èˆªæ·»åŠ è’™å±‚ä¹‹åçš„ç‚¹å‡»ç©¿é€é—®é¢˜</strong> </li>
</ul>
<p>ç‚¹å‡»äº†è’™å±‚ï¼Œè§¦å‘äº†ä¸‹é¢çš„äº§å“é“¾æ¥ï¼Œå¯¼è‡´è’™å±‚å…³é—­åŒæ—¶ä¼šè·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ã€‚<br>åŸä»£ç é‡Œæ·»åŠ äº†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">onClick = &#123;</span><br><span class="line">    e =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.handleFoldAnchor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">onTouchStart = &#123;</span><br><span class="line">    e =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.handleFoldAnchor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// e.stopPropagation() èµ·åˆ°é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­</span></span><br><span class="line"><span class="comment">// event.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨touchstartäº‹ä»¶åœ¨æŸäº›åœºæ™¯ä¸‹ä¼šå‡ºç°ç‚¹å‡»ç©¿é€çš„ç°è±¡ã€‚</span></span><br><span class="line"><span class="comment">// ç‚¹å‡»ç©¿é€ï¼šå‡å¦‚é¡µé¢ä¸Šæœ‰ä¸¤ä¸ªå…ƒç´ Aå’ŒBã€‚Bå…ƒç´ åœ¨Aå…ƒç´ ä¹‹ä¸Šã€‚æˆ‘ä»¬åœ¨Bå…ƒç´ çš„touchstartäº‹ä»¶ä¸Šæ³¨å†Œäº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„ä½œç”¨æ˜¯éšè—Bå…ƒç´ ã€‚æˆ‘ä»¬å‘ç°ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»Bå…ƒç´ ï¼ŒBå…ƒç´ è¢«éšè—äº†ï¼Œéšåï¼ŒAå…ƒç´ è§¦å‘äº†clickäº‹ä»¶ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯å› ä¸ºåœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œäº‹ä»¶æ‰§è¡Œçš„é¡ºåºæ˜¯touchstart &gt; touchend &gt; clickã€‚è€Œclickäº‹ä»¶æœ‰300msçš„å»¶è¿Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€å¼€å§‹è¿™ç§å†™æ³•ä¸ºä½•ä¼šç©¿é€å‘¢ï¼ŒtouchStartä¹‹åï¼Œè’™å±‚æ¶ˆå¤±ï¼Œç„¶åè§¦å‘äº†clickäº‹ä»¶ï¼Œclickç‚¹å‡»äº†äº§å“çš„é“¾æ¥ï¼Œä»è€Œè·³è½¬ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨ï¼šæµè§ˆå™¨äº‹ä»¶è§¦å‘çš„é¡ºåº</span></span><br><span class="line"><span class="comment">// touchstart --&gt; mouseover(æœ‰çš„æµè§ˆå™¨æ²¡æœ‰å®ç°) --&gt; mousemove(ä¸€æ¬¡) --&gt;mousedown --&gt; mouseup --&gt; click --&gt;touchend</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Touch äº‹ä»¶ä¸­ï¼Œå¸¸ç”¨çš„ä¸º touchstart, touchmove, touchend ä¸‰ç§ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰touchcancel</span></span><br></pre></td></tr></table></figure>

<p>æ¢æˆ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">onTouchMove = &#123;</span><br><span class="line">    e =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.handleFoldAnchor()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">onClick = &#123;</span><br><span class="line">    e =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.handleFoldAnchor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>é¡¹ç›®ç»å†</tag>
      </tags>
  </entry>
</search>
