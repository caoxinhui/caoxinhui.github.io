---
title: 浏览器缓存机制
date: 2020-01-03 16:55:33
tags:
---


工作中遇到一个问题，请求的接口貌似被缓存住了，显示provisional headers are shown
如何让我们的浏览器显示from cache 字样呢？但是接口显示的是cache：no-cache

1、 复现情况
2、 解决被隐藏的情况

HTTP 提供了用来对已缓存对象进行再验证的工具，最常用的是If-Modified-Since 首部，

### 过期日期和使用期
Cache-Control 首部和 Expires 首部，HTTP让每个原始服务器向每个文档附加一个"过期时间"

### 服务器再验证
> 说明缓存需要询问原始服务器文档是否发生了变化

- 如果再验证显示内容发生了变化，缓存会获取一份新的文档副本，并将其存在旧文档的位置上，然后将文档发送给客户端
- 如果再验证显示内容没有发生变化，缓存只需要获取新的首部，包括一个新的过期时间，并对缓存首部进行更新

### 条件方法再验证
> HTTP 允许缓存向原始服务器发送一个条件"GET"，请求服务器只在文档与缓存中现有的副本不同时，才回送对象主体

#### HTTP定义的5个条件首部

- If-Modified-Since:<date> Date再验证
   - 自指定日期后，文档被修改，If-Modified-Since 为真。GET 会成功执行，携带新首部的新文档返回给缓存，新首部会包含一个新的过期时间
   - 自指定日期后，文档未修改，会想客户端返回304 not modified响应报文。
   - 原始服务器会将最后的修改日期附加到所提供的文档上去

- If-None-Match:<tags> 实体标签再验证
   - 有些文档看你会被周期性重写，但实际包含的数据通常一样。尽管内容没有变化，但是修改日期会发生变化
   - 有些文档修改，但修改的内容并不重要
   - ....

实体标签是附加到文档上的任意标签，它们可能包含了文档的序列号或版本名 ETag

